<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Markov Chain Model | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Markov Chain Model | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Markov Chain Model | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />



<meta name="date" content="2020-11-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="ordinal.html"/>
<link rel="next" href="hmm.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#maximum-likelihood-estimation"><i class="fa fa-check"></i>Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#issues-with-ml-estimation"><i class="fa fa-check"></i>Issues with ML estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#create-the-weights"><i class="fa fa-check"></i>Create the Weights</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#demonstrate-censoring-with-an-upper-limit"><i class="fa fa-check"></i>Demonstrate Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#demonstrate-censoring-with-a-lower-limit"><i class="fa fa-check"></i>Demonstrate censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Chain Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#median-estimation"><i class="fa fa-check"></i>Median estimation</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gausian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-5"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-16"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-20"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Algorithms</b></span></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-17"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#source-22"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-9"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-3"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-function"><i class="fa fa-check"></i>Example Function</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-27"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-21"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful-eruptions"><i class="fa fa-check"></i>Example 1: Old Faithful eruptions</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris-data-set"><i class="fa fa-check"></i>Example 2: Iris data set</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-24"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-25"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-3"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#algorithms"><i class="fa fa-check"></i>Algorithms</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="markov-chain-model" class="section level1">
<h1>Markov Chain Model</h1>
<p>Initial demo of <span class="pack" style="">markovchain</span> package. Not shown. You may want to play with it to get a feel for how it works. We will use it for comparison later. Do go ahead and load the package</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="markov.html#cb256-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb256-2"><a href="markov.html#cb256-2"></a></span>
<span id="cb256-3"><a href="markov.html#cb256-3"></a><span class="kw">library</span>(markovchain)</span>
<span id="cb256-4"><a href="markov.html#cb256-4"></a></span>
<span id="cb256-5"><a href="markov.html#cb256-5"></a>A =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(.<span class="dv">7</span>, <span class="fl">.3</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb256-6"><a href="markov.html#cb256-6"></a></span>
<span id="cb256-7"><a href="markov.html#cb256-7"></a>dtmcA =<span class="st"> </span><span class="kw">new</span>(</span>
<span id="cb256-8"><a href="markov.html#cb256-8"></a>  <span class="st">&#39;markovchain&#39;</span>,</span>
<span id="cb256-9"><a href="markov.html#cb256-9"></a>  <span class="dt">transitionMatrix =</span> A,</span>
<span id="cb256-10"><a href="markov.html#cb256-10"></a>  <span class="dt">states =</span> <span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>),</span>
<span id="cb256-11"><a href="markov.html#cb256-11"></a>  <span class="dt">name =</span> <span class="st">&#39;MarkovChain A&#39;</span></span>
<span id="cb256-12"><a href="markov.html#cb256-12"></a>)</span>
<span id="cb256-13"><a href="markov.html#cb256-13"></a></span>
<span id="cb256-14"><a href="markov.html#cb256-14"></a>dtmcA</span></code></pre></div>
<pre><code>MarkovChain A 
 A  2 - dimensional discrete Markov Chain defined by the following states: 
 a, b 
 The transition matrix  (by rows)  is defined as follows: 
    a   b
a 0.7 0.3
b 0.9 0.1</code></pre>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="markov.html#cb258-1"></a><span class="kw">plot</span>(dtmcA)</span></code></pre></div>
<p><img src="model-demos_files/figure-html/markov-chain-demo-1.svg" width="75%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="markov.html#cb259-1"></a><span class="kw">transitionProbability</span>(dtmcA, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;b&#39;</span>)</span></code></pre></div>
<pre><code>[1] 0.1</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="markov.html#cb261-1"></a>initialState =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb261-2"><a href="markov.html#cb261-2"></a>steps =<span class="st"> </span><span class="dv">4</span></span>
<span id="cb261-3"><a href="markov.html#cb261-3"></a>finalState =<span class="st"> </span>initialState <span class="op">*</span><span class="st"> </span>dtmcA <span class="op">^</span><span class="st"> </span>steps <span class="co">#using power operator</span></span>
<span id="cb261-4"><a href="markov.html#cb261-4"></a>finalState</span></code></pre></div>
<pre><code>          a      b
[1,] 0.7488 0.2512</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="markov.html#cb263-1"></a><span class="kw">steadyStates</span>(dtmcA)</span></code></pre></div>
<pre><code>        a    b
[1,] 0.75 0.25</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="markov.html#cb265-1"></a>observed_states =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>), <span class="dv">50</span>, <span class="kw">c</span>(.<span class="dv">7</span>, <span class="fl">.3</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb265-2"><a href="markov.html#cb265-2"></a></span>
<span id="cb265-3"><a href="markov.html#cb265-3"></a><span class="kw">createSequenceMatrix</span>(observed_states)</span></code></pre></div>
<pre><code>   a  b
a 24 11
b 11  3</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="markov.html#cb267-1"></a><span class="kw">markovchainFit</span>(observed_states)</span></code></pre></div>
<pre><code>$estimate
MLE Fit 
 A  2 - dimensional discrete Markov Chain defined by the following states: 
 a, b 
 The transition matrix  (by rows)  is defined as follows: 
          a         b
a 0.6857143 0.3142857
b 0.7857143 0.2142857


$standardError
          a          b
a 0.1399708 0.09476071
b 0.2369018 0.12371791

$confidenceLevel
[1] 0.95

$lowerEndpointMatrix
          a         b
a 0.4113764 0.1285581
b 0.3213953 0.0000000

$upperEndpointMatrix
          a         b
a 0.9600522 0.5000133
b 1.0000000 0.4567684

$logLikelihood
[1] -29.06116</code></pre>
<div id="data-setup-14" class="section level2">
<h2>Data Setup</h2>
<div id="data-functions" class="section level3">
<h3>Data Functions</h3>
<p>A recursive function to take a matrix power.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="markov.html#cb269-1"></a>mat_power =<span class="st"> </span><span class="cf">function</span>(M, N){</span>
<span id="cb269-2"><a href="markov.html#cb269-2"></a>  <span class="cf">if</span> (N <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) <span class="kw">return</span>(M)</span>
<span id="cb269-3"><a href="markov.html#cb269-3"></a>  </span>
<span id="cb269-4"><a href="markov.html#cb269-4"></a>  M <span class="op">%*%</span><span class="st"> </span><span class="kw">mat_power</span>(M, N<span class="dv">-1</span>)</span>
<span id="cb269-5"><a href="markov.html#cb269-5"></a>}</span></code></pre></div>
<p>A function to create a sequence.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="markov.html#cb270-1"></a>createSequence =<span class="st"> </span><span class="cf">function</span>(states, len, tmat) {</span>
<span id="cb270-2"><a href="markov.html#cb270-2"></a>  <span class="co"># states: number of states</span></span>
<span id="cb270-3"><a href="markov.html#cb270-3"></a>  <span class="co"># len: length of sequence</span></span>
<span id="cb270-4"><a href="markov.html#cb270-4"></a>  <span class="co"># tmat: the transition matrix</span></span>
<span id="cb270-5"><a href="markov.html#cb270-5"></a>  states_numeric =<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(states))</span>
<span id="cb270-6"><a href="markov.html#cb270-6"></a>  out =<span class="st"> </span><span class="kw">numeric</span>(len)</span>
<span id="cb270-7"><a href="markov.html#cb270-7"></a>  out[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">sample</span>(states_numeric, <span class="dv">1</span>, <span class="dt">prob=</span><span class="kw">colMeans</span>(tmat)) <span class="co"># initial state</span></span>
<span id="cb270-8"><a href="markov.html#cb270-8"></a>  </span>
<span id="cb270-9"><a href="markov.html#cb270-9"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>len){</span>
<span id="cb270-10"><a href="markov.html#cb270-10"></a>    out[i] =<span class="st"> </span><span class="kw">sample</span>(states_numeric, <span class="dv">1</span>, <span class="dt">prob =</span> tmat[out[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>], ])</span>
<span id="cb270-11"><a href="markov.html#cb270-11"></a>  }</span>
<span id="cb270-12"><a href="markov.html#cb270-12"></a>  </span>
<span id="cb270-13"><a href="markov.html#cb270-13"></a>  states[out]</span>
<span id="cb270-14"><a href="markov.html#cb270-14"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="markov.html#cb271-1"></a><span class="co"># example</span></span>
<span id="cb271-2"><a href="markov.html#cb271-2"></a>result.mat =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb271-3"><a href="markov.html#cb271-3"></a><span class="kw">mat_power</span>(result.mat, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>     [,1] [,2]
[1,]    8    8
[2,]    8    8</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="markov.html#cb273-1"></a><span class="co"># transition matrix</span></span>
<span id="cb273-2"><a href="markov.html#cb273-2"></a>A =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(.<span class="dv">7</span>, <span class="fl">.3</span>, <span class="fl">.4</span>, <span class="fl">.6</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb273-3"><a href="markov.html#cb273-3"></a></span>
<span id="cb273-4"><a href="markov.html#cb273-4"></a><span class="kw">mat_power</span>(A, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>          [,1]      [,2]
[1,] 0.5714311 0.4285689
[2,] 0.5714252 0.4285748</code></pre>
</div>
<div id="two-states-demo" class="section level3">
<h3>Two states Demo</h3>
<p>Note that a notably long sequence is needed to get close to recovering the true transition matrix.</p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="markov.html#cb275-1"></a>A =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(.<span class="dv">7</span>, <span class="fl">.3</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</span>
<span id="cb275-2"><a href="markov.html#cb275-2"></a>observed_states =<span class="st"> </span><span class="kw">createSequence</span>(<span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>), <span class="dv">5000</span>, <span class="dt">tmat =</span> A)</span>
<span id="cb275-3"><a href="markov.html#cb275-3"></a></span>
<span id="cb275-4"><a href="markov.html#cb275-4"></a><span class="kw">createSequenceMatrix</span>(observed_states)</span></code></pre></div>
<pre><code>     a    b
a 2637 1124
b 1124  114</code></pre>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="markov.html#cb277-1"></a><span class="kw">prop.table</span>(<span class="kw">createSequenceMatrix</span>(observed_states), <span class="dv">1</span>)</span></code></pre></div>
<pre><code>          a          b
a 0.7011433 0.29885669
b 0.9079160 0.09208401</code></pre>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="markov.html#cb279-1"></a><span class="kw">markovchainFit</span>(observed_states)</span></code></pre></div>
<pre><code>$estimate
MLE Fit 
 A  2 - dimensional discrete Markov Chain defined by the following states: 
 a, b 
 The transition matrix  (by rows)  is defined as follows: 
          a          b
a 0.7011433 0.29885669
b 0.9079160 0.09208401


$standardError
           a           b
a 0.01365374 0.008914148
b 0.02708086 0.008624457

$confidenceLevel
[1] 0.95

$lowerEndpointMatrix
          a          b
a 0.6743825 0.28138528
b 0.8548385 0.07518038

$upperEndpointMatrix
          a         b
a 0.7279042 0.3163281
b 0.9609935 0.1089876

$logLikelihood
[1] -2674.284</code></pre>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="markov.html#cb281-1"></a>res =<span class="st"> </span><span class="kw">markovchainFit</span>(observed_states)</span>
<span id="cb281-2"><a href="markov.html#cb281-2"></a></span>
<span id="cb281-3"><a href="markov.html#cb281-3"></a><span class="co"># log likelihood</span></span>
<span id="cb281-4"><a href="markov.html#cb281-4"></a><span class="kw">sum</span>(<span class="kw">createSequenceMatrix</span>(observed_states) <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(res<span class="op">$</span>estimate<span class="op">@</span>transitionMatrix))</span></code></pre></div>
<pre><code>[1] -2674.284</code></pre>
</div>
<div id="three-states-demo" class="section level3">
<h3>Three states demo</h3>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="markov.html#cb283-1"></a>A =<span class="st"> </span><span class="kw">matrix</span>(</span>
<span id="cb283-2"><a href="markov.html#cb283-2"></a>  <span class="kw">c</span>(.<span class="dv">70</span>, <span class="fl">.20</span>, <span class="fl">.10</span>,</span>
<span id="cb283-3"><a href="markov.html#cb283-3"></a>    <span class="fl">.20</span>, <span class="fl">.40</span>, <span class="fl">.40</span>,</span>
<span id="cb283-4"><a href="markov.html#cb283-4"></a>    <span class="fl">.05</span>, <span class="fl">.05</span>, <span class="fl">.90</span>), </span>
<span id="cb283-5"><a href="markov.html#cb283-5"></a>  <span class="dt">nrow  =</span> <span class="dv">3</span>, </span>
<span id="cb283-6"><a href="markov.html#cb283-6"></a>  <span class="dt">byrow =</span> <span class="ot">TRUE</span></span>
<span id="cb283-7"><a href="markov.html#cb283-7"></a>)</span>
<span id="cb283-8"><a href="markov.html#cb283-8"></a></span>
<span id="cb283-9"><a href="markov.html#cb283-9"></a>observed_states =<span class="st"> </span><span class="kw">createSequence</span>(<span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>), <span class="dv">500</span>, <span class="dt">tmat =</span> A)</span>
<span id="cb283-10"><a href="markov.html#cb283-10"></a><span class="kw">createSequenceMatrix</span>(observed_states)</span></code></pre></div>
<pre><code>   a  b   c
a 77 27  12
b 20 28  22
c 18 15 280</code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="markov.html#cb285-1"></a><span class="kw">prop.table</span>(<span class="kw">createSequenceMatrix</span>(observed_states), <span class="dv">1</span>)</span></code></pre></div>
<pre><code>           a          b         c
a 0.66379310 0.23275862 0.1034483
b 0.28571429 0.40000000 0.3142857
c 0.05750799 0.04792332 0.8945687</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="markov.html#cb287-1"></a><span class="kw">markovchainFit</span>(observed_states)</span></code></pre></div>
<pre><code>$estimate
MLE Fit 
 A  3 - dimensional discrete Markov Chain defined by the following states: 
 a, b, c 
 The transition matrix  (by rows)  is defined as follows: 
           a          b         c
a 0.66379310 0.23275862 0.1034483
b 0.28571429 0.40000000 0.3142857
c 0.05750799 0.04792332 0.8945687


$standardError
           a          b          c
a 0.07564624 0.04479442 0.02986294
b 0.06388766 0.07559289 0.06700594
c 0.01355476 0.01237375 0.05346070

$confidenceLevel
[1] 0.95

$lowerEndpointMatrix
           a          b          c
a 0.51552916 0.14496316 0.04491797
b 0.16049675 0.25184062 0.18295646
c 0.03094114 0.02367122 0.78978761

$upperEndpointMatrix
           a          b         c
a 0.81205705 0.32055408 0.1619786
b 0.41093182 0.54815938 0.4456150
c 0.08407484 0.07217543 0.9993498

$logLikelihood
[1] -302.4854</code></pre>
</div>
</div>
<div id="function-15" class="section level2">
<h2>Function</h2>
<p>Now we create a function to calculate the (negative) log likelihood.</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="markov.html#cb289-1"></a>markov_ll =<span class="st"> </span><span class="cf">function</span>(par, x) {</span>
<span id="cb289-2"><a href="markov.html#cb289-2"></a>  <span class="co"># par should be the c(A) of transition probabilities A</span></span>
<span id="cb289-3"><a href="markov.html#cb289-3"></a>  nstates =<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(x))</span>
<span id="cb289-4"><a href="markov.html#cb289-4"></a>  </span>
<span id="cb289-5"><a href="markov.html#cb289-5"></a>  <span class="co"># create transition matrix</span></span>
<span id="cb289-6"><a href="markov.html#cb289-6"></a>  par =<span class="st"> </span><span class="kw">matrix</span>(par, <span class="dt">ncol=</span>nstates)</span>
<span id="cb289-7"><a href="markov.html#cb289-7"></a>  par =<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(par, <span class="dv">1</span>, <span class="cf">function</span>(x) x<span class="op">/</span><span class="kw">sum</span>(x)))</span>
<span id="cb289-8"><a href="markov.html#cb289-8"></a>  </span>
<span id="cb289-9"><a href="markov.html#cb289-9"></a>  <span class="co"># create seq matrix</span></span>
<span id="cb289-10"><a href="markov.html#cb289-10"></a>  seqMat =<span class="st"> </span><span class="kw">table</span>(x[<span class="op">-</span><span class="kw">length</span>(x)], x[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb289-11"><a href="markov.html#cb289-11"></a>  </span>
<span id="cb289-12"><a href="markov.html#cb289-12"></a>  <span class="co"># calculate log likelihood</span></span>
<span id="cb289-13"><a href="markov.html#cb289-13"></a>  ll =<span class="st"> </span><span class="kw">sum</span>(seqMat <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(par))</span>
<span id="cb289-14"><a href="markov.html#cb289-14"></a>  </span>
<span id="cb289-15"><a href="markov.html#cb289-15"></a>  <span class="op">-</span>ll</span>
<span id="cb289-16"><a href="markov.html#cb289-16"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="markov.html#cb290-1"></a>A =<span class="st"> </span><span class="kw">matrix</span>(</span>
<span id="cb290-2"><a href="markov.html#cb290-2"></a>  <span class="kw">c</span>(.<span class="dv">70</span>, <span class="fl">.20</span>, <span class="fl">.10</span>,</span>
<span id="cb290-3"><a href="markov.html#cb290-3"></a>    <span class="fl">.40</span>, <span class="fl">.20</span>, <span class="fl">.40</span>,</span>
<span id="cb290-4"><a href="markov.html#cb290-4"></a>    <span class="fl">.10</span>, <span class="fl">.15</span>, <span class="fl">.75</span>),</span>
<span id="cb290-5"><a href="markov.html#cb290-5"></a>  <span class="dt">nrow  =</span> <span class="dv">3</span>,</span>
<span id="cb290-6"><a href="markov.html#cb290-6"></a>  <span class="dt">byrow =</span> <span class="ot">TRUE</span></span>
<span id="cb290-7"><a href="markov.html#cb290-7"></a>)</span>
<span id="cb290-8"><a href="markov.html#cb290-8"></a></span>
<span id="cb290-9"><a href="markov.html#cb290-9"></a>observed_states =<span class="st"> </span><span class="kw">createSequence</span>(<span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>), <span class="dv">1000</span>, <span class="dt">tmat =</span> A)</span></code></pre></div>
</div>
<div id="estimation-14" class="section level2">
<h2>Estimation</h2>
<p>Note that initial state values will be transformed to rowsum to one, so the specific initial values don’t matter (i.e. they don’t have to be probabilities). With the basic <span class="func" style="">optim</span> approach, sometimes log(0) will occur and produce a warning. Can be ignored, or use <code>LFBGS</code> as demonstrated at the end.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="markov.html#cb291-1"></a>initpar =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">9</span>)</span>
<span id="cb291-2"><a href="markov.html#cb291-2"></a></span>
<span id="cb291-3"><a href="markov.html#cb291-3"></a>result =<span class="st"> </span><span class="kw">optim</span>(</span>
<span id="cb291-4"><a href="markov.html#cb291-4"></a>  <span class="dt">par =</span> initpar,</span>
<span id="cb291-5"><a href="markov.html#cb291-5"></a>  <span class="dt">fn  =</span> markov_ll,</span>
<span id="cb291-6"><a href="markov.html#cb291-6"></a>  <span class="dt">x   =</span> observed_states,</span>
<span id="cb291-7"><a href="markov.html#cb291-7"></a>  <span class="dt">method  =</span> <span class="st">&#39;BFGS&#39;</span>,</span>
<span id="cb291-8"><a href="markov.html#cb291-8"></a>  <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">reltol =</span> <span class="fl">1e-12</span>)</span>
<span id="cb291-9"><a href="markov.html#cb291-9"></a>)</span>
<span id="cb291-10"><a href="markov.html#cb291-10"></a></span>
<span id="cb291-11"><a href="markov.html#cb291-11"></a><span class="co"># get estimates on prob scale</span></span>
<span id="cb291-12"><a href="markov.html#cb291-12"></a>estmat =<span class="st"> </span><span class="kw">matrix</span>(result<span class="op">$</span>par, <span class="dt">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb291-13"><a href="markov.html#cb291-13"></a>estmat =<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(estmat, <span class="dv">1</span>, <span class="cf">function</span>(x)  x <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(x)))</span></code></pre></div>
</div>
<div id="comparison-19" class="section level2">
<h2>Comparison</h2>
<p>Compare with <span class="pack" style="">markovchain</span> package.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="markov.html#cb292-1"></a>compare_result =<span class="st"> </span><span class="kw">markovchainFit</span>(observed_states)</span>
<span id="cb292-2"><a href="markov.html#cb292-2"></a></span>
<span id="cb292-3"><a href="markov.html#cb292-3"></a><span class="co"># compare log likelihood</span></span>
<span id="cb292-4"><a href="markov.html#cb292-4"></a><span class="kw">c</span>(<span class="op">-</span>result<span class="op">$</span>value, compare_result<span class="op">$</span>logLikelihood)</span></code></pre></div>
<pre><code>[1] -844.459 -844.459</code></pre>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="markov.html#cb294-1"></a><span class="co"># compare estimated transition matrix</span></span>
<span id="cb294-2"><a href="markov.html#cb294-2"></a><span class="kw">list</span>(</span>
<span id="cb294-3"><a href="markov.html#cb294-3"></a>  <span class="st">`</span><span class="dt">Estimated via optim</span><span class="st">`</span> =<span class="st"> </span>estmat,</span>
<span id="cb294-4"><a href="markov.html#cb294-4"></a>  <span class="st">`</span><span class="dt">markovchain Package</span><span class="st">`</span> =<span class="st"> </span>compare_result<span class="op">$</span>estimate<span class="op">@</span>transitionMatrix,</span>
<span id="cb294-5"><a href="markov.html#cb294-5"></a>  <span class="st">`</span><span class="dt">Analytical Solution</span><span class="st">`</span> =<span class="st"> </span><span class="kw">prop.table</span>(</span>
<span id="cb294-6"><a href="markov.html#cb294-6"></a>    <span class="kw">table</span>(observed_states[<span class="op">-</span><span class="kw">length</span>(observed_states)], observed_states[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb294-7"><a href="markov.html#cb294-7"></a>    , <span class="dv">1</span>)</span>
<span id="cb294-8"><a href="markov.html#cb294-8"></a>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb294-9"><a href="markov.html#cb294-9"></a><span class="st">  </span><span class="kw">map</span>(round, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>$`Estimated via optim`
      [,1]  [,2]  [,3]
[1,] 0.698 0.191 0.111
[2,] 0.369 0.235 0.396
[3,] 0.113 0.162 0.725

$`markovchain Package`
      a     b     c
a 0.698 0.191 0.111
b 0.369 0.235 0.396
c 0.113 0.162 0.725

$`Analytical Solution`
   
        a     b     c
  a 0.698 0.191 0.111
  b 0.369 0.235 0.396
  c 0.113 0.162 0.725</code></pre>
<p>Visualize.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="markov.html#cb296-1"></a><span class="kw">plot</span>(</span>
<span id="cb296-2"><a href="markov.html#cb296-2"></a>  <span class="kw">new</span>(</span>
<span id="cb296-3"><a href="markov.html#cb296-3"></a>    <span class="st">&#39;markovchain&#39;</span>,</span>
<span id="cb296-4"><a href="markov.html#cb296-4"></a>    <span class="dt">transitionMatrix =</span> estmat,</span>
<span id="cb296-5"><a href="markov.html#cb296-5"></a>    <span class="dt">states =</span> <span class="kw">c</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>),</span>
<span id="cb296-6"><a href="markov.html#cb296-6"></a>    <span class="dt">name =</span> <span class="st">&#39;Estimated Markov Chain&#39;</span></span>
<span id="cb296-7"><a href="markov.html#cb296-7"></a>  )</span>
<span id="cb296-8"><a href="markov.html#cb296-8"></a>)</span></code></pre></div>
<p><img src="model-demos_files/figure-html/markov-vis-1.svg" width="75%" style="display: block; margin: auto;" /></p>
<p>If you don’t want warnings due to zeros use constraints (<code>?constrOptim</code>).</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="markov.html#cb297-1"></a>result =<span class="st"> </span><span class="kw">optim</span>(</span>
<span id="cb297-2"><a href="markov.html#cb297-2"></a>  <span class="dt">par =</span> initpar,</span>
<span id="cb297-3"><a href="markov.html#cb297-3"></a>  <span class="dt">fn  =</span> markov_ll,</span>
<span id="cb297-4"><a href="markov.html#cb297-4"></a>  <span class="dt">x   =</span> observed_states,</span>
<span id="cb297-5"><a href="markov.html#cb297-5"></a>  <span class="dt">method  =</span> <span class="st">&#39;L-BFGS&#39;</span>,</span>
<span id="cb297-6"><a href="markov.html#cb297-6"></a>  <span class="dt">lower   =</span> <span class="kw">rep</span>(<span class="fl">1e-20</span>, <span class="kw">length</span>(initpar)),</span>
<span id="cb297-7"><a href="markov.html#cb297-7"></a>  <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">pgtol =</span> <span class="fl">1e-12</span>)</span>
<span id="cb297-8"><a href="markov.html#cb297-8"></a>)</span></code></pre></div>
</div>
<div id="source-15" class="section level2">
<h2>Source</h2>
<p>Original code available at
<a href="https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/markov_model.R" class="uri">https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/markov_model.R</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ordinal.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hmm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/markov.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
