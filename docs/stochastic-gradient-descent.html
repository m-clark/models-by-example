<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Stochastic Gradient Descent | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Stochastic Gradient Descent | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Stochastic Gradient Descent | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="gradient-descent.html"/>
<link rel="next" href="metropolis-hastings.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#one-factor-mixed-model"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#two-factor-mixed-model"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#mixed-model-via-ml"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial Regression</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal Regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#python-2"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gaussian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html"><i class="fa fa-check"></i>Neural Network</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-3"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-4"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-3"><i class="fa fa-check"></i>Example 3</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-5"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-2"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-22"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-27"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#introduction-2"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l1-lasso-regularization"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l2-ridge-regularization"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-9"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-42"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder-Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-45"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-24"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-51"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-32"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-55"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#sgd-variants"><i class="fa fa-check"></i>SGD Variants</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-33"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-56"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-2"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-52"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-11"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-57"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-53"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-52"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-58"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-52"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stochastic-gradient-descent" class="section level1">
<h1>Stochastic Gradient Descent</h1>
<p>Here we have ‘online’ learning via stochastic gradient descent. See the
<a href="gradient-descent.html#gradient-descent">standard gradient descent</a> chapter. In the following, we have
basic data for standard regression, but in this ‘online’ learning case, we can
assume each observation comes to us as a stream over time rather than as a
single batch, and would continue coming in. Note that there are plenty of
variations of this, and it can be applied in the batch case as well. Currently
no stopping point is implemented in order to trace results over all data
points/iterations. On revisiting this much later, I thought it useful to add
that I believe this was motivated by the example in Murphy’s Probabilistic
Machine Learning text.</p>
<div id="data-setup-49" class="section level2">
<h2>Data Setup</h2>
<p>Create some data for a standard linear regression.</p>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="stochastic-gradient-descent.html#cb820-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb820-2"><a href="stochastic-gradient-descent.html#cb820-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-3"><a href="stochastic-gradient-descent.html#cb820-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb820-4"><a href="stochastic-gradient-descent.html#cb820-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb820-5"><a href="stochastic-gradient-descent.html#cb820-5" aria-hidden="true" tabindex="-1"></a>n  <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb820-6"><a href="stochastic-gradient-descent.html#cb820-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb820-7"><a href="stochastic-gradient-descent.html#cb820-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb820-8"><a href="stochastic-gradient-descent.html#cb820-8" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> .<span class="dv">5</span><span class="sc">*</span>x1 <span class="sc">+</span> .<span class="dv">2</span><span class="sc">*</span>x2 <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb820-9"><a href="stochastic-gradient-descent.html#cb820-9" aria-hidden="true" tabindex="-1"></a>X  <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">Intercept =</span> <span class="dv">1</span>, x1, x2)</span></code></pre></div>
</div>
<div id="function-32" class="section level2">
<h2>Function</h2>
<p>The estimating function using the <em>adagrad</em> approach.</p>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="stochastic-gradient-descent.html#cb821-1" aria-hidden="true" tabindex="-1"></a>sgd <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb821-2"><a href="stochastic-gradient-descent.html#cb821-2" aria-hidden="true" tabindex="-1"></a>  par,                       <span class="co"># parameter estimates</span></span>
<span id="cb821-3"><a href="stochastic-gradient-descent.html#cb821-3" aria-hidden="true" tabindex="-1"></a>  X,                         <span class="co"># model matrix</span></span>
<span id="cb821-4"><a href="stochastic-gradient-descent.html#cb821-4" aria-hidden="true" tabindex="-1"></a>  y,                         <span class="co"># target variable</span></span>
<span id="cb821-5"><a href="stochastic-gradient-descent.html#cb821-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="dv">1</span>,              <span class="co"># the learning rate</span></span>
<span id="cb821-6"><a href="stochastic-gradient-descent.html#cb821-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize_tau =</span> <span class="dv">0</span>,          <span class="co"># if &gt; 0, a check on the LR at early iterations</span></span>
<span id="cb821-7"><a href="stochastic-gradient-descent.html#cb821-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">average =</span> <span class="cn">FALSE</span>            <span class="co"># a variation of the approach</span></span>
<span id="cb821-8"><a href="stochastic-gradient-descent.html#cb821-8" aria-hidden="true" tabindex="-1"></a>){</span>
<span id="cb821-9"><a href="stochastic-gradient-descent.html#cb821-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb821-10"><a href="stochastic-gradient-descent.html#cb821-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initialize</span></span>
<span id="cb821-11"><a href="stochastic-gradient-descent.html#cb821-11" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">=</span> par</span>
<span id="cb821-12"><a href="stochastic-gradient-descent.html#cb821-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(beta) <span class="ot">=</span> <span class="fu">colnames</span>(X)</span>
<span id="cb821-13"><a href="stochastic-gradient-descent.html#cb821-13" aria-hidden="true" tabindex="-1"></a>  betamat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(X), <span class="at">ncol =</span> <span class="fu">length</span>(beta))      <span class="co"># Collect all estimates</span></span>
<span id="cb821-14"><a href="stochastic-gradient-descent.html#cb821-14" aria-hidden="true" tabindex="-1"></a>  fits <span class="ot">=</span> <span class="cn">NA</span>                                      <span class="co"># Collect fitted values at each point</span></span>
<span id="cb821-15"><a href="stochastic-gradient-descent.html#cb821-15" aria-hidden="true" tabindex="-1"></a>  loss <span class="ot">=</span> <span class="cn">NA</span>                                      <span class="co"># Collect loss at each point</span></span>
<span id="cb821-16"><a href="stochastic-gradient-descent.html#cb821-16" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">=</span> <span class="dv">0</span>                                          <span class="co"># adagrad per parameter learning rate adjustment</span></span>
<span id="cb821-17"><a href="stochastic-gradient-descent.html#cb821-17" aria-hidden="true" tabindex="-1"></a>  eps  <span class="ot">=</span> <span class="fl">1e-8</span>                                    <span class="co"># a smoothing term to avoid division by zero</span></span>
<span id="cb821-18"><a href="stochastic-gradient-descent.html#cb821-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb821-19"><a href="stochastic-gradient-descent.html#cb821-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)) {</span>
<span id="cb821-20"><a href="stochastic-gradient-descent.html#cb821-20" aria-hidden="true" tabindex="-1"></a>    Xi   <span class="ot">=</span> X[i, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb821-21"><a href="stochastic-gradient-descent.html#cb821-21" aria-hidden="true" tabindex="-1"></a>    yi   <span class="ot">=</span> y[i]</span>
<span id="cb821-22"><a href="stochastic-gradient-descent.html#cb821-22" aria-hidden="true" tabindex="-1"></a>    LP   <span class="ot">=</span> Xi <span class="sc">%*%</span> beta                           <span class="co"># matrix operations not necessary, </span></span>
<span id="cb821-23"><a href="stochastic-gradient-descent.html#cb821-23" aria-hidden="true" tabindex="-1"></a>    grad <span class="ot">=</span> <span class="fu">t</span>(Xi) <span class="sc">%*%</span> (LP <span class="sc">-</span> yi)                   <span class="co"># but makes consistent with standard gd func</span></span>
<span id="cb821-24"><a href="stochastic-gradient-descent.html#cb821-24" aria-hidden="true" tabindex="-1"></a>    s    <span class="ot">=</span> s <span class="sc">+</span> grad<span class="sc">^</span><span class="dv">2</span>                            <span class="co"># adagrad approach</span></span>
<span id="cb821-25"><a href="stochastic-gradient-descent.html#cb821-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb821-26"><a href="stochastic-gradient-descent.html#cb821-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># update</span></span>
<span id="cb821-27"><a href="stochastic-gradient-descent.html#cb821-27" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> beta <span class="sc">-</span> stepsize<span class="sc">/</span>(stepsize_tau <span class="sc">+</span> <span class="fu">sqrt</span>(s <span class="sc">+</span> eps)) <span class="sc">*</span> grad </span>
<span id="cb821-28"><a href="stochastic-gradient-descent.html#cb821-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb821-29"><a href="stochastic-gradient-descent.html#cb821-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (average <span class="sc">&amp;</span> i <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb821-30"><a href="stochastic-gradient-descent.html#cb821-30" aria-hidden="true" tabindex="-1"></a>      beta <span class="ot">=</span>  beta <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>i <span class="sc">*</span> (betamat[i <span class="sc">-</span> <span class="dv">1</span>, ] <span class="sc">-</span> beta)          <span class="co"># a variation</span></span>
<span id="cb821-31"><a href="stochastic-gradient-descent.html#cb821-31" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb821-32"><a href="stochastic-gradient-descent.html#cb821-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb821-33"><a href="stochastic-gradient-descent.html#cb821-33" aria-hidden="true" tabindex="-1"></a>    betamat[i,] <span class="ot">=</span> beta</span>
<span id="cb821-34"><a href="stochastic-gradient-descent.html#cb821-34" aria-hidden="true" tabindex="-1"></a>    fits[i]     <span class="ot">=</span> LP</span>
<span id="cb821-35"><a href="stochastic-gradient-descent.html#cb821-35" aria-hidden="true" tabindex="-1"></a>    loss[i]     <span class="ot">=</span> (LP <span class="sc">-</span> yi)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb821-36"><a href="stochastic-gradient-descent.html#cb821-36" aria-hidden="true" tabindex="-1"></a>    grad_old <span class="ot">=</span> grad</span>
<span id="cb821-37"><a href="stochastic-gradient-descent.html#cb821-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb821-38"><a href="stochastic-gradient-descent.html#cb821-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb821-39"><a href="stochastic-gradient-descent.html#cb821-39" aria-hidden="true" tabindex="-1"></a>  LP <span class="ot">=</span> X <span class="sc">%*%</span> beta</span>
<span id="cb821-40"><a href="stochastic-gradient-descent.html#cb821-40" aria-hidden="true" tabindex="-1"></a>  lastloss <span class="ot">=</span> <span class="fu">crossprod</span>(LP <span class="sc">-</span> y)</span>
<span id="cb821-41"><a href="stochastic-gradient-descent.html#cb821-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb821-42"><a href="stochastic-gradient-descent.html#cb821-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb821-43"><a href="stochastic-gradient-descent.html#cb821-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">par    =</span> beta,                               <span class="co"># final estimates</span></span>
<span id="cb821-44"><a href="stochastic-gradient-descent.html#cb821-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">par_chain =</span> betamat,                         <span class="co"># estimates at each iteration</span></span>
<span id="cb821-45"><a href="stochastic-gradient-descent.html#cb821-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE   =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(lastloss)<span class="sc">/</span><span class="fu">nrow</span>(X)),</span>
<span id="cb821-46"><a href="stochastic-gradient-descent.html#cb821-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted =</span> LP</span>
<span id="cb821-47"><a href="stochastic-gradient-descent.html#cb821-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb821-48"><a href="stochastic-gradient-descent.html#cb821-48" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="estimation-48" class="section level2">
<h2>Estimation</h2>
<p>Set starting values.</p>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="stochastic-gradient-descent.html#cb822-1" aria-hidden="true" tabindex="-1"></a>starting_values <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>)</span></code></pre></div>
<p>For any particular data you might have to fiddle with the <code>stepsize</code>, perhaps
choosing one based on cross-validation with old data.</p>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="stochastic-gradient-descent.html#cb823-1" aria-hidden="true" tabindex="-1"></a>fit_sgd <span class="ot">=</span> <span class="fu">sgd</span>(</span>
<span id="cb823-2"><a href="stochastic-gradient-descent.html#cb823-2" aria-hidden="true" tabindex="-1"></a>  starting_values,</span>
<span id="cb823-3"><a href="stochastic-gradient-descent.html#cb823-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb823-4"><a href="stochastic-gradient-descent.html#cb823-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb823-5"><a href="stochastic-gradient-descent.html#cb823-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize     =</span> .<span class="dv">1</span>,</span>
<span id="cb823-6"><a href="stochastic-gradient-descent.html#cb823-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize_tau =</span> .<span class="dv">5</span>,</span>
<span id="cb823-7"><a href="stochastic-gradient-descent.html#cb823-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">average =</span> <span class="cn">FALSE</span></span>
<span id="cb823-8"><a href="stochastic-gradient-descent.html#cb823-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb823-9"><a href="stochastic-gradient-descent.html#cb823-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb823-10"><a href="stochastic-gradient-descent.html#cb823-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fit_sgd)</span></code></pre></div>
<pre><code>List of 4
 $ par      : num [1:3, 1] 1.024 0.537 0.148
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : chr [1:3] &quot;Intercept&quot; &quot;x1&quot; &quot;x2&quot;
  .. ..$ : NULL
 $ par_chain: num [1:1000, 1:3] -0.06208 -0.00264 0.04781 0.09866 0.08242 ...
 $ RMSE     : num 1.01
 $ fitted   : num [1:1000, 1] 0.198 1.218 1.379 -0.141 1.358 ...</code></pre>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="stochastic-gradient-descent.html#cb825-1" aria-hidden="true" tabindex="-1"></a>fit_sgd<span class="sc">$</span>par</span></code></pre></div>
<pre><code>               [,1]
Intercept 1.0241049
x1        0.5368198
x2        0.1478470</code></pre>
</div>
<div id="comparison-54" class="section level2">
<h2>Comparison</h2>
<p>We can compare to standard linear regression.</p>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="stochastic-gradient-descent.html#cb827-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(lm(y ~ x1 + x2))</span></span>
<span id="cb827-2"><a href="stochastic-gradient-descent.html#cb827-2" aria-hidden="true" tabindex="-1"></a>coef1 <span class="ot">=</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2))</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Intercept
</th>
<th style="text-align:right;">
x1
</th>
<th style="text-align:right;">
x2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fit_sgd
</td>
<td style="text-align:right;">
1.024
</td>
<td style="text-align:right;">
0.537
</td>
<td style="text-align:right;">
0.148
</td>
</tr>
<tr>
<td style="text-align:left;">
lm
</td>
<td style="text-align:right;">
1.030
</td>
<td style="text-align:right;">
0.518
</td>
<td style="text-align:right;">
0.163
</td>
</tr>
</tbody>
</table>
</div>
<div id="visualize-estimates" class="section level2">
<h2>Visualize Estimates</h2>
<p><img src="model-demos_files/figure-html/sgd-visualize-1.svg" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="data-set-shift" class="section level2">
<h2>Data Set Shift</h2>
<p>This data includes a shift of the previous data, where the data fundamentally changes at certain times.</p>
<div id="data-setup-50" class="section level3">
<h3>Data Setup</h3>
<p>We’ll add data with different underlying generating processes.</p>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="stochastic-gradient-descent.html#cb828-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb828-2"><a href="stochastic-gradient-descent.html#cb828-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb828-3"><a href="stochastic-gradient-descent.html#cb828-3" aria-hidden="true" tabindex="-1"></a>n2   <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb828-4"><a href="stochastic-gradient-descent.html#cb828-4" aria-hidden="true" tabindex="-1"></a>x1<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">rnorm</span>(n2)</span>
<span id="cb828-5"><a href="stochastic-gradient-descent.html#cb828-5" aria-hidden="true" tabindex="-1"></a>x2<span class="fl">.2</span> <span class="ot">=</span> <span class="fu">rnorm</span>(n2)</span>
<span id="cb828-6"><a href="stochastic-gradient-descent.html#cb828-6" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> .<span class="dv">25</span><span class="sc">*</span>x1<span class="fl">.2</span> <span class="sc">-</span> .<span class="dv">25</span><span class="sc">*</span>x2<span class="fl">.2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n2)</span>
<span id="cb828-7"><a href="stochastic-gradient-descent.html#cb828-7" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">=</span> <span class="fu">rbind</span>(X, <span class="fu">cbind</span>(<span class="dv">1</span>, x1<span class="fl">.2</span>, x2<span class="fl">.2</span>))</span>
<span id="cb828-8"><a href="stochastic-gradient-descent.html#cb828-8" aria-hidden="true" tabindex="-1"></a>coef2 <span class="ot">=</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y2 <span class="sc">~</span> x1<span class="fl">.2</span> <span class="sc">+</span> x2<span class="fl">.2</span>))</span>
<span id="cb828-9"><a href="stochastic-gradient-descent.html#cb828-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">=</span> <span class="fu">c</span>(y, y2)</span>
<span id="cb828-10"><a href="stochastic-gradient-descent.html#cb828-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb828-11"><a href="stochastic-gradient-descent.html#cb828-11" aria-hidden="true" tabindex="-1"></a>n3    <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb828-12"><a href="stochastic-gradient-descent.html#cb828-12" aria-hidden="true" tabindex="-1"></a>x1<span class="fl">.3</span>  <span class="ot">=</span> <span class="fu">rnorm</span>(n3)</span>
<span id="cb828-13"><a href="stochastic-gradient-descent.html#cb828-13" aria-hidden="true" tabindex="-1"></a>x2<span class="fl">.3</span>  <span class="ot">=</span> <span class="fu">rnorm</span>(n3)</span>
<span id="cb828-14"><a href="stochastic-gradient-descent.html#cb828-14" aria-hidden="true" tabindex="-1"></a>y3    <span class="ot">=</span> <span class="dv">1</span> <span class="sc">-</span> .<span class="dv">25</span><span class="sc">*</span>x1<span class="fl">.3</span> <span class="sc">+</span> .<span class="dv">25</span><span class="sc">*</span>x2<span class="fl">.3</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n3)</span>
<span id="cb828-15"><a href="stochastic-gradient-descent.html#cb828-15" aria-hidden="true" tabindex="-1"></a>coef3 <span class="ot">=</span> <span class="fu">coef</span>(<span class="fu">lm</span>(y3 <span class="sc">~</span> x1<span class="fl">.3</span> <span class="sc">+</span> x2<span class="fl">.3</span>))</span>
<span id="cb828-16"><a href="stochastic-gradient-descent.html#cb828-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb828-17"><a href="stochastic-gradient-descent.html#cb828-17" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">=</span> <span class="fu">rbind</span>(X2, <span class="fu">cbind</span>(<span class="dv">1</span>, x1<span class="fl">.3</span>, x2<span class="fl">.3</span>))</span>
<span id="cb828-18"><a href="stochastic-gradient-descent.html#cb828-18" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">=</span> <span class="fu">c</span>(y2, y3)</span></code></pre></div>
</div>
<div id="estimation-49" class="section level3">
<h3>Estimation</h3>
<p>We’ll use the same function as before.</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="stochastic-gradient-descent.html#cb829-1" aria-hidden="true" tabindex="-1"></a>fit_sgd_shift <span class="ot">=</span> <span class="fu">sgd</span>(</span>
<span id="cb829-2"><a href="stochastic-gradient-descent.html#cb829-2" aria-hidden="true" tabindex="-1"></a>  starting_values,</span>
<span id="cb829-3"><a href="stochastic-gradient-descent.html#cb829-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X3,</span>
<span id="cb829-4"><a href="stochastic-gradient-descent.html#cb829-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y3,</span>
<span id="cb829-5"><a href="stochastic-gradient-descent.html#cb829-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize     =</span> <span class="dv">1</span>,</span>
<span id="cb829-6"><a href="stochastic-gradient-descent.html#cb829-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize_tau =</span> <span class="dv">0</span>,</span>
<span id="cb829-7"><a href="stochastic-gradient-descent.html#cb829-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">average =</span> <span class="cn">FALSE</span></span>
<span id="cb829-8"><a href="stochastic-gradient-descent.html#cb829-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb829-9"><a href="stochastic-gradient-descent.html#cb829-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb829-10"><a href="stochastic-gradient-descent.html#cb829-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fit_sgd_shift)</span></code></pre></div>
<pre><code>List of 4
 $ par      : num [1:3, 1] 0.821 -0.223 0.211
  ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. ..$ : chr [1:3] &quot;Intercept&quot; &quot;x1&quot; &quot;x2&quot;
  .. ..$ : NULL
 $ par_chain: num [1:3000, 1:3] -1 -0.119 0.624 1.531 1.063 ...
 $ RMSE     : num 1.57
 $ fitted   : num [1:3000, 1] 0.836 0.823 0.254 1.479 0.874 ...</code></pre>
</div>
<div id="comparison-55" class="section level3">
<h3>Comparison</h3>
<p>Compare with <span class="func" style="">lm</span> result for each data part.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Intercept
</th>
<th style="text-align:right;">
x1
</th>
<th style="text-align:right;">
x2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
lm_part1
</td>
<td style="text-align:right;">
1.030
</td>
<td style="text-align:right;">
0.518
</td>
<td style="text-align:right;">
0.163
</td>
</tr>
<tr>
<td style="text-align:left;">
lm_part2
</td>
<td style="text-align:right;">
-0.970
</td>
<td style="text-align:right;">
0.268
</td>
<td style="text-align:right;">
-0.287
</td>
</tr>
<tr>
<td style="text-align:left;">
lm_part3
</td>
<td style="text-align:right;">
1.045
</td>
<td style="text-align:right;">
-0.236
</td>
<td style="text-align:right;">
0.242
</td>
</tr>
<tr>
<td style="text-align:left;">
sgd_part1
</td>
<td style="text-align:right;">
1.086
</td>
<td style="text-align:right;">
0.513
</td>
<td style="text-align:right;">
0.146
</td>
</tr>
<tr>
<td style="text-align:left;">
sgd_part2
</td>
<td style="text-align:right;">
-0.925
</td>
<td style="text-align:right;">
0.295
</td>
<td style="text-align:right;">
-0.294
</td>
</tr>
<tr>
<td style="text-align:left;">
sgd_part3
</td>
<td style="text-align:right;">
0.821
</td>
<td style="text-align:right;">
-0.223
</td>
<td style="text-align:right;">
0.211
</td>
</tr>
</tbody>
</table>
</div>
<div id="visualize-estimates-1" class="section level3">
<h3>Visualize Estimates</h3>
<p>Visualize estimates across iterations.</p>
<p><img src="model-demos_files/figure-html/sgd-visualize-2-1.svg" width="75%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="sgd-variants" class="section level2">
<h2>SGD Variants</h2>
<p>The above uses the <em>Adagrad</em> approach for stochastic gradient descent, but there are many variations. A good resource can be found <a href="https://ruder.io/optimizing-gradient-descent/">here</a>, as well as this <a href="https://johnchenresearch.github.io/demon/">post covering more recent developments</a>. We will compare the <em>Adagrad</em>, <em>RMSprop</em>, <em>Adam</em>, and <em>Nadam</em> approaches.</p>
<div id="data-setup-51" class="section level3">
<h3>Data Setup</h3>
<p>For this demo we’ll bump the sample size. I’ve also made the coefficients a little different.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="stochastic-gradient-descent.html#cb831-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb831-2"><a href="stochastic-gradient-descent.html#cb831-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-3"><a href="stochastic-gradient-descent.html#cb831-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb831-4"><a href="stochastic-gradient-descent.html#cb831-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-5"><a href="stochastic-gradient-descent.html#cb831-5" aria-hidden="true" tabindex="-1"></a>n  <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb831-6"><a href="stochastic-gradient-descent.html#cb831-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb831-7"><a href="stochastic-gradient-descent.html#cb831-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb831-8"><a href="stochastic-gradient-descent.html#cb831-8" aria-hidden="true" tabindex="-1"></a>X  <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">Intercept =</span> <span class="dv">1</span>, x1, x2)</span>
<span id="cb831-9"><a href="stochastic-gradient-descent.html#cb831-9" aria-hidden="true" tabindex="-1"></a>true <span class="ot">=</span> <span class="fu">c</span>(<span class="at">Intercept =</span> <span class="dv">1</span>, <span class="at">x1 =</span> <span class="dv">1</span>, <span class="at">x2 =</span> <span class="sc">-</span>.<span class="dv">75</span>)</span>
<span id="cb831-10"><a href="stochastic-gradient-descent.html#cb831-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-11"><a href="stochastic-gradient-descent.html#cb831-11" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">=</span> X <span class="sc">%*%</span> true <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span></code></pre></div>
</div>
<div id="function-33" class="section level3">
<h3>Function</h3>
<p>For this we’ll add a functional component to the primary function. We create a <a href="https://adv-r.hadley.nz/function-factories.html">function factory</a> <code>update_ff</code> that, based on the input will create an appropriate update step (<code>update</code>) for use each iteration. This is mostly is just a programming exercise, but might allow you to add additional components arguments or methods more easily.</p>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="stochastic-gradient-descent.html#cb832-1" aria-hidden="true" tabindex="-1"></a>sgd <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb832-2"><a href="stochastic-gradient-descent.html#cb832-2" aria-hidden="true" tabindex="-1"></a>  par,                       <span class="co"># parameter estimates</span></span>
<span id="cb832-3"><a href="stochastic-gradient-descent.html#cb832-3" aria-hidden="true" tabindex="-1"></a>  X,                         <span class="co"># model matrix</span></span>
<span id="cb832-4"><a href="stochastic-gradient-descent.html#cb832-4" aria-hidden="true" tabindex="-1"></a>  y,                         <span class="co"># target variable</span></span>
<span id="cb832-5"><a href="stochastic-gradient-descent.html#cb832-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="fl">1e-2</span>,           <span class="co"># the learning rate; suggest 1e-3 for non-adagrad methods</span></span>
<span id="cb832-6"><a href="stochastic-gradient-descent.html#cb832-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&#39;adagrad&#39;</span>,          <span class="co"># one of adagrad, rmsprop, adam or nadam</span></span>
<span id="cb832-7"><a href="stochastic-gradient-descent.html#cb832-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">average =</span> <span class="cn">FALSE</span>,           <span class="co"># a variation of the approach</span></span>
<span id="cb832-8"><a href="stochastic-gradient-descent.html#cb832-8" aria-hidden="true" tabindex="-1"></a>  ...                        <span class="co"># arguments to pass to an updating function, e.g. gamma in rmsprop</span></span>
<span id="cb832-9"><a href="stochastic-gradient-descent.html#cb832-9" aria-hidden="true" tabindex="-1"></a>){</span>
<span id="cb832-10"><a href="stochastic-gradient-descent.html#cb832-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb832-11"><a href="stochastic-gradient-descent.html#cb832-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initialize</span></span>
<span id="cb832-12"><a href="stochastic-gradient-descent.html#cb832-12" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">=</span> par</span>
<span id="cb832-13"><a href="stochastic-gradient-descent.html#cb832-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(beta) <span class="ot">=</span> <span class="fu">colnames</span>(X)</span>
<span id="cb832-14"><a href="stochastic-gradient-descent.html#cb832-14" aria-hidden="true" tabindex="-1"></a>  betamat <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(X), <span class="at">ncol =</span> <span class="fu">length</span>(beta))      <span class="co"># Collect all estimates</span></span>
<span id="cb832-15"><a href="stochastic-gradient-descent.html#cb832-15" aria-hidden="true" tabindex="-1"></a>  v    <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(beta))                    <span class="co"># gradient variance (sum of squares)</span></span>
<span id="cb832-16"><a href="stochastic-gradient-descent.html#cb832-16" aria-hidden="true" tabindex="-1"></a>  m    <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(beta))                    <span class="co"># average of gradients for n/adam</span></span>
<span id="cb832-17"><a href="stochastic-gradient-descent.html#cb832-17" aria-hidden="true" tabindex="-1"></a>  eps  <span class="ot">=</span> <span class="fl">1e-8</span>                                    <span class="co"># a smoothing term to avoid division by zero</span></span>
<span id="cb832-18"><a href="stochastic-gradient-descent.html#cb832-18" aria-hidden="true" tabindex="-1"></a>  grad_old <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(beta))</span>
<span id="cb832-19"><a href="stochastic-gradient-descent.html#cb832-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb832-20"><a href="stochastic-gradient-descent.html#cb832-20" aria-hidden="true" tabindex="-1"></a>  update_ff <span class="ot">&lt;-</span> <span class="cf">function</span>(type, ...) {</span>
<span id="cb832-21"><a href="stochastic-gradient-descent.html#cb832-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb832-22"><a href="stochastic-gradient-descent.html#cb832-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># if stepsize_tau &gt; 0, a check on the LR at early iterations</span></span>
<span id="cb832-23"><a href="stochastic-gradient-descent.html#cb832-23" aria-hidden="true" tabindex="-1"></a>    adagrad <span class="ot">&lt;-</span> <span class="cf">function</span>(grad, <span class="at">stepsize_tau =</span> <span class="dv">0</span>) {</span>
<span id="cb832-24"><a href="stochastic-gradient-descent.html#cb832-24" aria-hidden="true" tabindex="-1"></a>      v <span class="ot">&lt;&lt;-</span> v <span class="sc">+</span> grad<span class="sc">^</span><span class="dv">2</span>  </span>
<span id="cb832-25"><a href="stochastic-gradient-descent.html#cb832-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb832-26"><a href="stochastic-gradient-descent.html#cb832-26" aria-hidden="true" tabindex="-1"></a>      stepsize<span class="sc">/</span>(stepsize_tau <span class="sc">+</span> <span class="fu">sqrt</span>(v <span class="sc">+</span> eps)) <span class="sc">*</span> grad</span>
<span id="cb832-27"><a href="stochastic-gradient-descent.html#cb832-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb832-28"><a href="stochastic-gradient-descent.html#cb832-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb832-29"><a href="stochastic-gradient-descent.html#cb832-29" aria-hidden="true" tabindex="-1"></a>    rmsprop <span class="ot">&lt;-</span> <span class="cf">function</span>(grad, grad_old, <span class="at">gamma =</span> .<span class="dv">9</span>) {</span>
<span id="cb832-30"><a href="stochastic-gradient-descent.html#cb832-30" aria-hidden="true" tabindex="-1"></a>      v <span class="ot">=</span> gamma <span class="sc">*</span> grad_old<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> gamma) <span class="sc">*</span> grad<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb832-31"><a href="stochastic-gradient-descent.html#cb832-31" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb832-32"><a href="stochastic-gradient-descent.html#cb832-32" aria-hidden="true" tabindex="-1"></a>      stepsize <span class="sc">/</span> <span class="fu">sqrt</span>(v <span class="sc">+</span> eps) <span class="sc">*</span> grad</span>
<span id="cb832-33"><a href="stochastic-gradient-descent.html#cb832-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb832-34"><a href="stochastic-gradient-descent.html#cb832-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb832-35"><a href="stochastic-gradient-descent.html#cb832-35" aria-hidden="true" tabindex="-1"></a>    adam <span class="ot">&lt;-</span> <span class="cf">function</span>(grad, <span class="at">b1 =</span> .<span class="dv">9</span>, <span class="at">b2 =</span> .<span class="dv">999</span>) {</span>
<span id="cb832-36"><a href="stochastic-gradient-descent.html#cb832-36" aria-hidden="true" tabindex="-1"></a>      m <span class="ot">&lt;&lt;-</span> b1 <span class="sc">*</span> m <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> b1) <span class="sc">*</span> grad</span>
<span id="cb832-37"><a href="stochastic-gradient-descent.html#cb832-37" aria-hidden="true" tabindex="-1"></a>      v <span class="ot">&lt;&lt;-</span> b2 <span class="sc">*</span> v <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> b2) <span class="sc">*</span> grad<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb832-38"><a href="stochastic-gradient-descent.html#cb832-38" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb832-39"><a href="stochastic-gradient-descent.html#cb832-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (type <span class="sc">==</span> <span class="st">&#39;adam&#39;</span>)</span>
<span id="cb832-40"><a href="stochastic-gradient-descent.html#cb832-40" aria-hidden="true" tabindex="-1"></a>        <span class="co"># dividing v and m by 1 - b*^i is the &#39;bias correction&#39;</span></span>
<span id="cb832-41"><a href="stochastic-gradient-descent.html#cb832-41" aria-hidden="true" tabindex="-1"></a>        stepsize<span class="sc">/</span>(<span class="fu">sqrt</span>(v <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> b2<span class="sc">^</span>i)) <span class="sc">+</span> eps) <span class="sc">*</span>  (m <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> b1<span class="sc">^</span>i))</span>
<span id="cb832-42"><a href="stochastic-gradient-descent.html#cb832-42" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span> </span>
<span id="cb832-43"><a href="stochastic-gradient-descent.html#cb832-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># nadam</span></span>
<span id="cb832-44"><a href="stochastic-gradient-descent.html#cb832-44" aria-hidden="true" tabindex="-1"></a>        stepsize<span class="sc">/</span>(<span class="fu">sqrt</span>(v <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> b2<span class="sc">^</span>i)) <span class="sc">+</span> eps) <span class="sc">*</span>  (b1 <span class="sc">*</span> m  <span class="sc">+</span>  (<span class="dv">1</span> <span class="sc">-</span> b1)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> b1<span class="sc">^</span>i) <span class="sc">*</span> grad)</span>
<span id="cb832-45"><a href="stochastic-gradient-descent.html#cb832-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb832-46"><a href="stochastic-gradient-descent.html#cb832-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb832-47"><a href="stochastic-gradient-descent.html#cb832-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">switch</span>(</span>
<span id="cb832-48"><a href="stochastic-gradient-descent.html#cb832-48" aria-hidden="true" tabindex="-1"></a>      type,</span>
<span id="cb832-49"><a href="stochastic-gradient-descent.html#cb832-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">adagrad =</span> <span class="cf">function</span>(grad, ...) <span class="fu">adagrad</span>(grad, ...),</span>
<span id="cb832-50"><a href="stochastic-gradient-descent.html#cb832-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">rmsprop =</span> <span class="cf">function</span>(grad, ...) <span class="fu">rmsprop</span>(grad, grad_old, ...),</span>
<span id="cb832-51"><a href="stochastic-gradient-descent.html#cb832-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">adam    =</span> <span class="cf">function</span>(grad, ...) <span class="fu">adam</span>(grad, ...),</span>
<span id="cb832-52"><a href="stochastic-gradient-descent.html#cb832-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">nadam   =</span> <span class="cf">function</span>(grad, ...) <span class="fu">adam</span>(grad, ...)</span>
<span id="cb832-53"><a href="stochastic-gradient-descent.html#cb832-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb832-54"><a href="stochastic-gradient-descent.html#cb832-54" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb832-55"><a href="stochastic-gradient-descent.html#cb832-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb832-56"><a href="stochastic-gradient-descent.html#cb832-56" aria-hidden="true" tabindex="-1"></a>  update <span class="ot">=</span> <span class="fu">update_ff</span>(type, ...)</span>
<span id="cb832-57"><a href="stochastic-gradient-descent.html#cb832-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb832-58"><a href="stochastic-gradient-descent.html#cb832-58" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(X)) {</span>
<span id="cb832-59"><a href="stochastic-gradient-descent.html#cb832-59" aria-hidden="true" tabindex="-1"></a>    Xi   <span class="ot">=</span> X[i, , drop <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb832-60"><a href="stochastic-gradient-descent.html#cb832-60" aria-hidden="true" tabindex="-1"></a>    yi   <span class="ot">=</span> y[i]</span>
<span id="cb832-61"><a href="stochastic-gradient-descent.html#cb832-61" aria-hidden="true" tabindex="-1"></a>    LP   <span class="ot">=</span> Xi <span class="sc">%*%</span> beta                           <span class="co"># matrix operations not necessary, </span></span>
<span id="cb832-62"><a href="stochastic-gradient-descent.html#cb832-62" aria-hidden="true" tabindex="-1"></a>    grad <span class="ot">=</span> <span class="fu">t</span>(Xi) <span class="sc">%*%</span> (LP <span class="sc">-</span> yi)                   <span class="co"># but makes consistent with standard gd func</span></span>
<span id="cb832-63"><a href="stochastic-gradient-descent.html#cb832-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb832-64"><a href="stochastic-gradient-descent.html#cb832-64" aria-hidden="true" tabindex="-1"></a>    <span class="co"># update</span></span>
<span id="cb832-65"><a href="stochastic-gradient-descent.html#cb832-65" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">=</span> beta <span class="sc">-</span> <span class="fu">update</span>(grad, ...)</span>
<span id="cb832-66"><a href="stochastic-gradient-descent.html#cb832-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb832-67"><a href="stochastic-gradient-descent.html#cb832-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (average <span class="sc">&amp;</span> i <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb832-68"><a href="stochastic-gradient-descent.html#cb832-68" aria-hidden="true" tabindex="-1"></a>      beta <span class="ot">=</span> beta <span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>i <span class="sc">*</span> (betamat[i <span class="sc">-</span> <span class="dv">1</span>, ] <span class="sc">-</span> beta)   <span class="co"># a variation</span></span>
<span id="cb832-69"><a href="stochastic-gradient-descent.html#cb832-69" aria-hidden="true" tabindex="-1"></a>    } </span>
<span id="cb832-70"><a href="stochastic-gradient-descent.html#cb832-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb832-71"><a href="stochastic-gradient-descent.html#cb832-71" aria-hidden="true" tabindex="-1"></a>    betamat[i,] <span class="ot">=</span> beta</span>
<span id="cb832-72"><a href="stochastic-gradient-descent.html#cb832-72" aria-hidden="true" tabindex="-1"></a>    grad_old <span class="ot">=</span> grad</span>
<span id="cb832-73"><a href="stochastic-gradient-descent.html#cb832-73" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb832-74"><a href="stochastic-gradient-descent.html#cb832-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb832-75"><a href="stochastic-gradient-descent.html#cb832-75" aria-hidden="true" tabindex="-1"></a>  LP <span class="ot">=</span> X <span class="sc">%*%</span> beta</span>
<span id="cb832-76"><a href="stochastic-gradient-descent.html#cb832-76" aria-hidden="true" tabindex="-1"></a>  lastloss <span class="ot">=</span> <span class="fu">crossprod</span>(LP <span class="sc">-</span> y)</span>
<span id="cb832-77"><a href="stochastic-gradient-descent.html#cb832-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb832-78"><a href="stochastic-gradient-descent.html#cb832-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb832-79"><a href="stochastic-gradient-descent.html#cb832-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">par =</span> beta,                               <span class="co"># final estimates</span></span>
<span id="cb832-80"><a href="stochastic-gradient-descent.html#cb832-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">par_chain =</span> betamat,                      <span class="co"># estimates at each iteration</span></span>
<span id="cb832-81"><a href="stochastic-gradient-descent.html#cb832-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">RMSE =</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(lastloss)<span class="sc">/</span><span class="fu">nrow</span>(X)),</span>
<span id="cb832-82"><a href="stochastic-gradient-descent.html#cb832-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">fitted =</span> LP</span>
<span id="cb832-83"><a href="stochastic-gradient-descent.html#cb832-83" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb832-84"><a href="stochastic-gradient-descent.html#cb832-84" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="estimation-50" class="section level3">
<h3>Estimation</h3>
<p>We’ll now use all four methods for estimation.</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="stochastic-gradient-descent.html#cb833-1" aria-hidden="true" tabindex="-1"></a>starting_values <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">ncol</span>(X))</span>
<span id="cb833-2"><a href="stochastic-gradient-descent.html#cb833-2" aria-hidden="true" tabindex="-1"></a><span class="co"># starting_values = runif(3, min = -1)</span></span>
<span id="cb833-3"><a href="stochastic-gradient-descent.html#cb833-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-4"><a href="stochastic-gradient-descent.html#cb833-4" aria-hidden="true" tabindex="-1"></a>fit_adagrad <span class="ot">=</span> <span class="fu">sgd</span>(</span>
<span id="cb833-5"><a href="stochastic-gradient-descent.html#cb833-5" aria-hidden="true" tabindex="-1"></a>  starting_values,</span>
<span id="cb833-6"><a href="stochastic-gradient-descent.html#cb833-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb833-7"><a href="stochastic-gradient-descent.html#cb833-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb833-8"><a href="stochastic-gradient-descent.html#cb833-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> .<span class="dv">1</span>  <span class="co"># suggestion is .01 for many settings, but this works better here</span></span>
<span id="cb833-9"><a href="stochastic-gradient-descent.html#cb833-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb833-10"><a href="stochastic-gradient-descent.html#cb833-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-11"><a href="stochastic-gradient-descent.html#cb833-11" aria-hidden="true" tabindex="-1"></a>fit_rmsprop <span class="ot">=</span> <span class="fu">sgd</span>(</span>
<span id="cb833-12"><a href="stochastic-gradient-descent.html#cb833-12" aria-hidden="true" tabindex="-1"></a>  starting_values,</span>
<span id="cb833-13"><a href="stochastic-gradient-descent.html#cb833-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb833-14"><a href="stochastic-gradient-descent.html#cb833-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb833-15"><a href="stochastic-gradient-descent.html#cb833-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="fl">1e-3</span>,</span>
<span id="cb833-16"><a href="stochastic-gradient-descent.html#cb833-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&#39;rmsprop&#39;</span></span>
<span id="cb833-17"><a href="stochastic-gradient-descent.html#cb833-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb833-18"><a href="stochastic-gradient-descent.html#cb833-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-19"><a href="stochastic-gradient-descent.html#cb833-19" aria-hidden="true" tabindex="-1"></a>fit_adam <span class="ot">=</span> <span class="fu">sgd</span>(</span>
<span id="cb833-20"><a href="stochastic-gradient-descent.html#cb833-20" aria-hidden="true" tabindex="-1"></a>  starting_values,</span>
<span id="cb833-21"><a href="stochastic-gradient-descent.html#cb833-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb833-22"><a href="stochastic-gradient-descent.html#cb833-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb833-23"><a href="stochastic-gradient-descent.html#cb833-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="fl">1e-3</span>,</span>
<span id="cb833-24"><a href="stochastic-gradient-descent.html#cb833-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&#39;adam&#39;</span></span>
<span id="cb833-25"><a href="stochastic-gradient-descent.html#cb833-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb833-26"><a href="stochastic-gradient-descent.html#cb833-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb833-27"><a href="stochastic-gradient-descent.html#cb833-27" aria-hidden="true" tabindex="-1"></a>fit_nadam <span class="ot">=</span> <span class="fu">sgd</span>(</span>
<span id="cb833-28"><a href="stochastic-gradient-descent.html#cb833-28" aria-hidden="true" tabindex="-1"></a>  starting_values,</span>
<span id="cb833-29"><a href="stochastic-gradient-descent.html#cb833-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb833-30"><a href="stochastic-gradient-descent.html#cb833-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y,</span>
<span id="cb833-31"><a href="stochastic-gradient-descent.html#cb833-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">stepsize =</span> <span class="fl">1e-3</span>,</span>
<span id="cb833-32"><a href="stochastic-gradient-descent.html#cb833-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&#39;nadam&#39;</span></span>
<span id="cb833-33"><a href="stochastic-gradient-descent.html#cb833-33" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="comparison-56" class="section level3">
<h3>Comparison</h3>
<p>We’ll compare our results to standard linear regression and the true values.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
fit
</th>
<th style="text-align:right;">
Intercept
</th>
<th style="text-align:right;">
x1
</th>
<th style="text-align:right;">
x2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fit_adagrad
</td>
<td style="text-align:right;">
1.0439
</td>
<td style="text-align:right;">
0.9748
</td>
<td style="text-align:right;">
-0.7459
</td>
</tr>
<tr>
<td style="text-align:left;">
fit_rmsprop
</td>
<td style="text-align:right;">
1.0355
</td>
<td style="text-align:right;">
0.9802
</td>
<td style="text-align:right;">
-0.7160
</td>
</tr>
<tr>
<td style="text-align:left;">
fit_adam
</td>
<td style="text-align:right;">
1.0429
</td>
<td style="text-align:right;">
0.9733
</td>
<td style="text-align:right;">
-0.7458
</td>
</tr>
<tr>
<td style="text-align:left;">
fit_nadam
</td>
<td style="text-align:right;">
1.0430
</td>
<td style="text-align:right;">
0.9735
</td>
<td style="text-align:right;">
-0.7459
</td>
</tr>
<tr>
<td style="text-align:left;">
fit_lm
</td>
<td style="text-align:right;">
1.0042
</td>
<td style="text-align:right;">
0.9851
</td>
<td style="text-align:right;">
-0.7510
</td>
</tr>
<tr>
<td style="text-align:left;">
true
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
-0.7500
</td>
</tr>
</tbody>
</table>
</div>
<div id="visualize-estimates-2" class="section level3">
<h3>Visualize Estimates</h3>
<p>We can visualize the route of estimation for each technique. While Adagrad works well for this particular problem, in standard machine learning contexts with possibly millions of parameters, and possibly massive data, it would quickly get to a point where it is no longer updating (the denominator continues to grow). These other techniques are attempts to get around the limitations of Adagrad.</p>
<p><img src="model-demos_files/figure-html/sgd-variant-vis-1.svg" width="75%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="source-50" class="section level2">
<h2>Source</h2>
<p>Original code available at <a href="https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/stochastic_gradient_descent.R" class="uri">https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/stochastic_gradient_descent.R</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="gradient-descent.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metropolis-hastings.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/stochastic-gradient-descent.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
