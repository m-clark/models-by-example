<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Reproducing Kernel Hilbert Space Regression | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Reproducing Kernel Hilbert Space Regression | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Reproducing Kernel Hilbert Space Regression | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="elm.html"/>
<link rel="next" href="cfa.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#maximum-likelihood-estimation"><i class="fa fa-check"></i>Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#issues-with-ml-estimation"><i class="fa fa-check"></i>Issues with ML estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial Regression</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal Regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#python-2"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gaussian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html"><i class="fa fa-check"></i>Neural Network</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-3"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-4"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-3"><i class="fa fa-check"></i>Example 3</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-5"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-2"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-22"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-26"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-27"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-9"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder-Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-44"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-24"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-49"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-52"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-32"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#sgd-variants"><i class="fa fa-check"></i>SGD Variants</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-33"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-55"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-2"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-52"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-11"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-56"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-53"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-52"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-57"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-52"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reproducing-kernel-hilbert-space-regression" class="section level1">
<h1>Reproducing Kernel Hilbert Space Regression</h1>
<p>This R code is based on Reproducing Kernel Hilbert Spaces for Penalized Regression: A tutorial, <a href="https://www.tandfonline.com/doi/abs/10.1080/00031305.2012.678196">Nosedal-Sanchez et al. (2010)</a>, specifically, their code in the <a href="https://github.com/m-clark/models-by-example/blob/main/rkhs_supplemental.pdf">supplemental section</a>. The original code had several issues as far as general R programming practices, and eventually appears to have been replaced in publication at some point, as did most of the corresponding supplemental text. I can no longer locate the original, so now follow the published code. The original data I was following was also replaced by the <span class="objclass" style="">longley</span> and <span class="objclass" style="">mcycle</span> data sets.</p>
<p>To start, we will use an example for <a href="ridge.html#l2-ridge-regularization">ridge regression</a>, followed by a <a href="cubic-spline">spline example</a>.</p>
<div id="data-setup-21" class="section level2">
<h2>Data Setup</h2>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="rkhs.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb380-2"><a href="rkhs.html#cb380-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-3"><a href="rkhs.html#cb380-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(longley)    <span class="co"># avaiable in base R</span></span>
<span id="cb380-4"><a href="rkhs.html#cb380-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-5"><a href="rkhs.html#cb380-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> longley[,<span class="dv">1</span>]</span>
<span id="cb380-6"><a href="rkhs.html#cb380-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">as.matrix</span>(longley[,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>])</span>
<span id="cb380-7"><a href="rkhs.html#cb380-7" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">apply</span>(X, <span class="dv">2</span>, scales<span class="sc">::</span>rescale, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="functions-5" class="section level2">
<h2>Functions</h2>
<div id="function-to-find-the-inverse-of-a-matrix" class="section level3">
<h3>Function to find the inverse of a matrix</h3>
<p>We can use <code>base::solve</code>, but this function avoids a computationally singular result.</p>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="rkhs.html#cb381-1" aria-hidden="true" tabindex="-1"></a>inverse <span class="ot">&lt;-</span> <span class="cf">function</span>(X, <span class="at">eps =</span> <span class="fl">1e-12</span>) {</span>
<span id="cb381-2"><a href="rkhs.html#cb381-2" aria-hidden="true" tabindex="-1"></a>  eig.X <span class="ot">=</span> <span class="fu">eigen</span>(X, <span class="at">symmetric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb381-3"><a href="rkhs.html#cb381-3" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">=</span> eig.X[[<span class="dv">2</span>]] </span>
<span id="cb381-4"><a href="rkhs.html#cb381-4" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">=</span> eig.X[[<span class="dv">1</span>]]</span>
<span id="cb381-5"><a href="rkhs.html#cb381-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb381-6"><a href="rkhs.html#cb381-6" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">=</span> lambda <span class="sc">&gt;</span> eps</span>
<span id="cb381-7"><a href="rkhs.html#cb381-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb381-8"><a href="rkhs.html#cb381-8" aria-hidden="true" tabindex="-1"></a>  lambda[ind]  <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>lambda[ind] </span>
<span id="cb381-9"><a href="rkhs.html#cb381-9" aria-hidden="true" tabindex="-1"></a>  lambda[<span class="sc">!</span>ind] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb381-10"><a href="rkhs.html#cb381-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb381-11"><a href="rkhs.html#cb381-11" aria-hidden="true" tabindex="-1"></a>  P <span class="sc">%*%</span> <span class="fu">diag</span>(lambda) <span class="sc">%*%</span> <span class="fu">t</span>(P)</span>
<span id="cb381-12"><a href="rkhs.html#cb381-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="reproducing-kernel" class="section level3">
<h3>Reproducing Kernel</h3>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="rkhs.html#cb382-1" aria-hidden="true" tabindex="-1"></a>rk <span class="ot">&lt;-</span> <span class="cf">function</span>(s, t) {</span>
<span id="cb382-2"><a href="rkhs.html#cb382-2" aria-hidden="true" tabindex="-1"></a>  init_len <span class="ot">=</span> <span class="fu">length</span>(s)</span>
<span id="cb382-3"><a href="rkhs.html#cb382-3" aria-hidden="true" tabindex="-1"></a>  rk <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb382-4"><a href="rkhs.html#cb382-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb382-5"><a href="rkhs.html#cb382-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>init_len)</span>
<span id="cb382-6"><a href="rkhs.html#cb382-6" aria-hidden="true" tabindex="-1"></a>    rk <span class="ot">=</span> s[i]<span class="sc">*</span>t[i] <span class="sc">+</span> rk</span>
<span id="cb382-7"><a href="rkhs.html#cb382-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb382-8"><a href="rkhs.html#cb382-8" aria-hidden="true" tabindex="-1"></a>  rk</span>
<span id="cb382-9"><a href="rkhs.html#cb382-9" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
</div>
<div id="gram-matrix" class="section level3">
<h3>Gram matrix</h3>
<p>For the first example involving ridge regression, the <span class="func" style="">gram</span> function just produces <code>tcrossprod(X)</code>. I generalize it in case a different kernel is desired, and add that as an additional argument. This will avoid having to redo the function later.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="rkhs.html#cb383-1" aria-hidden="true" tabindex="-1"></a>gram <span class="ot">&lt;-</span> <span class="cf">function</span>(X, <span class="at">rkfunc =</span> rk) {</span>
<span id="cb383-2"><a href="rkhs.html#cb383-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(X, <span class="dv">1</span>, <span class="cf">function</span>(Row) </span>
<span id="cb383-3"><a href="rkhs.html#cb383-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">apply</span>(X, <span class="dv">1</span>, <span class="cf">function</span>(tRow) <span class="fu">rkfunc</span>(Row, tRow))</span>
<span id="cb383-4"><a href="rkhs.html#cb383-4" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb383-5"><a href="rkhs.html#cb383-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="ridge-regression" class="section level3">
<h3>Ridge regression</h3>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="rkhs.html#cb384-1" aria-hidden="true" tabindex="-1"></a>ridge <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, lambda) {</span>
<span id="cb384-2"><a href="rkhs.html#cb384-2" aria-hidden="true" tabindex="-1"></a>  Gramm <span class="ot">=</span> <span class="fu">gram</span>(X)                                 <span class="co"># Gramm matrix (nxn)</span></span>
<span id="cb384-3"><a href="rkhs.html#cb384-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb384-4"><a href="rkhs.html#cb384-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(y)                                   </span>
<span id="cb384-5"><a href="rkhs.html#cb384-5" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, Gramm)                             <span class="co"># design matrix</span></span>
<span id="cb384-6"><a href="rkhs.html#cb384-6" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">=</span> <span class="fu">rbind</span>(<span class="dv">0</span>, <span class="fu">cbind</span>(<span class="dv">0</span>, Gramm))</span>
<span id="cb384-7"><a href="rkhs.html#cb384-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb384-8"><a href="rkhs.html#cb384-8" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">=</span> <span class="fu">crossprod</span>(Q) <span class="sc">+</span> lambda<span class="sc">*</span>S</span>
<span id="cb384-9"><a href="rkhs.html#cb384-9" aria-hidden="true" tabindex="-1"></a>  M_inv <span class="ot">=</span> <span class="fu">inverse</span>(M)                              <span class="co"># inverse of M</span></span>
<span id="cb384-10"><a href="rkhs.html#cb384-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb384-11"><a href="rkhs.html#cb384-11" aria-hidden="true" tabindex="-1"></a>  gamma_hat <span class="ot">=</span> <span class="fu">crossprod</span>(M_inv, <span class="fu">crossprod</span>(Q, y))</span>
<span id="cb384-12"><a href="rkhs.html#cb384-12" aria-hidden="true" tabindex="-1"></a>  f_hat <span class="ot">=</span> Q <span class="sc">%*%</span> gamma_hat</span>
<span id="cb384-13"><a href="rkhs.html#cb384-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb384-14"><a href="rkhs.html#cb384-14" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">=</span> Q <span class="sc">%*%</span> M_inv <span class="sc">%*%</span> <span class="fu">t</span>(Q)</span>
<span id="cb384-15"><a href="rkhs.html#cb384-15" aria-hidden="true" tabindex="-1"></a>  tr_A <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">diag</span>(A))                             <span class="co"># trace of hat matrix</span></span>
<span id="cb384-16"><a href="rkhs.html#cb384-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb384-17"><a href="rkhs.html#cb384-17" aria-hidden="true" tabindex="-1"></a>  rss  <span class="ot">=</span> <span class="fu">crossprod</span>(y <span class="sc">-</span> f_hat)                     <span class="co"># residual sum of squares</span></span>
<span id="cb384-18"><a href="rkhs.html#cb384-18" aria-hidden="true" tabindex="-1"></a>  gcv  <span class="ot">=</span> n<span class="sc">*</span>rss <span class="sc">/</span> (n <span class="sc">-</span> tr_A)<span class="sc">^</span><span class="dv">2</span>                     <span class="co"># obtain GCV score</span></span>
<span id="cb384-19"><a href="rkhs.html#cb384-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb384-20"><a href="rkhs.html#cb384-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb384-21"><a href="rkhs.html#cb384-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">f_hat =</span> f_hat,</span>
<span id="cb384-22"><a href="rkhs.html#cb384-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma_hat =</span> gamma_hat,</span>
<span id="cb384-23"><a href="rkhs.html#cb384-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">beta_hat =</span> <span class="fu">c</span>(gamma_hat[<span class="dv">1</span>], <span class="fu">crossprod</span>(gamma_hat[<span class="sc">-</span><span class="dv">1</span>], X)),</span>
<span id="cb384-24"><a href="rkhs.html#cb384-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">gcv =</span> gcv</span>
<span id="cb384-25"><a href="rkhs.html#cb384-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb384-26"><a href="rkhs.html#cb384-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="estimation-19" class="section level2">
<h2>Estimation</h2>
<p>A simple direct search for the GCV optimal smoothing parameter can be made as follows:</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="rkhs.html#cb385-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">0</span>, <span class="at">by =</span> .<span class="dv">1</span>)</span>
<span id="cb385-2"><a href="rkhs.html#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="rkhs.html#cb385-3" aria-hidden="true" tabindex="-1"></a>gcv_search <span class="ot">=</span> <span class="fu">map</span>(lambda, <span class="cf">function</span>(lam) <span class="fu">ridge</span>(X, y, lam))</span>
<span id="cb385-4"><a href="rkhs.html#cb385-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-5"><a href="rkhs.html#cb385-5" aria-hidden="true" tabindex="-1"></a>V <span class="ot">=</span> <span class="fu">map_dbl</span>(gcv_search, <span class="cf">function</span>(x) x<span class="sc">$</span>gcv)</span>
<span id="cb385-6"><a href="rkhs.html#cb385-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-7"><a href="rkhs.html#cb385-7" aria-hidden="true" tabindex="-1"></a>ridge_coefs <span class="ot">=</span> <span class="fu">map_df</span>(</span>
<span id="cb385-8"><a href="rkhs.html#cb385-8" aria-hidden="true" tabindex="-1"></a>  gcv_search, </span>
<span id="cb385-9"><a href="rkhs.html#cb385-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">function</span>(x)</span>
<span id="cb385-10"><a href="rkhs.html#cb385-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb385-11"><a href="rkhs.html#cb385-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> x<span class="sc">$</span>beta_hat[<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb385-12"><a href="rkhs.html#cb385-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">coef  =</span> <span class="fu">colnames</span>(X)</span>
<span id="cb385-13"><a href="rkhs.html#cb385-13" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb385-14"><a href="rkhs.html#cb385-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">.id =</span> <span class="st">&#39;iter&#39;</span></span>
<span id="cb385-15"><a href="rkhs.html#cb385-15" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb385-16"><a href="rkhs.html#cb385-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lambda =</span> lambda[<span class="fu">as.integer</span>(iter)])</span></code></pre></div>
<p>Compare with Figure 3 in the article.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="rkhs.html#cb386-1" aria-hidden="true" tabindex="-1"></a>gcv_plot <span class="ot">=</span> <span class="fu">qplot</span>(</span>
<span id="cb386-2"><a href="rkhs.html#cb386-2" aria-hidden="true" tabindex="-1"></a>  lambda,</span>
<span id="cb386-3"><a href="rkhs.html#cb386-3" aria-hidden="true" tabindex="-1"></a>  V,</span>
<span id="cb386-4"><a href="rkhs.html#cb386-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">geom =</span> <span class="st">&#39;line&#39;</span>,</span>
<span id="cb386-5"><a href="rkhs.html#cb386-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&#39;GCV score&#39;</span>,</span>
<span id="cb386-6"><a href="rkhs.html#cb386-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&#39;GCV&#39;</span></span>
<span id="cb386-7"><a href="rkhs.html#cb386-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb386-8"><a href="rkhs.html#cb386-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span>
<span id="cb386-9"><a href="rkhs.html#cb386-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-10"><a href="rkhs.html#cb386-10" aria-hidden="true" tabindex="-1"></a>beta_plot <span class="ot">=</span> ridge_coefs <span class="sc">%&gt;%</span> </span>
<span id="cb386-11"><a href="rkhs.html#cb386-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> value, <span class="at">color =</span> coef)) <span class="sc">+</span></span>
<span id="cb386-12"><a href="rkhs.html#cb386-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb386-13"><a href="rkhs.html#cb386-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb386-14"><a href="rkhs.html#cb386-14" aria-hidden="true" tabindex="-1"></a>  scico<span class="sc">::</span><span class="fu">scale_color_scico_d</span>(<span class="at">end =</span> .<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb386-15"><a href="rkhs.html#cb386-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Betas Across Lambda&#39;</span>)</span></code></pre></div>
<p><img src="model-demos_files/figure-html/rk-ridge-plot-show-1.svg" width="1200px" style="display: block; margin: auto;" /></p>
<p>Pick the best model and obtain the estimates.</p>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="rkhs.html#cb387-1" aria-hidden="true" tabindex="-1"></a>fit_ridge <span class="ot">=</span> <span class="fu">ridge</span>(X, y, lambda[<span class="fu">which.min</span>(V)])  <span class="co"># fit optimal model</span></span>
<span id="cb387-2"><a href="rkhs.html#cb387-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb387-3"><a href="rkhs.html#cb387-3" aria-hidden="true" tabindex="-1"></a>gamma_hat <span class="ot">=</span> fit_ridge<span class="sc">$</span>gamma_hat</span>
<span id="cb387-4"><a href="rkhs.html#cb387-4" aria-hidden="true" tabindex="-1"></a>beta_0    <span class="ot">=</span> fit_ridge<span class="sc">$</span>gamma_hat[<span class="dv">1</span>]             <span class="co"># intercept</span></span>
<span id="cb387-5"><a href="rkhs.html#cb387-5" aria-hidden="true" tabindex="-1"></a>beta_hat  <span class="ot">=</span> <span class="fu">crossprod</span>(gamma_hat[<span class="sc">-</span><span class="dv">1</span>,], X)         <span class="co"># slope and noise term coefficients</span></span></code></pre></div>
</div>
<div id="comparison-24" class="section level2">
<h2>Comparison</h2>
<p>I add a comparison to <span class="pack" style="">glmnet</span>, where setting <code>alpha = 0</code> is equivalent to ridge regression.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="rkhs.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(beta_0, beta_hat)</span></code></pre></div>
<pre><code>[1]  82.7840043  54.1683427   5.3640251   1.3781910 -28.7948627   5.3956341  -0.6095799</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="rkhs.html#cb390-1" aria-hidden="true" tabindex="-1"></a>fit_glmnet <span class="ot">=</span> glmnet<span class="sc">::</span><span class="fu">glmnet</span>(</span>
<span id="cb390-2"><a href="rkhs.html#cb390-2" aria-hidden="true" tabindex="-1"></a>  X,</span>
<span id="cb390-3"><a href="rkhs.html#cb390-3" aria-hidden="true" tabindex="-1"></a>  y,</span>
<span id="cb390-4"><a href="rkhs.html#cb390-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha  =</span> <span class="dv">0</span>,</span>
<span id="cb390-5"><a href="rkhs.html#cb390-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambda =</span> lambda,</span>
<span id="cb390-6"><a href="rkhs.html#cb390-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardize =</span> <span class="cn">FALSE</span></span>
<span id="cb390-7"><a href="rkhs.html#cb390-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
(Intercept)
</th>
<th style="text-align:right;">
GNP
</th>
<th style="text-align:right;">
Unemployed
</th>
<th style="text-align:right;">
Armed.Forces
</th>
<th style="text-align:right;">
Population
</th>
<th style="text-align:right;">
Year
</th>
<th style="text-align:right;">
Employed
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
fit_ridge
</td>
<td style="text-align:right;">
82.784
</td>
<td style="text-align:right;">
54.168
</td>
<td style="text-align:right;">
5.364
</td>
<td style="text-align:right;">
1.378
</td>
<td style="text-align:right;">
-28.795
</td>
<td style="text-align:right;">
5.396
</td>
<td style="text-align:right;">
-0.610
</td>
</tr>
<tr>
<td style="text-align:left;">
fit_glmnet
</td>
<td style="text-align:right;">
82.329
</td>
<td style="text-align:right;">
69.783
</td>
<td style="text-align:right;">
6.963
</td>
<td style="text-align:right;">
1.245
</td>
<td style="text-align:right;">
-37.323
</td>
<td style="text-align:right;">
-1.497
</td>
<td style="text-align:right;">
-1.606
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-cubic-spline" class="section level2">
<h2>Example: Cubic Spline</h2>
<div id="data-setup-22" class="section level3">
<h3>Data Setup</h3>
<p>For this example we’ll use the <code>MASS::mcycle</code> data.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="rkhs.html#cb391-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">as.matrix</span>(MASS<span class="sc">::</span>mcycle<span class="sc">$</span>times)</span>
<span id="cb391-2"><a href="rkhs.html#cb391-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> scales<span class="sc">::</span><span class="fu">rescale</span>(x, <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="co"># rescale predictor to [0,1]</span></span>
<span id="cb391-3"><a href="rkhs.html#cb391-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> MASS<span class="sc">::</span>mcycle<span class="sc">$</span>accel</span></code></pre></div>
</div>
<div id="functions-6" class="section level3">
<h3>Functions</h3>
<div id="reproducing-kernel-1" class="section level4">
<h4>Reproducing Kernel</h4>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="rkhs.html#cb392-1" aria-hidden="true" tabindex="-1"></a>rk_spline <span class="ot">&lt;-</span> <span class="cf">function</span>(s, t) {</span>
<span id="cb392-2"><a href="rkhs.html#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(.<span class="dv">5</span> <span class="sc">*</span> <span class="fu">min</span>(s, t)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">max</span>(s, t) <span class="sc">-</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>) <span class="sc">*</span> <span class="fu">min</span>(s, t)<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb392-3"><a href="rkhs.html#cb392-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>No need to redo the gram function do to previous change that accepts the kernel as an argument</p>
</div>
<div id="smoothing-spline" class="section level4">
<h4>Smoothing Spline</h4>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="rkhs.html#cb393-1" aria-hidden="true" tabindex="-1"></a>smoothing_spline <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, lambda) {</span>
<span id="cb393-2"><a href="rkhs.html#cb393-2" aria-hidden="true" tabindex="-1"></a>  Gramm <span class="ot">=</span> <span class="fu">gram</span>(X, <span class="at">rkfunc =</span> rk_spline)   <span class="co"># Gramm matrix (nxn)</span></span>
<span id="cb393-3"><a href="rkhs.html#cb393-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-4"><a href="rkhs.html#cb393-4" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(y)</span>
<span id="cb393-5"><a href="rkhs.html#cb393-5" aria-hidden="true" tabindex="-1"></a>  J <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X)                       <span class="co"># matrix with a basis for the null space of the penalty</span></span>
<span id="cb393-6"><a href="rkhs.html#cb393-6" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">=</span> <span class="fu">cbind</span>(J, Gramm)                   <span class="co"># design matrix</span></span>
<span id="cb393-7"><a href="rkhs.html#cb393-7" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">=</span> <span class="fu">ncol</span>(J)                           <span class="co"># dimension of the null space of the penalty</span></span>
<span id="cb393-8"><a href="rkhs.html#cb393-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-9"><a href="rkhs.html#cb393-9" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n <span class="sc">+</span> m, n <span class="sc">+</span> m)                        <span class="co"># initialize S</span></span>
<span id="cb393-10"><a href="rkhs.html#cb393-10" aria-hidden="true" tabindex="-1"></a>  S[(m <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m), (m <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m)] <span class="ot">=</span> Gramm        <span class="co"># non-zero part of S</span></span>
<span id="cb393-11"><a href="rkhs.html#cb393-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-12"><a href="rkhs.html#cb393-12" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">=</span> <span class="fu">crossprod</span>(Q) <span class="sc">+</span> lambda<span class="sc">*</span>S</span>
<span id="cb393-13"><a href="rkhs.html#cb393-13" aria-hidden="true" tabindex="-1"></a>  M_inv <span class="ot">=</span> <span class="fu">inverse</span>(M)                                 <span class="co"># inverse of M</span></span>
<span id="cb393-14"><a href="rkhs.html#cb393-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-15"><a href="rkhs.html#cb393-15" aria-hidden="true" tabindex="-1"></a>  gamma_hat <span class="ot">=</span> <span class="fu">crossprod</span>(M_inv, <span class="fu">crossprod</span>(Q, y))</span>
<span id="cb393-16"><a href="rkhs.html#cb393-16" aria-hidden="true" tabindex="-1"></a>  f_hat <span class="ot">=</span> Q <span class="sc">%*%</span> gamma_hat</span>
<span id="cb393-17"><a href="rkhs.html#cb393-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-18"><a href="rkhs.html#cb393-18" aria-hidden="true" tabindex="-1"></a>  A    <span class="ot">=</span> Q <span class="sc">%*%</span> M_inv <span class="sc">%*%</span> <span class="fu">t</span>(Q)</span>
<span id="cb393-19"><a href="rkhs.html#cb393-19" aria-hidden="true" tabindex="-1"></a>  tr_A <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">diag</span>(A))                                <span class="co"># trace of hat matrix</span></span>
<span id="cb393-20"><a href="rkhs.html#cb393-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-21"><a href="rkhs.html#cb393-21" aria-hidden="true" tabindex="-1"></a>  rss <span class="ot">=</span> <span class="fu">crossprod</span>(y <span class="sc">-</span> f_hat)                         <span class="co"># residual sum of squares</span></span>
<span id="cb393-22"><a href="rkhs.html#cb393-22" aria-hidden="true" tabindex="-1"></a>  gcv <span class="ot">=</span> n <span class="sc">*</span> rss<span class="sc">/</span>(n <span class="sc">-</span> tr_A)<span class="sc">^</span><span class="dv">2</span>                         <span class="co"># obtain GCV score</span></span>
<span id="cb393-23"><a href="rkhs.html#cb393-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-24"><a href="rkhs.html#cb393-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb393-25"><a href="rkhs.html#cb393-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">f_hat =</span> f_hat,</span>
<span id="cb393-26"><a href="rkhs.html#cb393-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma_hat =</span> gamma_hat,</span>
<span id="cb393-27"><a href="rkhs.html#cb393-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">gcv =</span> gcv</span>
<span id="cb393-28"><a href="rkhs.html#cb393-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb393-29"><a href="rkhs.html#cb393-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="estimation-20" class="section level3">
<h3>Estimation</h3>
<p>We’ll now get fits for multiple lambda values.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="rkhs.html#cb394-1" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">0</span>, <span class="at">by =</span> .<span class="dv">1</span>)</span>
<span id="cb394-2"><a href="rkhs.html#cb394-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-3"><a href="rkhs.html#cb394-3" aria-hidden="true" tabindex="-1"></a>gcv_search <span class="ot">=</span> <span class="fu">map</span>(lambda, <span class="cf">function</span>(lam) <span class="fu">smoothing_spline</span>(x, y, lam))</span>
<span id="cb394-4"><a href="rkhs.html#cb394-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-5"><a href="rkhs.html#cb394-5" aria-hidden="true" tabindex="-1"></a>V <span class="ot">=</span> <span class="fu">map_dbl</span>(gcv_search, <span class="cf">function</span>(x) x<span class="sc">$</span>gcv)</span></code></pre></div>
<p>Plot of GCV across different lambdas.</p>
</div>
<div id="comparison-25" class="section level3">
<h3>Comparison</h3>
<p>I’ve added comparison to an additive model using <span class="pack" style="">mgcv</span>. Compare the result to Figure 2 of the Supplementary Material.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="rkhs.html#cb395-1" aria-hidden="true" tabindex="-1"></a>fit_rk  <span class="ot">=</span> <span class="fu">smoothing_spline</span>(x, y, lambda[<span class="fu">which.min</span>(V)])   <span class="co"># fit optimal model</span></span>
<span id="cb395-2"><a href="rkhs.html#cb395-2" aria-hidden="true" tabindex="-1"></a>fit_gam <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">gam</span>(y <span class="sc">~</span> <span class="fu">s</span>(x))</span></code></pre></div>
<p><img src="model-demos_files/figure-html/rk-spline-comparison-1.svg" width="1200px" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="source-22" class="section level2">
<h2>Source</h2>
<p>Original code available at:
<a href="https://github.com/m-clark/Miscellaneous-R-Code/tree/master/ModelFitting/RKHSReg" class="uri">https://github.com/m-clark/Miscellaneous-R-Code/tree/master/ModelFitting/RKHSReg</a></p>
<div id="current-supplemental-code" class="section level3">
<h3>Current Supplemental Code</h3>
<p>You can peruse the supplemental section that shows the R code <a href="https://github.com/m-clark/models-by-example/blob/main/rkhs_supplemental.pdf">here</a>.</p>
</div>
<div id="original-supplemental-code" class="section level3">
<h3>Original Supplemental Code</h3>
<p>This was the old original code from the supplemental section for the article, but was changed at some point (I can’t remember, it may have been at one of the author’s website). The R code on the repo follows these examples, while this document follows the currently accessible supplementary material. I used RStudio’s default cleanup to make the code a little easier to read, and maybe added a little spacing, but otherwise it is identical to what’s in the linked paper.</p>
<div id="a.1" class="section level4">
<h4>A.1</h4>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="rkhs.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Data ########</span></span>
<span id="cb396-2"><a href="rkhs.html#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb396-3"><a href="rkhs.html#cb396-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb396-4"><a href="rkhs.html#cb396-4" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb396-5"><a href="rkhs.html#cb396-5" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb396-6"><a href="rkhs.html#cb396-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(x1, x2), <span class="at">ncol =</span> <span class="dv">2</span>) <span class="co"># design matrix</span></span>
<span id="cb396-7"><a href="rkhs.html#cb396-7" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.25</span>)</span>
<span id="cb396-8"><a href="rkhs.html#cb396-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-9"><a href="rkhs.html#cb396-9" aria-hidden="true" tabindex="-1"></a><span class="do">##### function to find the inverse of a matrix ####</span></span>
<span id="cb396-10"><a href="rkhs.html#cb396-10" aria-hidden="true" tabindex="-1"></a>my.inv <span class="ot">&lt;-</span> <span class="cf">function</span>(X, <span class="at">eps =</span> <span class="fl">1e-12</span>) {</span>
<span id="cb396-11"><a href="rkhs.html#cb396-11" aria-hidden="true" tabindex="-1"></a>  eig.X <span class="ot">&lt;-</span> <span class="fu">eigen</span>(X, <span class="at">symmetric =</span> T)</span>
<span id="cb396-12"><a href="rkhs.html#cb396-12" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">&lt;-</span> eig.X[[<span class="dv">2</span>]] </span>
<span id="cb396-13"><a href="rkhs.html#cb396-13" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> eig.X[[<span class="dv">1</span>]] </span>
<span id="cb396-14"><a href="rkhs.html#cb396-14" aria-hidden="true" tabindex="-1"></a>  ind <span class="ot">&lt;-</span> lambda <span class="sc">&gt;</span> eps</span>
<span id="cb396-15"><a href="rkhs.html#cb396-15" aria-hidden="true" tabindex="-1"></a>  lambda[ind] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> lambda[ind] </span>
<span id="cb396-16"><a href="rkhs.html#cb396-16" aria-hidden="true" tabindex="-1"></a>  lambda[<span class="sc">!</span>ind] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb396-17"><a href="rkhs.html#cb396-17" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> P <span class="sc">%*%</span> <span class="fu">diag</span>(lambda, <span class="at">nrow =</span> <span class="fu">length</span>(lambda)) <span class="sc">%*%</span> <span class="fu">t</span>(P)</span>
<span id="cb396-18"><a href="rkhs.html#cb396-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ans)</span>
<span id="cb396-19"><a href="rkhs.html#cb396-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb396-20"><a href="rkhs.html#cb396-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-21"><a href="rkhs.html#cb396-21" aria-hidden="true" tabindex="-1"></a><span class="do">###### Reproducing Kernel #########</span></span>
<span id="cb396-22"><a href="rkhs.html#cb396-22" aria-hidden="true" tabindex="-1"></a>rk <span class="ot">&lt;-</span> <span class="cf">function</span>(s, t) {</span>
<span id="cb396-23"><a href="rkhs.html#cb396-23" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">length</span>(s)</span>
<span id="cb396-24"><a href="rkhs.html#cb396-24" aria-hidden="true" tabindex="-1"></a>  rk <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb396-25"><a href="rkhs.html#cb396-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p) {</span>
<span id="cb396-26"><a href="rkhs.html#cb396-26" aria-hidden="true" tabindex="-1"></a>    rk <span class="ot">&lt;-</span> s[i] <span class="sc">*</span> t[i] <span class="sc">+</span> rk</span>
<span id="cb396-27"><a href="rkhs.html#cb396-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb396-28"><a href="rkhs.html#cb396-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((rk))</span>
<span id="cb396-29"><a href="rkhs.html#cb396-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb396-30"><a href="rkhs.html#cb396-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-31"><a href="rkhs.html#cb396-31" aria-hidden="true" tabindex="-1"></a><span class="do">##### Gram matrix #######</span></span>
<span id="cb396-32"><a href="rkhs.html#cb396-32" aria-hidden="true" tabindex="-1"></a>get.gramm <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb396-33"><a href="rkhs.html#cb396-33" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">1</span>]</span>
<span id="cb396-34"><a href="rkhs.html#cb396-34" aria-hidden="true" tabindex="-1"></a>  Gramm <span class="ot">&lt;-</span></span>
<span id="cb396-35"><a href="rkhs.html#cb396-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix</span>(<span class="dv">0</span>, n, n) <span class="co">#initializes Gramm array #i=index for rows</span></span>
<span id="cb396-36"><a href="rkhs.html#cb396-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">#j=index for columns Gramm&lt;-as.matrix(Gramm) # Gramm matrix</span></span>
<span id="cb396-37"><a href="rkhs.html#cb396-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb396-38"><a href="rkhs.html#cb396-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb396-39"><a href="rkhs.html#cb396-39" aria-hidden="true" tabindex="-1"></a>      Gramm[i, j] <span class="ot">&lt;-</span> <span class="fu">rk</span>(X[i,], X[j,])</span>
<span id="cb396-40"><a href="rkhs.html#cb396-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb396-41"><a href="rkhs.html#cb396-41" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb396-42"><a href="rkhs.html#cb396-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Gramm)</span>
<span id="cb396-43"><a href="rkhs.html#cb396-43" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb396-44"><a href="rkhs.html#cb396-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-45"><a href="rkhs.html#cb396-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-46"><a href="rkhs.html#cb396-46" aria-hidden="true" tabindex="-1"></a>ridge.regression <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, lambda) {</span>
<span id="cb396-47"><a href="rkhs.html#cb396-47" aria-hidden="true" tabindex="-1"></a>  Gramm <span class="ot">&lt;-</span> <span class="fu">get.gramm</span>(X) <span class="co">#Gramm matrix (nxn)</span></span>
<span id="cb396-48"><a href="rkhs.html#cb396-48" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">1</span>] <span class="co"># n=length of y</span></span>
<span id="cb396-49"><a href="rkhs.html#cb396-49" aria-hidden="true" tabindex="-1"></a>  J <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, n, <span class="dv">1</span>) <span class="co"># vector of ones dim</span></span>
<span id="cb396-50"><a href="rkhs.html#cb396-50" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">&lt;-</span> <span class="fu">cbind</span>(J, Gramm) <span class="co"># design matrix</span></span>
<span id="cb396-51"><a href="rkhs.html#cb396-51" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># dimension of the null space of the penalty</span></span>
<span id="cb396-52"><a href="rkhs.html#cb396-52" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n <span class="sc">+</span> m, n <span class="sc">+</span> m) <span class="co">#initialize S</span></span>
<span id="cb396-53"><a href="rkhs.html#cb396-53" aria-hidden="true" tabindex="-1"></a>  S[(m <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m), (m <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m)] <span class="ot">&lt;-</span> Gramm <span class="co">#non-zero part of S</span></span>
<span id="cb396-54"><a href="rkhs.html#cb396-54" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> (<span class="fu">t</span>(Q) <span class="sc">%*%</span> Q <span class="sc">+</span> lambda <span class="sc">*</span> S)</span>
<span id="cb396-55"><a href="rkhs.html#cb396-55" aria-hidden="true" tabindex="-1"></a>  M.inv <span class="ot">&lt;-</span> <span class="fu">my.inv</span>(M) <span class="co"># inverse of M</span></span>
<span id="cb396-56"><a href="rkhs.html#cb396-56" aria-hidden="true" tabindex="-1"></a>  gamma.hat <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(M.inv, <span class="fu">crossprod</span>(Q, y))</span>
<span id="cb396-57"><a href="rkhs.html#cb396-57" aria-hidden="true" tabindex="-1"></a>  f.hat <span class="ot">&lt;-</span> Q <span class="sc">%*%</span> gamma.hat</span>
<span id="cb396-58"><a href="rkhs.html#cb396-58" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> Q <span class="sc">%*%</span> M.inv <span class="sc">%*%</span> <span class="fu">t</span>(Q)</span>
<span id="cb396-59"><a href="rkhs.html#cb396-59" aria-hidden="true" tabindex="-1"></a>  tr.A <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(A)) <span class="co">#trace of hat matrix</span></span>
<span id="cb396-60"><a href="rkhs.html#cb396-60" aria-hidden="true" tabindex="-1"></a>  rss <span class="ot">&lt;-</span> <span class="fu">t</span>(y <span class="sc">-</span> f.hat) <span class="sc">%*%</span> (y <span class="sc">-</span> f.hat) <span class="co">#residual sum of squares</span></span>
<span id="cb396-61"><a href="rkhs.html#cb396-61" aria-hidden="true" tabindex="-1"></a>  gcv <span class="ot">&lt;-</span> n <span class="sc">*</span> rss <span class="sc">/</span> (n <span class="sc">-</span> tr.A) <span class="sc">^</span> <span class="dv">2</span> <span class="co">#obtain GCV score</span></span>
<span id="cb396-62"><a href="rkhs.html#cb396-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb396-63"><a href="rkhs.html#cb396-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">f.hat =</span> f.hat,</span>
<span id="cb396-64"><a href="rkhs.html#cb396-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma.hat =</span> gamma.hat,</span>
<span id="cb396-65"><a href="rkhs.html#cb396-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">gcv =</span> gcv</span>
<span id="cb396-66"><a href="rkhs.html#cb396-66" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb396-67"><a href="rkhs.html#cb396-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb396-68"><a href="rkhs.html#cb396-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-69"><a href="rkhs.html#cb396-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-70"><a href="rkhs.html#cb396-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot of GCV</span></span>
<span id="cb396-71"><a href="rkhs.html#cb396-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-72"><a href="rkhs.html#cb396-72" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fl">1e-8</span></span>
<span id="cb396-73"><a href="rkhs.html#cb396-73" aria-hidden="true" tabindex="-1"></a>V <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">40</span>)</span>
<span id="cb396-74"><a href="rkhs.html#cb396-74" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>) {</span>
<span id="cb396-75"><a href="rkhs.html#cb396-75" aria-hidden="true" tabindex="-1"></a>  V[i] <span class="ot">&lt;-</span> <span class="fu">ridge.regression</span>(X, y, lambda)<span class="sc">$</span>gcv <span class="co">#obtain GCV score</span></span>
<span id="cb396-76"><a href="rkhs.html#cb396-76" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda <span class="sc">*</span> <span class="fl">1.5</span> <span class="co">#increase lambda</span></span>
<span id="cb396-77"><a href="rkhs.html#cb396-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb396-78"><a href="rkhs.html#cb396-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-79"><a href="rkhs.html#cb396-79" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>) </span>
<span id="cb396-80"><a href="rkhs.html#cb396-80" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb396-81"><a href="rkhs.html#cb396-81" aria-hidden="true" tabindex="-1"></a>  <span class="fl">1.5</span> <span class="sc">^</span> (index <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fl">1e-8</span>,</span>
<span id="cb396-82"><a href="rkhs.html#cb396-82" aria-hidden="true" tabindex="-1"></a>  V,</span>
<span id="cb396-83"><a href="rkhs.html#cb396-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb396-84"><a href="rkhs.html#cb396-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;GCV</span></span>
<span id="cb396-85"><a href="rkhs.html#cb396-85" aria-hidden="true" tabindex="-1"></a><span class="st">  score&quot;</span>,</span>
<span id="cb396-86"><a href="rkhs.html#cb396-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb396-87"><a href="rkhs.html#cb396-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;lambda&quot;</span>,</span>
<span id="cb396-88"><a href="rkhs.html#cb396-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;GCV&quot;</span></span>
<span id="cb396-89"><a href="rkhs.html#cb396-89" aria-hidden="true" tabindex="-1"></a>) <span class="co"># plot score</span></span>
<span id="cb396-90"><a href="rkhs.html#cb396-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-91"><a href="rkhs.html#cb396-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-92"><a href="rkhs.html#cb396-92" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>)[V <span class="sc">==</span> <span class="fu">min</span>(V)] <span class="co"># extract index of min(V)</span></span>
<span id="cb396-93"><a href="rkhs.html#cb396-93" aria-hidden="true" tabindex="-1"></a>opt.mod <span class="ot">&lt;-</span> <span class="fu">ridge.regression</span>(X, y, <span class="fl">1.5</span> <span class="sc">^</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fl">1e-8</span>) <span class="co">#fit optimal model</span></span>
<span id="cb396-94"><a href="rkhs.html#cb396-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-95"><a href="rkhs.html#cb396-95" aria-hidden="true" tabindex="-1"></a><span class="do">### finding beta.0, beta.1 and beta.2 ##########</span></span>
<span id="cb396-96"><a href="rkhs.html#cb396-96" aria-hidden="true" tabindex="-1"></a>gamma.hat <span class="ot">&lt;-</span> opt.mod<span class="sc">$</span>gamma.hat</span>
<span id="cb396-97"><a href="rkhs.html#cb396-97" aria-hidden="true" tabindex="-1"></a>beta.hat<span class="fl">.0</span> <span class="ot">&lt;-</span> opt.mod<span class="sc">$</span>gamma.hat[<span class="dv">1</span>]<span class="co">#intercept</span></span>
<span id="cb396-98"><a href="rkhs.html#cb396-98" aria-hidden="true" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> gamma.hat[<span class="dv">2</span><span class="sc">:</span><span class="dv">21</span>,] <span class="sc">%*%</span> X <span class="co">#slope and noise term coefficients</span></span>
<span id="cb396-99"><a href="rkhs.html#cb396-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-100"><a href="rkhs.html#cb396-100" aria-hidden="true" tabindex="-1"></a><span class="do">#### Fitted Line Plot for Cubic Smoothing Spline ####</span></span>
<span id="cb396-101"><a href="rkhs.html#cb396-101" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[,<span class="dv">1</span>],y,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;response&quot;</span>,<span class="at">main=</span><span class="st">&quot;Cubic Smoothing Spline&quot;</span>) ;</span>
<span id="cb396-102"><a href="rkhs.html#cb396-102" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[,<span class="dv">1</span>],opt.mod<span class="sc">$</span>f.hat,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;blue&quot;</span>) ;</span></code></pre></div>
</div>
<div id="a.2" class="section level4">
<h4>A.2</h4>
<blockquote>
<p>A.2 RKHS solution applied to Cubic Smoothing Spline <br>
We consider a sample of size n = 50, (<span class="math inline">\(y_1, y_2, y_3, ..., y_{50}\)</span>), from the model
<span class="math inline">\(y_i = sin(2πx_i) + ϵ_i\)</span> where ϵ<sub>i</sub> has a N(0, 0.2<sup>2</sup>) . The following code generates x
and y…</p>
</blockquote>
<blockquote>
<p>A simple direct search for the GCV optimal smoothing parameter can be made as follows:
Now we have to find an optimal lambda using GCV…</p>
</blockquote>
<blockquote>
<p>Below we give a function to find the cubic smoothing spline using the RKHS
framework we discussed in Section 4.3. We also provide a graph with our
estimation along with the true function and data.</p>
</blockquote>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="rkhs.html#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="do">###### Data ######## </span></span>
<span id="cb397-2"><a href="rkhs.html#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>) </span>
<span id="cb397-3"><a href="rkhs.html#cb397-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb397-4"><a href="rkhs.html#cb397-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(n), nrow, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb397-5"><a href="rkhs.html#cb397-5" aria-hidden="true" tabindex="-1"></a>x.star <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sort</span>(x), nrow, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="co"># sorted x, used by plot</span></span>
<span id="cb397-6"><a href="rkhs.html#cb397-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x.star) <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.2</span>)</span>
<span id="cb397-7"><a href="rkhs.html#cb397-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-8"><a href="rkhs.html#cb397-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-9"><a href="rkhs.html#cb397-9" aria-hidden="true" tabindex="-1"></a><span class="do">#### Reproducing Kernel for &lt;f,g&gt;=int_0^1 f’’(x)g’’(x)dx #####</span></span>
<span id="cb397-10"><a href="rkhs.html#cb397-10" aria-hidden="true" tabindex="-1"></a>rk<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(s, t) {</span>
<span id="cb397-11"><a href="rkhs.html#cb397-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">min</span>(s, t) <span class="sc">^</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="fu">max</span>(s, t) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>) <span class="sc">*</span> (<span class="fu">min</span>(s, t)) <span class="sc">^</span> <span class="dv">3</span>)</span>
<span id="cb397-12"><a href="rkhs.html#cb397-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb397-13"><a href="rkhs.html#cb397-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-14"><a href="rkhs.html#cb397-14" aria-hidden="true" tabindex="-1"></a>get.gramm<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(X) {</span>
<span id="cb397-15"><a href="rkhs.html#cb397-15" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">1</span>]</span>
<span id="cb397-16"><a href="rkhs.html#cb397-16" aria-hidden="true" tabindex="-1"></a>  Gramm <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n) <span class="co">#initializes Gramm array</span></span>
<span id="cb397-17"><a href="rkhs.html#cb397-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#i=index for rows</span></span>
<span id="cb397-18"><a href="rkhs.html#cb397-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#j=index for columns</span></span>
<span id="cb397-19"><a href="rkhs.html#cb397-19" aria-hidden="true" tabindex="-1"></a>  Gramm <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(Gramm) <span class="co"># Gramm matrix</span></span>
<span id="cb397-20"><a href="rkhs.html#cb397-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb397-21"><a href="rkhs.html#cb397-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb397-22"><a href="rkhs.html#cb397-22" aria-hidden="true" tabindex="-1"></a>      Gramm[i, j] <span class="ot">&lt;-</span> <span class="fu">rk.1</span>(X[i, ], X[j, ])</span>
<span id="cb397-23"><a href="rkhs.html#cb397-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb397-24"><a href="rkhs.html#cb397-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb397-25"><a href="rkhs.html#cb397-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Gramm)</span>
<span id="cb397-26"><a href="rkhs.html#cb397-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb397-27"><a href="rkhs.html#cb397-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-28"><a href="rkhs.html#cb397-28" aria-hidden="true" tabindex="-1"></a>smoothing.spline <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, lambda) {</span>
<span id="cb397-29"><a href="rkhs.html#cb397-29" aria-hidden="true" tabindex="-1"></a>  Gramm <span class="ot">&lt;-</span> <span class="fu">get.gramm.1</span>(X) <span class="co">#Gramm matrix (nxn)</span></span>
<span id="cb397-30"><a href="rkhs.html#cb397-30" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">dim</span>(X)[<span class="dv">1</span>] <span class="co"># n=length of y</span></span>
<span id="cb397-31"><a href="rkhs.html#cb397-31" aria-hidden="true" tabindex="-1"></a>  J <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span>, n, <span class="dv">1</span>) <span class="co"># vector of ones dim</span></span>
<span id="cb397-32"><a href="rkhs.html#cb397-32" aria-hidden="true" tabindex="-1"></a>  T <span class="ot">&lt;-</span> <span class="fu">cbind</span>(J, X) <span class="co"># matrix with a basis for the null space of the penalty</span></span>
<span id="cb397-33"><a href="rkhs.html#cb397-33" aria-hidden="true" tabindex="-1"></a>  Q <span class="ot">&lt;-</span> <span class="fu">cbind</span>(T, Gramm) <span class="co"># design matrix</span></span>
<span id="cb397-34"><a href="rkhs.html#cb397-34" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">dim</span>(T)[<span class="dv">2</span>] <span class="co"># dimension of the null space of the penalty</span></span>
<span id="cb397-35"><a href="rkhs.html#cb397-35" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n <span class="sc">+</span> m, n <span class="sc">+</span> m) <span class="co">#initialize S</span></span>
<span id="cb397-36"><a href="rkhs.html#cb397-36" aria-hidden="true" tabindex="-1"></a>  S[(m <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m), (m <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">+</span> m)] <span class="ot">&lt;-</span> Gramm <span class="co">#non-zero part of S</span></span>
<span id="cb397-37"><a href="rkhs.html#cb397-37" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> (<span class="fu">t</span>(Q) <span class="sc">%*%</span> Q <span class="sc">+</span> lambda <span class="sc">*</span> S)</span>
<span id="cb397-38"><a href="rkhs.html#cb397-38" aria-hidden="true" tabindex="-1"></a>  M.inv <span class="ot">&lt;-</span> <span class="fu">my.inv</span>(M) <span class="co"># inverse of M</span></span>
<span id="cb397-39"><a href="rkhs.html#cb397-39" aria-hidden="true" tabindex="-1"></a>  gamma.hat <span class="ot">&lt;-</span> <span class="fu">crossprod</span>(M.inv, <span class="fu">crossprod</span>(Q, y))</span>
<span id="cb397-40"><a href="rkhs.html#cb397-40" aria-hidden="true" tabindex="-1"></a>  f.hat <span class="ot">&lt;-</span> Q <span class="sc">%*%</span> gamma.hat</span>
<span id="cb397-41"><a href="rkhs.html#cb397-41" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> Q <span class="sc">%*%</span> M.inv <span class="sc">%*%</span> <span class="fu">t</span>(Q)</span>
<span id="cb397-42"><a href="rkhs.html#cb397-42" aria-hidden="true" tabindex="-1"></a>  tr.A <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(A)) <span class="co">#trace of hat matrix</span></span>
<span id="cb397-43"><a href="rkhs.html#cb397-43" aria-hidden="true" tabindex="-1"></a>  rss <span class="ot">&lt;-</span> <span class="fu">t</span>(y <span class="sc">-</span> f.hat) <span class="sc">%*%</span> (y <span class="sc">-</span> f.hat) <span class="co">#residual sum of squares</span></span>
<span id="cb397-44"><a href="rkhs.html#cb397-44" aria-hidden="true" tabindex="-1"></a>  gcv <span class="ot">&lt;-</span> n <span class="sc">*</span> rss <span class="sc">/</span> (n <span class="sc">-</span> tr.A) <span class="sc">^</span> <span class="dv">2</span> <span class="co">#obtain GCV score</span></span>
<span id="cb397-45"><a href="rkhs.html#cb397-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb397-46"><a href="rkhs.html#cb397-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">f.hat =</span> f.hat,</span>
<span id="cb397-47"><a href="rkhs.html#cb397-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma.hat =</span> gamma.hat,</span>
<span id="cb397-48"><a href="rkhs.html#cb397-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">gcv =</span> gcv</span>
<span id="cb397-49"><a href="rkhs.html#cb397-49" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb397-50"><a href="rkhs.html#cb397-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb397-51"><a href="rkhs.html#cb397-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-52"><a href="rkhs.html#cb397-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-53"><a href="rkhs.html#cb397-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-54"><a href="rkhs.html#cb397-54" aria-hidden="true" tabindex="-1"></a><span class="do">### Now we have to find an optimal lambda using GCV...</span></span>
<span id="cb397-55"><a href="rkhs.html#cb397-55" aria-hidden="true" tabindex="-1"></a><span class="do">### Plot of GCV</span></span>
<span id="cb397-56"><a href="rkhs.html#cb397-56" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fl">1e-8</span> V <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">60</span>) <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>) {</span>
<span id="cb397-57"><a href="rkhs.html#cb397-57" aria-hidden="true" tabindex="-1"></a>  V[i] <span class="ot">&lt;-</span> <span class="fu">smoothing.spline</span>(x.star, y, lambda)<span class="sc">$</span>gcv <span class="co">#obtain GCV score</span></span>
<span id="cb397-58"><a href="rkhs.html#cb397-58" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda <span class="sc">*</span> <span class="fl">1.5</span> <span class="co">#increase lambda</span></span>
<span id="cb397-59"><a href="rkhs.html#cb397-59" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb397-60"><a href="rkhs.html#cb397-60" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>,</span>
<span id="cb397-61"><a href="rkhs.html#cb397-61" aria-hidden="true" tabindex="-1"></a>     V,</span>
<span id="cb397-62"><a href="rkhs.html#cb397-62" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb397-63"><a href="rkhs.html#cb397-63" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;GCV score&quot;</span>,</span>
<span id="cb397-64"><a href="rkhs.html#cb397-64" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;i&quot;</span>) <span class="co"># plot score</span></span>
<span id="cb397-65"><a href="rkhs.html#cb397-65" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">60</span>)[V <span class="sc">==</span> <span class="fu">min</span>(V)] <span class="co"># extract index of min(V)</span></span>
<span id="cb397-66"><a href="rkhs.html#cb397-66" aria-hidden="true" tabindex="-1"></a>fit_rk <span class="ot">&lt;-</span> <span class="fu">smoothing.spline</span>(x.star, y, <span class="fl">1.5</span> <span class="sc">^</span> (i <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fl">1e-8</span>) <span class="co">#fit optimal</span></span>
<span id="cb397-67"><a href="rkhs.html#cb397-67" aria-hidden="true" tabindex="-1"></a>model</span>
<span id="cb397-68"><a href="rkhs.html#cb397-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-69"><a href="rkhs.html#cb397-69" aria-hidden="true" tabindex="-1"></a><span class="co">#Graph (Cubic Spline)</span></span>
<span id="cb397-70"><a href="rkhs.html#cb397-70" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb397-71"><a href="rkhs.html#cb397-71" aria-hidden="true" tabindex="-1"></a>  x.star,</span>
<span id="cb397-72"><a href="rkhs.html#cb397-72" aria-hidden="true" tabindex="-1"></a>  fit_rk<span class="sc">$</span>f.hat,</span>
<span id="cb397-73"><a href="rkhs.html#cb397-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb397-74"><a href="rkhs.html#cb397-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="dv">2</span>,</span>
<span id="cb397-75"><a href="rkhs.html#cb397-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb397-76"><a href="rkhs.html#cb397-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb397-77"><a href="rkhs.html#cb397-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb397-78"><a href="rkhs.html#cb397-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">1.5</span>),</span>
<span id="cb397-79"><a href="rkhs.html#cb397-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="fl">1.1</span>),</span>
<span id="cb397-80"><a href="rkhs.html#cb397-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;response&quot;</span>,</span>
<span id="cb397-81"><a href="rkhs.html#cb397-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Cubic Spline&quot;</span></span>
<span id="cb397-82"><a href="rkhs.html#cb397-82" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb397-83"><a href="rkhs.html#cb397-83" aria-hidden="true" tabindex="-1"></a><span class="co">#predictions</span></span>
<span id="cb397-84"><a href="rkhs.html#cb397-84" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x.star, <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> x.star), <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>) <span class="co">#true</span></span>
<span id="cb397-85"><a href="rkhs.html#cb397-85" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(</span>
<span id="cb397-86"><a href="rkhs.html#cb397-86" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">0.1</span>,</span>
<span id="cb397-87"><a href="rkhs.html#cb397-87" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fl">1.5</span>,</span>
<span id="cb397-88"><a href="rkhs.html#cb397-88" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;predictions&quot;</span>, <span class="st">&quot;true&quot;</span>),</span>
<span id="cb397-89"><a href="rkhs.html#cb397-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb397-90"><a href="rkhs.html#cb397-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb397-91"><a href="rkhs.html#cb397-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb397-92"><a href="rkhs.html#cb397-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;black&quot;</span>)</span>
<span id="cb397-93"><a href="rkhs.html#cb397-93" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb397-94"><a href="rkhs.html#cb397-94" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x.star, y)</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="elm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cfa.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/rkhs.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
