<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Hamiltonian Monte Carlo | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Hamiltonian Monte Carlo | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Hamiltonian Monte Carlo | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="metropolis-hastings.html"/>
<link rel="next" href="supplemental.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#one-factor-mixed-model"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#two-factor-mixed-model"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#mixed-model-via-ml"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial Regression</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal Regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#python-2"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gaussian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html"><i class="fa fa-check"></i>Neural Network</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-3"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-4"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-3"><i class="fa fa-check"></i>Example 3</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-5"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-2"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-22"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-27"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#introduction-2"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l1-lasso-regularization"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l2-ridge-regularization"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-9"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-42"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder-Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-45"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-24"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-51"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-32"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-55"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#sgd-variants"><i class="fa fa-check"></i>SGD Variants</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-33"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-56"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-2"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-52"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-11"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-57"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-53"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-52"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-58"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-52"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hamiltonian-monte-carlo" class="section level1">
<h1>Hamiltonian Monte Carlo</h1>
<p>The following demonstrates Hamiltonian Monte Carlo, the technique that Stan
uses, and which is a different estimation approach than the Gibbs sampler in
BUGS/JAGS. If you are interested in the details enough to be reading this, I
highly recommend Betancourt’s <a href="https://arxiv.org/pdf/1701.02434.pdf">conceptual introduction to
HMC</a>. This example is largely based on
the code in the appendix of Gelman.</p>
<ul>
<li>Gelman et al. 2013. Bayesian Data Analysis. 3rd ed.</li>
</ul>
<div id="data-setup-53" class="section level2">
<h2>Data Setup</h2>
<p>As with the <a href="metropolis-hastings.html#metropolis-hastings">Metropolis Hastings chapter</a>, we use some data for a standard linear regression.</p>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="hamiltonian-monte-carlo.html#cb842-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb842-2"><a href="hamiltonian-monte-carlo.html#cb842-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-3"><a href="hamiltonian-monte-carlo.html#cb842-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed for replicability</span></span>
<span id="cb842-4"><a href="hamiltonian-monte-carlo.html#cb842-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8675309</span>)</span>
<span id="cb842-5"><a href="hamiltonian-monte-carlo.html#cb842-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-6"><a href="hamiltonian-monte-carlo.html#cb842-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create a N x k matrix of covariates</span></span>
<span id="cb842-7"><a href="hamiltonian-monte-carlo.html#cb842-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">250</span></span>
<span id="cb842-8"><a href="hamiltonian-monte-carlo.html#cb842-8" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb842-9"><a href="hamiltonian-monte-carlo.html#cb842-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-10"><a href="hamiltonian-monte-carlo.html#cb842-10" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">=</span> <span class="fu">replicate</span>(K, <span class="fu">rnorm</span>(<span class="at">n =</span> N))</span>
<span id="cb842-11"><a href="hamiltonian-monte-carlo.html#cb842-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(covariates) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;X1&#39;</span>, <span class="st">&#39;X2&#39;</span>, <span class="st">&#39;X3&#39;</span>)</span>
<span id="cb842-12"><a href="hamiltonian-monte-carlo.html#cb842-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-13"><a href="hamiltonian-monte-carlo.html#cb842-13" aria-hidden="true" tabindex="-1"></a><span class="co"># create the model matrix with intercept</span></span>
<span id="cb842-14"><a href="hamiltonian-monte-carlo.html#cb842-14" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">Intercept =</span> <span class="dv">1</span>, covariates)</span>
<span id="cb842-15"><a href="hamiltonian-monte-carlo.html#cb842-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-16"><a href="hamiltonian-monte-carlo.html#cb842-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create a normally distributed variable that is a function of the covariates</span></span>
<span id="cb842-17"><a href="hamiltonian-monte-carlo.html#cb842-17" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>, .<span class="dv">2</span>, <span class="sc">-</span><span class="fl">1.5</span>, .<span class="dv">9</span>)</span>
<span id="cb842-18"><a href="hamiltonian-monte-carlo.html#cb842-18" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb842-19"><a href="hamiltonian-monte-carlo.html#cb842-19" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> X <span class="sc">%*%</span> coefs</span>
<span id="cb842-20"><a href="hamiltonian-monte-carlo.html#cb842-20" aria-hidden="true" tabindex="-1"></a>y  <span class="ot">=</span> <span class="fu">rnorm</span>(N, mu, sigma)</span>
<span id="cb842-21"><a href="hamiltonian-monte-carlo.html#cb842-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-22"><a href="hamiltonian-monte-carlo.html#cb842-22" aria-hidden="true" tabindex="-1"></a><span class="co"># same as</span></span>
<span id="cb842-23"><a href="hamiltonian-monte-carlo.html#cb842-23" aria-hidden="true" tabindex="-1"></a><span class="co"># y = 5 + .2*X1 - 1.5*X2 + .9*X3 + rnorm(N, mean = 0, sd = 2)</span></span>
<span id="cb842-24"><a href="hamiltonian-monte-carlo.html#cb842-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb842-25"><a href="hamiltonian-monte-carlo.html#cb842-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Run lm for later comparison; but go ahead and examine now if desired</span></span>
<span id="cb842-26"><a href="hamiltonian-monte-carlo.html#cb842-26" aria-hidden="true" tabindex="-1"></a>fit_lm <span class="ot">=</span> <span class="fu">lm</span>(y <span class="sc">~</span> ., <span class="at">data =</span> <span class="fu">data.frame</span>(X[, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb842-27"><a href="hamiltonian-monte-carlo.html#cb842-27" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit_lm)</span></span></code></pre></div>
</div>
<div id="functions-12" class="section level2">
<h2>Functions</h2>
<p>First we start with the log posterior function.</p>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="hamiltonian-monte-carlo.html#cb843-1" aria-hidden="true" tabindex="-1"></a>log_posterior <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, th) {</span>
<span id="cb843-2"><a href="hamiltonian-monte-carlo.html#cb843-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args</span></span>
<span id="cb843-3"><a href="hamiltonian-monte-carlo.html#cb843-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X: the model matrix</span></span>
<span id="cb843-4"><a href="hamiltonian-monte-carlo.html#cb843-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y: the target vector</span></span>
<span id="cb843-5"><a href="hamiltonian-monte-carlo.html#cb843-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># th: theta, the current parameter estimates</span></span>
<span id="cb843-6"><a href="hamiltonian-monte-carlo.html#cb843-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb843-7"><a href="hamiltonian-monte-carlo.html#cb843-7" aria-hidden="true" tabindex="-1"></a>  beta   <span class="ot">=</span> th[<span class="sc">-</span><span class="fu">length</span>(th)]            <span class="co"># reg coefs to be estimated</span></span>
<span id="cb843-8"><a href="hamiltonian-monte-carlo.html#cb843-8" aria-hidden="true" tabindex="-1"></a>  sigma  <span class="ot">=</span> th[<span class="fu">length</span>(th)]             <span class="co"># sigma to be estimated</span></span>
<span id="cb843-9"><a href="hamiltonian-monte-carlo.html#cb843-9" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="ot">=</span> sigma<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb843-10"><a href="hamiltonian-monte-carlo.html#cb843-10" aria-hidden="true" tabindex="-1"></a>  mu <span class="ot">=</span> X <span class="sc">%*%</span> beta</span>
<span id="cb843-11"><a href="hamiltonian-monte-carlo.html#cb843-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb843-12"><a href="hamiltonian-monte-carlo.html#cb843-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># priors are b0 ~ N(0, sd=10), sigma2 ~ invGamma(.001, .001)</span></span>
<span id="cb843-13"><a href="hamiltonian-monte-carlo.html#cb843-13" aria-hidden="true" tabindex="-1"></a>  priorbvarinv <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">100</span>, <span class="dv">4</span>) </span>
<span id="cb843-14"><a href="hamiltonian-monte-carlo.html#cb843-14" aria-hidden="true" tabindex="-1"></a>  prioralpha   <span class="ot">=</span> priorbeta <span class="ot">=</span> .<span class="dv">001</span></span>
<span id="cb843-15"><a href="hamiltonian-monte-carlo.html#cb843-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb843-16"><a href="hamiltonian-monte-carlo.html#cb843-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.nan</span>(sigma) <span class="sc">|</span> sigma<span class="sc">&lt;=</span><span class="dv">0</span>) {     <span class="co"># scale parameter must be positive, so post</span></span>
<span id="cb843-17"><a href="hamiltonian-monte-carlo.html#cb843-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="sc">-</span><span class="cn">Inf</span>)                      <span class="co"># density is zero if it jumps below zero</span></span>
<span id="cb843-18"><a href="hamiltonian-monte-carlo.html#cb843-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb843-19"><a href="hamiltonian-monte-carlo.html#cb843-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># log posterior in this conjugate setting. conceptually it&#39;s (log) prior +</span></span>
<span id="cb843-20"><a href="hamiltonian-monte-carlo.html#cb843-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (log) likelihood. (See commented &#39;else&#39; for alternative)</span></span>
<span id="cb843-21"><a href="hamiltonian-monte-carlo.html#cb843-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb843-22"><a href="hamiltonian-monte-carlo.html#cb843-22" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>.<span class="dv">5</span><span class="sc">*</span><span class="fu">nrow</span>(X)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">-</span> (.<span class="dv">5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">*</span> (<span class="fu">crossprod</span>(y<span class="sc">-</span>mu))) <span class="sc">+</span></span>
<span id="cb843-23"><a href="hamiltonian-monte-carlo.html#cb843-23" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>.<span class="dv">5</span><span class="sc">*</span><span class="fu">ncol</span>(X)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">-</span> (.<span class="dv">5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">*</span> (<span class="fu">t</span>(beta) <span class="sc">%*%</span> priorbvarinv <span class="sc">%*%</span> beta)) <span class="sc">+</span></span>
<span id="cb843-24"><a href="hamiltonian-monte-carlo.html#cb843-24" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>(prioralpha <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">*</span><span class="fu">log</span>(sigma2) <span class="sc">+</span> <span class="fu">log</span>(sigma2) <span class="sc">-</span> priorbeta<span class="sc">/</span>sigma2</span>
<span id="cb843-25"><a href="hamiltonian-monte-carlo.html#cb843-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb843-26"><a href="hamiltonian-monte-carlo.html#cb843-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># else {</span></span>
<span id="cb843-27"><a href="hamiltonian-monte-carlo.html#cb843-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ll = mvtnorm::dmvnorm(y, mean=mu, sigma=diag(sigma2, length(y)), log=T)</span></span>
<span id="cb843-28"><a href="hamiltonian-monte-carlo.html#cb843-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   priorb = mvtnorm::dmvnorm(beta, mean=rep(0, length(beta)), sigma=diag(100, length(beta)), log=T)</span></span>
<span id="cb843-29"><a href="hamiltonian-monte-carlo.html#cb843-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   priors2 = dgamma(1/sigma2, prioralpha, priorbeta, log=T)</span></span>
<span id="cb843-30"><a href="hamiltonian-monte-carlo.html#cb843-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   logposterior = ll + priorb + priors2</span></span>
<span id="cb843-31"><a href="hamiltonian-monte-carlo.html#cb843-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   logposterior</span></span>
<span id="cb843-32"><a href="hamiltonian-monte-carlo.html#cb843-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb843-33"><a href="hamiltonian-monte-carlo.html#cb843-33" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The following is the numerical gradient function as given in BDA3 p. 602. It has
the same arguments as the log posterior function.</p>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="hamiltonian-monte-carlo.html#cb844-1" aria-hidden="true" tabindex="-1"></a>gradient_theta <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, th) {</span>
<span id="cb844-2"><a href="hamiltonian-monte-carlo.html#cb844-2" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> <span class="fu">length</span>(th)</span>
<span id="cb844-3"><a href="hamiltonian-monte-carlo.html#cb844-3" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">=</span> .<span class="dv">0001</span></span>
<span id="cb844-4"><a href="hamiltonian-monte-carlo.html#cb844-4" aria-hidden="true" tabindex="-1"></a>  diffs <span class="ot">=</span> <span class="fu">numeric</span>(d)</span>
<span id="cb844-5"><a href="hamiltonian-monte-carlo.html#cb844-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb844-6"><a href="hamiltonian-monte-carlo.html#cb844-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d) {</span>
<span id="cb844-7"><a href="hamiltonian-monte-carlo.html#cb844-7" aria-hidden="true" tabindex="-1"></a>    th_hi <span class="ot">=</span> th</span>
<span id="cb844-8"><a href="hamiltonian-monte-carlo.html#cb844-8" aria-hidden="true" tabindex="-1"></a>    th_lo <span class="ot">=</span> th</span>
<span id="cb844-9"><a href="hamiltonian-monte-carlo.html#cb844-9" aria-hidden="true" tabindex="-1"></a>    th_hi[k] <span class="ot">=</span> th[k] <span class="sc">+</span> e</span>
<span id="cb844-10"><a href="hamiltonian-monte-carlo.html#cb844-10" aria-hidden="true" tabindex="-1"></a>    th_lo[k] <span class="ot">=</span> th[k] <span class="sc">-</span> e</span>
<span id="cb844-11"><a href="hamiltonian-monte-carlo.html#cb844-11" aria-hidden="true" tabindex="-1"></a>    diffs[k] <span class="ot">=</span> (<span class="fu">log_posterior</span>(X, y, th_hi) <span class="sc">-</span> <span class="fu">log_posterior</span>(X, y, th_lo)) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> e)</span>
<span id="cb844-12"><a href="hamiltonian-monte-carlo.html#cb844-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb844-13"><a href="hamiltonian-monte-carlo.html#cb844-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb844-14"><a href="hamiltonian-monte-carlo.html#cb844-14" aria-hidden="true" tabindex="-1"></a>  diffs</span>
<span id="cb844-15"><a href="hamiltonian-monte-carlo.html#cb844-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The following is a function for a single HMC iteration. ϵ and L are drawn randomly at each
iteration to explore other areas of the posterior (starting with <code>epsilon0</code> and
<code>L0</code>); The mass matrix <code>M</code>, expressed as a vector, is a bit of a magic number in
this setting. It regards the mass of a particle whose position is represented by
<span class="math inline">\(\theta\)</span>, and momentum by <span class="math inline">\(\phi\)</span>. See the <a href="https://mc-stan.org/docs/2_18/reference-manual/hamiltonian-monte-carlo.html">sampling section of the Stan
manual</a>
for more detail.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="hamiltonian-monte-carlo.html#cb845-1" aria-hidden="true" tabindex="-1"></a>hmc_iteration <span class="ot">&lt;-</span> <span class="cf">function</span>(X, y, th, epsilon, L, M) {</span>
<span id="cb845-2"><a href="hamiltonian-monte-carlo.html#cb845-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args</span></span>
<span id="cb845-3"><a href="hamiltonian-monte-carlo.html#cb845-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># epsilon: the stepsize</span></span>
<span id="cb845-4"><a href="hamiltonian-monte-carlo.html#cb845-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># L: the number of leapfrog steps</span></span>
<span id="cb845-5"><a href="hamiltonian-monte-carlo.html#cb845-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M: a diagonal mass matrix</span></span>
<span id="cb845-6"><a href="hamiltonian-monte-carlo.html#cb845-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb845-7"><a href="hamiltonian-monte-carlo.html#cb845-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initialization</span></span>
<span id="cb845-8"><a href="hamiltonian-monte-carlo.html#cb845-8" aria-hidden="true" tabindex="-1"></a>  M_inv <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>M</span>
<span id="cb845-9"><a href="hamiltonian-monte-carlo.html#cb845-9" aria-hidden="true" tabindex="-1"></a>  d   <span class="ot">=</span> <span class="fu">length</span>(th)</span>
<span id="cb845-10"><a href="hamiltonian-monte-carlo.html#cb845-10" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">=</span> <span class="fu">rnorm</span>(d, <span class="dv">0</span>, <span class="fu">sqrt</span>(M))</span>
<span id="cb845-11"><a href="hamiltonian-monte-carlo.html#cb845-11" aria-hidden="true" tabindex="-1"></a>  th_old <span class="ot">=</span> th</span>
<span id="cb845-12"><a href="hamiltonian-monte-carlo.html#cb845-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb845-13"><a href="hamiltonian-monte-carlo.html#cb845-13" aria-hidden="true" tabindex="-1"></a>  log_p_old <span class="ot">=</span> <span class="fu">log_posterior</span>(X, y, th) <span class="sc">-</span> .<span class="dv">5</span><span class="sc">*</span><span class="fu">sum</span>(M_inv <span class="sc">*</span> phi<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb845-14"><a href="hamiltonian-monte-carlo.html#cb845-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb845-15"><a href="hamiltonian-monte-carlo.html#cb845-15" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">=</span> phi <span class="sc">+</span> .<span class="dv">5</span> <span class="sc">*</span> epsilon <span class="sc">*</span> <span class="fu">gradient_theta</span>(X, y, th)</span>
<span id="cb845-16"><a href="hamiltonian-monte-carlo.html#cb845-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb845-17"><a href="hamiltonian-monte-carlo.html#cb845-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>L) {</span>
<span id="cb845-18"><a href="hamiltonian-monte-carlo.html#cb845-18" aria-hidden="true" tabindex="-1"></a>    th  <span class="ot">=</span> th <span class="sc">+</span> epsilon<span class="sc">*</span>M_inv<span class="sc">*</span>phi</span>
<span id="cb845-19"><a href="hamiltonian-monte-carlo.html#cb845-19" aria-hidden="true" tabindex="-1"></a>    phi <span class="ot">=</span> phi <span class="sc">+</span> <span class="fu">ifelse</span>(l <span class="sc">==</span> L, .<span class="dv">5</span>, <span class="dv">1</span>) <span class="sc">*</span> epsilon <span class="sc">*</span> <span class="fu">gradient_theta</span>(X, y, th)</span>
<span id="cb845-20"><a href="hamiltonian-monte-carlo.html#cb845-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb845-21"><a href="hamiltonian-monte-carlo.html#cb845-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb845-22"><a href="hamiltonian-monte-carlo.html#cb845-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># here we get into standard MCMC stuff, jump or not based on a draw from a</span></span>
<span id="cb845-23"><a href="hamiltonian-monte-carlo.html#cb845-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># proposal distribution</span></span>
<span id="cb845-24"><a href="hamiltonian-monte-carlo.html#cb845-24" aria-hidden="true" tabindex="-1"></a>  phi <span class="ot">=</span> <span class="sc">-</span>phi</span>
<span id="cb845-25"><a href="hamiltonian-monte-carlo.html#cb845-25" aria-hidden="true" tabindex="-1"></a>  log_p_star <span class="ot">=</span> <span class="fu">log_posterior</span>(X, y, th) <span class="sc">-</span> .<span class="dv">5</span><span class="sc">*</span><span class="fu">sum</span>(M_inv <span class="sc">*</span> phi<span class="sc">^</span><span class="dv">2</span>)    </span>
<span id="cb845-26"><a href="hamiltonian-monte-carlo.html#cb845-26" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">=</span> <span class="fu">exp</span>(log_p_star <span class="sc">-</span> log_p_old)</span>
<span id="cb845-27"><a href="hamiltonian-monte-carlo.html#cb845-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb845-28"><a href="hamiltonian-monte-carlo.html#cb845-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.nan</span>(r)) r <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb845-29"><a href="hamiltonian-monte-carlo.html#cb845-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb845-30"><a href="hamiltonian-monte-carlo.html#cb845-30" aria-hidden="true" tabindex="-1"></a>  p_jump <span class="ot">=</span> <span class="fu">min</span>(r, <span class="dv">1</span>)</span>
<span id="cb845-31"><a href="hamiltonian-monte-carlo.html#cb845-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb845-32"><a href="hamiltonian-monte-carlo.html#cb845-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> p_jump) {</span>
<span id="cb845-33"><a href="hamiltonian-monte-carlo.html#cb845-33" aria-hidden="true" tabindex="-1"></a>    th_new <span class="ot">=</span> th</span>
<span id="cb845-34"><a href="hamiltonian-monte-carlo.html#cb845-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb845-35"><a href="hamiltonian-monte-carlo.html#cb845-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb845-36"><a href="hamiltonian-monte-carlo.html#cb845-36" aria-hidden="true" tabindex="-1"></a>    th_new <span class="ot">=</span> th_old</span>
<span id="cb845-37"><a href="hamiltonian-monte-carlo.html#cb845-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb845-38"><a href="hamiltonian-monte-carlo.html#cb845-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb845-39"><a href="hamiltonian-monte-carlo.html#cb845-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># returns estimates and acceptance rate</span></span>
<span id="cb845-40"><a href="hamiltonian-monte-carlo.html#cb845-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">th =</span> th_new, <span class="at">p_jump =</span> p_jump)  </span>
<span id="cb845-41"><a href="hamiltonian-monte-carlo.html#cb845-41" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Main HMC function.</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="hamiltonian-monte-carlo.html#cb846-1" aria-hidden="true" tabindex="-1"></a>hmc_run <span class="ot">&lt;-</span> <span class="cf">function</span>(starts, iter, warmup, epsilon_0, L_0, M, X, y) {</span>
<span id="cb846-2"><a href="hamiltonian-monte-carlo.html#cb846-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # Args: </span></span>
<span id="cb846-3"><a href="hamiltonian-monte-carlo.html#cb846-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># starts:  starting values</span></span>
<span id="cb846-4"><a href="hamiltonian-monte-carlo.html#cb846-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># iter: total number of simulations for each chain (note chain is based on the dimension of starts)</span></span>
<span id="cb846-5"><a href="hamiltonian-monte-carlo.html#cb846-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># warmup: determines which of the initial iterations will be ignored for inference purposes</span></span>
<span id="cb846-6"><a href="hamiltonian-monte-carlo.html#cb846-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># epsilon0: the baseline stepsize</span></span>
<span id="cb846-7"><a href="hamiltonian-monte-carlo.html#cb846-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># L0: the baseline number of leapfrog steps</span></span>
<span id="cb846-8"><a href="hamiltonian-monte-carlo.html#cb846-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># M: is the mass vector</span></span>
<span id="cb846-9"><a href="hamiltonian-monte-carlo.html#cb846-9" aria-hidden="true" tabindex="-1"></a>  chains <span class="ot">=</span> <span class="fu">nrow</span>(starts)</span>
<span id="cb846-10"><a href="hamiltonian-monte-carlo.html#cb846-10" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> <span class="fu">ncol</span>(starts)</span>
<span id="cb846-11"><a href="hamiltonian-monte-carlo.html#cb846-11" aria-hidden="true" tabindex="-1"></a>  sims <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, </span>
<span id="cb846-12"><a href="hamiltonian-monte-carlo.html#cb846-12" aria-hidden="true" tabindex="-1"></a>               <span class="fu">c</span>(iter, chains, d), </span>
<span id="cb846-13"><a href="hamiltonian-monte-carlo.html#cb846-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="cn">NULL</span>, <span class="fu">colnames</span>(starts)))</span>
<span id="cb846-14"><a href="hamiltonian-monte-carlo.html#cb846-14" aria-hidden="true" tabindex="-1"></a>  p_jump <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, iter, chains)</span>
<span id="cb846-15"><a href="hamiltonian-monte-carlo.html#cb846-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb846-16"><a href="hamiltonian-monte-carlo.html#cb846-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>chains) {</span>
<span id="cb846-17"><a href="hamiltonian-monte-carlo.html#cb846-17" aria-hidden="true" tabindex="-1"></a>    th <span class="ot">=</span> starts[j,]</span>
<span id="cb846-18"><a href="hamiltonian-monte-carlo.html#cb846-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb846-19"><a href="hamiltonian-monte-carlo.html#cb846-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>iter) {</span>
<span id="cb846-20"><a href="hamiltonian-monte-carlo.html#cb846-20" aria-hidden="true" tabindex="-1"></a>      epsilon <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>epsilon_0)</span>
<span id="cb846-21"><a href="hamiltonian-monte-carlo.html#cb846-21" aria-hidden="true" tabindex="-1"></a>      L    <span class="ot">=</span> <span class="fu">ceiling</span>(<span class="dv">2</span><span class="sc">*</span>L_0<span class="sc">*</span><span class="fu">runif</span>(<span class="dv">1</span>))</span>
<span id="cb846-22"><a href="hamiltonian-monte-carlo.html#cb846-22" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb846-23"><a href="hamiltonian-monte-carlo.html#cb846-23" aria-hidden="true" tabindex="-1"></a>      temp <span class="ot">=</span> <span class="fu">hmc_iteration</span>(X, y, th, epsilon, L, M)</span>
<span id="cb846-24"><a href="hamiltonian-monte-carlo.html#cb846-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb846-25"><a href="hamiltonian-monte-carlo.html#cb846-25" aria-hidden="true" tabindex="-1"></a>      p_jump[t,j] <span class="ot">=</span> temp<span class="sc">$</span>p_jump</span>
<span id="cb846-26"><a href="hamiltonian-monte-carlo.html#cb846-26" aria-hidden="true" tabindex="-1"></a>      sims[t,j,]  <span class="ot">=</span> temp<span class="sc">$</span>th</span>
<span id="cb846-27"><a href="hamiltonian-monte-carlo.html#cb846-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb846-28"><a href="hamiltonian-monte-carlo.html#cb846-28" aria-hidden="true" tabindex="-1"></a>      th <span class="ot">=</span> temp<span class="sc">$</span>th</span>
<span id="cb846-29"><a href="hamiltonian-monte-carlo.html#cb846-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb846-30"><a href="hamiltonian-monte-carlo.html#cb846-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb846-31"><a href="hamiltonian-monte-carlo.html#cb846-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb846-32"><a href="hamiltonian-monte-carlo.html#cb846-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># acceptance rate</span></span>
<span id="cb846-33"><a href="hamiltonian-monte-carlo.html#cb846-33" aria-hidden="true" tabindex="-1"></a>  acc <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">colMeans</span>(p_jump[(warmup <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iter,]), <span class="dv">3</span>)  </span>
<span id="cb846-34"><a href="hamiltonian-monte-carlo.html#cb846-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb846-35"><a href="hamiltonian-monte-carlo.html#cb846-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">&#39;Avg acceptance probability for each chain: &#39;</span>, </span>
<span id="cb846-36"><a href="hamiltonian-monte-carlo.html#cb846-36" aria-hidden="true" tabindex="-1"></a>          <span class="fu">paste0</span>(acc[<span class="dv">1</span>],<span class="st">&#39;, &#39;</span>,acc[<span class="dv">2</span>]), <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>) </span>
<span id="cb846-37"><a href="hamiltonian-monte-carlo.html#cb846-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb846-38"><a href="hamiltonian-monte-carlo.html#cb846-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">sims =</span> sims, <span class="at">p_jump =</span> p_jump)</span>
<span id="cb846-39"><a href="hamiltonian-monte-carlo.html#cb846-39" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="estimation-52" class="section level2">
<h2>Estimation</h2>
<p>With the primary functions in place, we set the starting values and choose other settings for for the HMC process. The coefficient starting values are based on random draws from a uniform distribution, while <span class="math inline">\(\sigma\)</span> is set to a value of one in each case. As in the other examples we’ll have 5000 total draws with warm-up set to 2500. I don’t have any thinning option here, but that could be added or simply done as part of the <span class="pack">coda</span> package preparation.</p>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="hamiltonian-monte-carlo.html#cb847-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Starting values and mcmc settings</span></span>
<span id="cb847-2"><a href="hamiltonian-monte-carlo.html#cb847-2" aria-hidden="true" tabindex="-1"></a>parnames <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;beta[&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="st">&#39;]&#39;</span>), <span class="st">&#39;sigma&#39;</span>)</span>
<span id="cb847-3"><a href="hamiltonian-monte-carlo.html#cb847-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="fu">length</span>(parnames)</span>
<span id="cb847-4"><a href="hamiltonian-monte-carlo.html#cb847-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-5"><a href="hamiltonian-monte-carlo.html#cb847-5" aria-hidden="true" tabindex="-1"></a>chains <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb847-6"><a href="hamiltonian-monte-carlo.html#cb847-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-7"><a href="hamiltonian-monte-carlo.html#cb847-7" aria-hidden="true" tabindex="-1"></a>theta_start <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">replicate</span>(chains, <span class="fu">c</span>(<span class="fu">runif</span>(d<span class="dv">-1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dv">1</span>)))</span>
<span id="cb847-8"><a href="hamiltonian-monte-carlo.html#cb847-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(theta_start) <span class="ot">=</span> parnames</span>
<span id="cb847-9"><a href="hamiltonian-monte-carlo.html#cb847-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb847-10"><a href="hamiltonian-monte-carlo.html#cb847-10" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb847-11"><a href="hamiltonian-monte-carlo.html#cb847-11" aria-hidden="true" tabindex="-1"></a>wu   <span class="ot">=</span> <span class="dv">500</span></span></code></pre></div>
<p>We can fiddle with these sampling parameters to get a desirable acceptance rate of around .80. The following work well with the data we have.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="hamiltonian-monte-carlo.html#cb848-1" aria-hidden="true" tabindex="-1"></a>stepsize <span class="ot">=</span> .<span class="dv">08</span></span>
<span id="cb848-2"><a href="hamiltonian-monte-carlo.html#cb848-2" aria-hidden="true" tabindex="-1"></a>nLeap <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb848-3"><a href="hamiltonian-monte-carlo.html#cb848-3" aria-hidden="true" tabindex="-1"></a>vars  <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb848-4"><a href="hamiltonian-monte-carlo.html#cb848-4" aria-hidden="true" tabindex="-1"></a>mass_vector <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> vars</span></code></pre></div>
<p>We are now ready to run the model. On my machine and with the above settings, it took a couple seconds. Once complete we can use the <span class="pack">coda</span> package if desired as we have done before.</p>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="hamiltonian-monte-carlo.html#cb849-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the model</span></span>
<span id="cb849-2"><a href="hamiltonian-monte-carlo.html#cb849-2" aria-hidden="true" tabindex="-1"></a>fit_hmc <span class="ot">=</span> <span class="fu">hmc_run</span>(</span>
<span id="cb849-3"><a href="hamiltonian-monte-carlo.html#cb849-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">starts    =</span> theta_start,</span>
<span id="cb849-4"><a href="hamiltonian-monte-carlo.html#cb849-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter      =</span> nsim,</span>
<span id="cb849-5"><a href="hamiltonian-monte-carlo.html#cb849-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup    =</span> wu,</span>
<span id="cb849-6"><a href="hamiltonian-monte-carlo.html#cb849-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">epsilon_0 =</span> stepsize,</span>
<span id="cb849-7"><a href="hamiltonian-monte-carlo.html#cb849-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">L_0 =</span> nLeap,</span>
<span id="cb849-8"><a href="hamiltonian-monte-carlo.html#cb849-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">M   =</span> mass_vector,</span>
<span id="cb849-9"><a href="hamiltonian-monte-carlo.html#cb849-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">X   =</span> X,</span>
<span id="cb849-10"><a href="hamiltonian-monte-carlo.html#cb849-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y   =</span> y</span>
<span id="cb849-11"><a href="hamiltonian-monte-carlo.html#cb849-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb849-12"><a href="hamiltonian-monte-carlo.html#cb849-12" aria-hidden="true" tabindex="-1"></a><span class="co"># str(fit_hmc, 1)</span></span></code></pre></div>
<p>Using <span class="pack" style="">coda</span>, we can get some nice summary information. Results not shown.</p>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="hamiltonian-monte-carlo.html#cb850-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb850-2"><a href="hamiltonian-monte-carlo.html#cb850-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb850-3"><a href="hamiltonian-monte-carlo.html#cb850-3" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">=</span> <span class="fu">as.mcmc.list</span>(<span class="fu">list</span>(<span class="fu">as.mcmc</span>(fit_hmc<span class="sc">$</span>sims[(wu<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>nsim, <span class="dv">1</span>,]), </span>
<span id="cb850-4"><a href="hamiltonian-monte-carlo.html#cb850-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">as.mcmc</span>(fit_hmc<span class="sc">$</span>sims[(wu<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>nsim, <span class="dv">2</span>,])))</span>
<span id="cb850-5"><a href="hamiltonian-monte-carlo.html#cb850-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb850-6"><a href="hamiltonian-monte-carlo.html#cb850-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(theta)</span></span>
<span id="cb850-7"><a href="hamiltonian-monte-carlo.html#cb850-7" aria-hidden="true" tabindex="-1"></a>fit_summary <span class="ot">=</span>  <span class="fu">summary</span>(theta)<span class="sc">$</span>statistics[,<span class="st">&#39;Mean&#39;</span>]</span>
<span id="cb850-8"><a href="hamiltonian-monte-carlo.html#cb850-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb850-9"><a href="hamiltonian-monte-carlo.html#cb850-9" aria-hidden="true" tabindex="-1"></a>beta_est  <span class="ot">=</span> fit_summary[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb850-10"><a href="hamiltonian-monte-carlo.html#cb850-10" aria-hidden="true" tabindex="-1"></a>sigma_est <span class="ot">=</span> fit_summary[<span class="dv">5</span>]</span>
<span id="cb850-11"><a href="hamiltonian-monte-carlo.html#cb850-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb850-12"><a href="hamiltonian-monte-carlo.html#cb850-12" aria-hidden="true" tabindex="-1"></a><span class="co"># log_posterior(X, y, fit_summary)</span></span></code></pre></div>
<p>Instead we can use <span class="pack" style="">rstan’s</span> <span class="func" style="">monitor</span> function on <code>fit_hmc$sims</code> to produce typical Stan output.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:hmc-est-show">Table 1: </span>log posterior = -301.716
</caption>
<thead>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
2.5%
</th>
<th style="text-align:right;">
97.5%
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
<th style="text-align:right;">
Bulk_ESS
</th>
<th style="text-align:right;">
Tail_ESS
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:right;">
4.898
</td>
<td style="text-align:right;">
0.128
</td>
<td style="text-align:right;">
4.645
</td>
<td style="text-align:right;">
5.139
</td>
<td style="text-align:right;">
505
</td>
<td style="text-align:right;">
1.006
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
305
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:right;">
0.077
</td>
<td style="text-align:right;">
0.133
</td>
<td style="text-align:right;">
-0.192
</td>
<td style="text-align:right;">
0.334
</td>
<td style="text-align:right;">
560
</td>
<td style="text-align:right;">
1.012
</td>
<td style="text-align:right;">
566
</td>
<td style="text-align:right;">
240
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[3]
</td>
<td style="text-align:right;">
-1.472
</td>
<td style="text-align:right;">
0.122
</td>
<td style="text-align:right;">
-1.710
</td>
<td style="text-align:right;">
-1.224
</td>
<td style="text-align:right;">
628
</td>
<td style="text-align:right;">
1.010
</td>
<td style="text-align:right;">
630
</td>
<td style="text-align:right;">
457
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[4]
</td>
<td style="text-align:right;">
0.825
</td>
<td style="text-align:right;">
0.111
</td>
<td style="text-align:right;">
0.612
</td>
<td style="text-align:right;">
1.042
</td>
<td style="text-align:right;">
618
</td>
<td style="text-align:right;">
1.000
</td>
<td style="text-align:right;">
630
</td>
<td style="text-align:right;">
569
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
2.013
</td>
<td style="text-align:right;">
0.090
</td>
<td style="text-align:right;">
1.844
</td>
<td style="text-align:right;">
2.204
</td>
<td style="text-align:right;">
682
</td>
<td style="text-align:right;">
1.004
</td>
<td style="text-align:right;">
693
</td>
<td style="text-align:right;">
425
</td>
</tr>
</tbody>
</table>
</div>
<div id="comparison-58" class="section level2">
<h2>Comparison</h2>
<p>Our estimates look pretty good, and inspection of the diagnostics would show
good mixing and convergence as well. At this point we can compare it to the Stan
output. For the following, I use the same inverse gamma prior and tweaked the
control options for a little bit more similarity, but that’s not necessary.</p>
<pre class="stan"><code>data {                            // Data block
  int&lt;lower = 1&gt; N;               // Sample size
  int&lt;lower = 1&gt; K;               // Dimension of model matrix
  matrix [N, K]  X;               // Model Matrix
  vector[N] y;                    // Target variable
}

parameters {                      // Parameters block; declarations only
  vector[K] beta;                 // Coefficient vector
  real&lt;lower = 0&gt; sigma;          // Error scale
}

model {                           // Model block
  vector[N] mu;

  mu = X * beta;                  // Creation of linear predictor
  
  
  // priors
  beta  ~ normal(0, 10);
  sigma ~ inv_gamma(.001, .001);  // changed to gamma a la code above
  
  // likelihood
  y ~ normal(mu, sigma);
}</code></pre>
<p>Here are the results.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:hmc-compare-stan">Table 2: </span>log posterior = -1270.794
</caption>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
conf.low
</th>
<th style="text-align:right;">
conf.high
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:right;">
1.421
</td>
<td style="text-align:right;">
3.336
</td>
<td style="text-align:right;">
-1.761
</td>
<td style="text-align:right;">
5.095
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:right;">
1.075
</td>
<td style="text-align:right;">
0.818
</td>
<td style="text-align:right;">
-0.121
</td>
<td style="text-align:right;">
1.710
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[3]
</td>
<td style="text-align:right;">
0.220
</td>
<td style="text-align:right;">
1.474
</td>
<td style="text-align:right;">
-1.667
</td>
<td style="text-align:right;">
1.480
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[4]
</td>
<td style="text-align:right;">
-0.094
</td>
<td style="text-align:right;">
0.786
</td>
<td style="text-align:right;">
-0.738
</td>
<td style="text-align:right;">
1.013
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
2.034
</td>
<td style="text-align:right;">
0.064
</td>
<td style="text-align:right;">
1.889
</td>
<td style="text-align:right;">
2.199
</td>
</tr>
</tbody>
</table>
<p>And finally, the standard least squares fit (Residual standard error = sigma).</p>
<table style="width:90%;">
<colgroup>
<col width="25%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="18%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">4.898</td>
<td align="center">0.1284</td>
<td align="center">38.13</td>
<td align="center">3.026e-105</td>
</tr>
<tr class="even">
<td align="center"><strong>X1</strong></td>
<td align="center">0.08408</td>
<td align="center">0.1296</td>
<td align="center">0.6488</td>
<td align="center">0.5171</td>
</tr>
<tr class="odd">
<td align="center"><strong>X2</strong></td>
<td align="center">-1.469</td>
<td align="center">0.1261</td>
<td align="center">-11.64</td>
<td align="center">3.049e-25</td>
</tr>
<tr class="even">
<td align="center"><strong>X3</strong></td>
<td align="center">0.8196</td>
<td align="center">0.1207</td>
<td align="center">6.793</td>
<td align="center">8.207e-11</td>
</tr>
</tbody>
</table>
<table style="width:88%;">
<caption>Fitting linear model: y ~ .</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">250</td>
<td align="center">2.021</td>
<td align="center">0.4524</td>
<td align="center">0.4458</td>
</tr>
</tbody>
</table>
</div>
<div id="source-52" class="section level2">
<h2>Source</h2>
<p>Original demo here:</p>
<p><a href="https://m-clark.github.io/bayesian-basics/appendix.html#hamiltonian-monte-carlo-example" class="uri">https://m-clark.github.io/bayesian-basics/appendix.html#hamiltonian-monte-carlo-example</a></p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="metropolis-hastings.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="supplemental.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/hamiltonian-monte-carlo.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
