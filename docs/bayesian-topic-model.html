<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic Model | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic Model | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic Model | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="bayesian-variational.html"/>
<link rel="next" href="maximum-likelihood.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#one-factor-mixed-model"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#two-factor-mixed-model"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#mixed-model-via-ml"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial Regression</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal Regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#python-2"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gaussian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html"><i class="fa fa-check"></i>Neural Network</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-3"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-4"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-3"><i class="fa fa-check"></i>Example 3</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-5"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-2"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-22"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-27"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#introduction-2"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l1-lasso-regularization"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l2-ridge-regularization"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-9"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-42"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder-Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-45"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-24"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-51"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-32"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-55"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#sgd-variants"><i class="fa fa-check"></i>SGD Variants</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-33"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-56"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-2"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-52"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-11"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-57"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-53"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-52"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-58"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-52"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="topic-model" class="section level1">
<h1>Topic Model</h1>
<p>An implementation of Gibbs sampling for topic models for the example in section
4 of <a href="http://cocosci.berkeley.edu/tom/papers/SteyversGriffiths.pdf">Steyvers and Griffiths (2007)</a>. A very clear intro in my opinion. The core of the function’s code comprises mostly cosmetic
changes to that found <a href="https://bcomposes.wordpress.com/2012/05/29/gibbs-sampler-for-toy-topic-model-example/">here</a>. Added are the creation of a function with several arguments, plotting etc.</p>
<div id="data-setup-34" class="section level2">
<h2>Data Setup</h2>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="bayesian-topic-model.html#cb597-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb597-2"><a href="bayesian-topic-model.html#cb597-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb597-3"><a href="bayesian-topic-model.html#cb597-3" aria-hidden="true" tabindex="-1"></a>vocab <span class="ot">=</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">&quot;river&quot;</span>, <span class="st">&quot;stream&quot;</span>, <span class="st">&quot;bank&quot;</span>, <span class="st">&quot;money&quot;</span>, <span class="st">&quot;loan&quot;</span>))</span>
<span id="cb597-4"><a href="bayesian-topic-model.html#cb597-4" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">2</span>  <span class="co"># n of topics</span></span>
<span id="cb597-5"><a href="bayesian-topic-model.html#cb597-5" aria-hidden="true" tabindex="-1"></a>v <span class="ot">=</span> <span class="fu">length</span>(vocab)  <span class="co"># number of unique words</span></span>
<span id="cb597-6"><a href="bayesian-topic-model.html#cb597-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">=</span> <span class="dv">16</span> <span class="co"># number of documents </span></span></code></pre></div>
<p>Topic 1 gives equal probability to money loan and bank (zero for river and stream).
Topic 2 gives equal probability to river stream and bank (zero for money and loan).</p>
<p>Next we create a document term matrix. Each doc consists of a mix of 16 tokens of the vocab-
the first few regard financial banks, the last several water banks, and the docs in between possess a mixed vocab.</p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="bayesian-topic-model.html#cb598-1" aria-hidden="true" tabindex="-1"></a>dtm <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">6</span>,</span>
<span id="cb598-2"><a href="bayesian-topic-model.html#cb598-2" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">4</span>,</span>
<span id="cb598-3"><a href="bayesian-topic-model.html#cb598-3" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">4</span>,</span>
<span id="cb598-4"><a href="bayesian-topic-model.html#cb598-4" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">6</span>,<span class="dv">3</span>,</span>
<span id="cb598-5"><a href="bayesian-topic-model.html#cb598-5" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">7</span>,</span>
<span id="cb598-6"><a href="bayesian-topic-model.html#cb598-6" aria-hidden="true" tabindex="-1"></a>               <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">9</span>,<span class="dv">3</span>,<span class="dv">4</span>,</span>
<span id="cb598-7"><a href="bayesian-topic-model.html#cb598-7" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">5</span>,</span>
<span id="cb598-8"><a href="bayesian-topic-model.html#cb598-8" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">3</span>,</span>
<span id="cb598-9"><a href="bayesian-topic-model.html#cb598-9" aria-hidden="true" tabindex="-1"></a>               <span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">4</span>,<span class="dv">2</span>,</span>
<span id="cb598-10"><a href="bayesian-topic-model.html#cb598-10" aria-hidden="true" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">4</span>,</span>
<span id="cb598-11"><a href="bayesian-topic-model.html#cb598-11" aria-hidden="true" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">1</span>,</span>
<span id="cb598-12"><a href="bayesian-topic-model.html#cb598-12" aria-hidden="true" tabindex="-1"></a>               <span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">1</span>,<span class="dv">0</span>,</span>
<span id="cb598-13"><a href="bayesian-topic-model.html#cb598-13" aria-hidden="true" tabindex="-1"></a>               <span class="dv">6</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb598-14"><a href="bayesian-topic-model.html#cb598-14" aria-hidden="true" tabindex="-1"></a>               <span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">6</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb598-15"><a href="bayesian-topic-model.html#cb598-15" aria-hidden="true" tabindex="-1"></a>               <span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb598-16"><a href="bayesian-topic-model.html#cb598-16" aria-hidden="true" tabindex="-1"></a>               <span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="at">ncol =</span> v, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb598-17"><a href="bayesian-topic-model.html#cb598-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb598-18"><a href="bayesian-topic-model.html#cb598-18" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(dtm) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&#39;doc&#39;</span>, <span class="dv">1</span><span class="sc">:</span>d)</span>
<span id="cb598-19"><a href="bayesian-topic-model.html#cb598-19" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dtm) <span class="ot">=</span> vocab</span></code></pre></div>
<p>Next we create additional objects to initialize the setup.</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="bayesian-topic-model.html#cb599-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix of words in each document</span></span>
<span id="cb599-2"><a href="bayesian-topic-model.html#cb599-2" aria-hidden="true" tabindex="-1"></a>wordmat <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(dtm, <span class="dv">1</span>, <span class="cf">function</span>(row) <span class="fu">rep</span>(vocab, row)))</span>
<span id="cb599-3"><a href="bayesian-topic-model.html#cb599-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-4"><a href="bayesian-topic-model.html#cb599-4" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize random topic assignments to words</span></span>
<span id="cb599-5"><a href="bayesian-topic-model.html#cb599-5" aria-hidden="true" tabindex="-1"></a>T0 <span class="ot">=</span> <span class="fu">apply</span>(wordmat, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),  <span class="cf">function</span>(token) <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb599-6"><a href="bayesian-topic-model.html#cb599-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-7"><a href="bayesian-topic-model.html#cb599-7" aria-hidden="true" tabindex="-1"></a><span class="co"># word by topic matrix of counts containing the number of times word w is</span></span>
<span id="cb599-8"><a href="bayesian-topic-model.html#cb599-8" aria-hidden="true" tabindex="-1"></a><span class="co"># assigned to topic j</span></span>
<span id="cb599-9"><a href="bayesian-topic-model.html#cb599-9" aria-hidden="true" tabindex="-1"></a>C_wt <span class="ot">=</span> <span class="fu">sapply</span>(vocab, <span class="cf">function</span>(word)  <span class="fu">cbind</span>(<span class="fu">sum</span>(T0[wordmat <span class="sc">==</span> word] <span class="sc">==</span> <span class="dv">1</span>),</span>
<span id="cb599-10"><a href="bayesian-topic-model.html#cb599-10" aria-hidden="true" tabindex="-1"></a>                                           <span class="fu">sum</span>(T0[wordmat <span class="sc">==</span> word] <span class="sc">==</span> <span class="dv">2</span>)))</span>
<span id="cb599-11"><a href="bayesian-topic-model.html#cb599-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-12"><a href="bayesian-topic-model.html#cb599-12" aria-hidden="true" tabindex="-1"></a>C_wt <span class="ot">=</span> <span class="fu">t</span>(C_wt)</span>
<span id="cb599-13"><a href="bayesian-topic-model.html#cb599-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(C_wt) <span class="ot">=</span> vocab</span>
<span id="cb599-14"><a href="bayesian-topic-model.html#cb599-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-15"><a href="bayesian-topic-model.html#cb599-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb599-16"><a href="bayesian-topic-model.html#cb599-16" aria-hidden="true" tabindex="-1"></a><span class="co"># topic by document matrix of counts containing the number of times topic j is</span></span>
<span id="cb599-17"><a href="bayesian-topic-model.html#cb599-17" aria-hidden="true" tabindex="-1"></a><span class="co"># assigned to a word in document d</span></span>
<span id="cb599-18"><a href="bayesian-topic-model.html#cb599-18" aria-hidden="true" tabindex="-1"></a>C_dt <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(T0, <span class="dv">1</span>, table))</span></code></pre></div>
</div>
<div id="function-20" class="section level2">
<h2>Function</h2>
<p>Note that this function is not self contained in that it uses some of the objects created above, assuming they are in the global environment. It has the capacity for a pseudo-visualization which can be instructive, but isn’t shown for this document (and it requries <span class="pack" style="">corrplot</span>), and I haven’t tested it recently.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="bayesian-topic-model.html#cb600-1" aria-hidden="true" tabindex="-1"></a>topic_model <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb600-2"><a href="bayesian-topic-model.html#cb600-2" aria-hidden="true" tabindex="-1"></a>  alpha,</span>
<span id="cb600-3"><a href="bayesian-topic-model.html#cb600-3" aria-hidden="true" tabindex="-1"></a>  beta,</span>
<span id="cb600-4"><a href="bayesian-topic-model.html#cb600-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim    =</span> <span class="dv">2000</span>,</span>
<span id="cb600-5"><a href="bayesian-topic-model.html#cb600-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup  =</span> nsim <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb600-6"><a href="bayesian-topic-model.html#cb600-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin    =</span> <span class="dv">10</span>,</span>
<span id="cb600-7"><a href="bayesian-topic-model.html#cb600-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb600-8"><a href="bayesian-topic-model.html#cb600-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot    =</span> <span class="cn">FALSE</span>,</span>
<span id="cb600-9"><a href="bayesian-topic-model.html#cb600-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">dotsortext =</span> <span class="st">&#39;dots&#39;</span></span>
<span id="cb600-10"><a href="bayesian-topic-model.html#cb600-10" aria-hidden="true" tabindex="-1"></a>) {</span>
<span id="cb600-11"><a href="bayesian-topic-model.html#cb600-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb600-12"><a href="bayesian-topic-model.html#cb600-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments: </span></span>
<span id="cb600-13"><a href="bayesian-topic-model.html#cb600-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># alpha and beta: hyperparameters</span></span>
<span id="cb600-14"><a href="bayesian-topic-model.html#cb600-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nsim: the total number of simulations</span></span>
<span id="cb600-15"><a href="bayesian-topic-model.html#cb600-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># warmup: the number of initial sims to discard</span></span>
<span id="cb600-16"><a href="bayesian-topic-model.html#cb600-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># thin: keep every thin simulation after warmup </span></span>
<span id="cb600-17"><a href="bayesian-topic-model.html#cb600-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># verbose: to print every 100th iteration and total time</span></span>
<span id="cb600-18"><a href="bayesian-topic-model.html#cb600-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot: to visualize every x sim; the plot will show current estimates of</span></span>
<span id="cb600-19"><a href="bayesian-topic-model.html#cb600-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theta, phi, and topic assignments for each term in the docs; can be</span></span>
<span id="cb600-20"><a href="bayesian-topic-model.html#cb600-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># visualized as dots or the actual terms; for the latter you may need to</span></span>
<span id="cb600-21"><a href="bayesian-topic-model.html#cb600-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fiddle with your viewing area size so that terms don&#39;t appear to run</span></span>
<span id="cb600-22"><a href="bayesian-topic-model.html#cb600-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># together; plotting will increase runtime</span></span>
<span id="cb600-23"><a href="bayesian-topic-model.html#cb600-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb600-24"><a href="bayesian-topic-model.html#cb600-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># requires corrplot for visualizations, and abind to create arrays from the</span></span>
<span id="cb600-25"><a href="bayesian-topic-model.html#cb600-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># lists.</span></span>
<span id="cb600-26"><a href="bayesian-topic-model.html#cb600-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb600-27"><a href="bayesian-topic-model.html#cb600-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initialize </span></span>
<span id="cb600-28"><a href="bayesian-topic-model.html#cb600-28" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">=</span> T0                                         <span class="co"># topic assignments</span></span>
<span id="cb600-29"><a href="bayesian-topic-model.html#cb600-29" aria-hidden="true" tabindex="-1"></a>  saveSim   <span class="ot">=</span> <span class="fu">seq</span>(warmup <span class="sc">+</span> <span class="dv">1</span>, nsim, thin)        <span class="co"># iterations to save</span></span>
<span id="cb600-30"><a href="bayesian-topic-model.html#cb600-30" aria-hidden="true" tabindex="-1"></a>  theta_list <span class="ot">=</span> <span class="fu">list</span>()                             <span class="co"># saved theta estimates</span></span>
<span id="cb600-31"><a href="bayesian-topic-model.html#cb600-31" aria-hidden="true" tabindex="-1"></a>  phi_list   <span class="ot">=</span> <span class="fu">list</span>()                             <span class="co"># saved phi estimates</span></span>
<span id="cb600-32"><a href="bayesian-topic-model.html#cb600-32" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb600-33"><a href="bayesian-topic-model.html#cb600-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb600-34"><a href="bayesian-topic-model.html#cb600-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for every simulation...</span></span>
<span id="cb600-35"><a href="bayesian-topic-model.html#cb600-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nsim) {</span>
<span id="cb600-36"><a href="bayesian-topic-model.html#cb600-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(verbose <span class="sc">&amp;&amp;</span> s <span class="sc">%%</span> <span class="dv">100</span> <span class="sc">==</span> <span class="dv">0</span>) {               <span class="co"># paste every 100th iteration if desired</span></span>
<span id="cb600-37"><a href="bayesian-topic-model.html#cb600-37" aria-hidden="true" tabindex="-1"></a>      secs <span class="ot">=</span> <span class="fu">round</span>((<span class="fu">proc.time</span>() <span class="sc">-</span> p)[<span class="dv">3</span>],<span class="dv">2</span>)</span>
<span id="cb600-38"><a href="bayesian-topic-model.html#cb600-38" aria-hidden="true" tabindex="-1"></a>      min  <span class="ot">=</span> <span class="fu">round</span>(secs<span class="sc">/</span><span class="dv">60</span>, <span class="dv">2</span>)</span>
<span id="cb600-39"><a href="bayesian-topic-model.html#cb600-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">message</span>(<span class="fu">paste0</span>(</span>
<span id="cb600-40"><a href="bayesian-topic-model.html#cb600-40" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Iteration number: &#39;</span>,</span>
<span id="cb600-41"><a href="bayesian-topic-model.html#cb600-41" aria-hidden="true" tabindex="-1"></a>        s,</span>
<span id="cb600-42"><a href="bayesian-topic-model.html#cb600-42" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>,</span>
<span id="cb600-43"><a href="bayesian-topic-model.html#cb600-43" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Total time: &#39;</span>,</span>
<span id="cb600-44"><a href="bayesian-topic-model.html#cb600-44" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ifelse</span>(secs <span class="sc">&lt;=</span> <span class="dv">60</span>, <span class="fu">paste</span>(secs, <span class="st">&#39;seconds&#39;</span>), <span class="fu">paste</span>(min, <span class="st">&#39;minutes&#39;</span>))</span>
<span id="cb600-45"><a href="bayesian-topic-model.html#cb600-45" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb600-46"><a href="bayesian-topic-model.html#cb600-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb600-47"><a href="bayesian-topic-model.html#cb600-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb600-48"><a href="bayesian-topic-model.html#cb600-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Visualization</span></span>
<span id="cb600-49"><a href="bayesian-topic-model.html#cb600-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> s <span class="sc">&gt;</span><span class="dv">1</span> <span class="sc">&amp;&amp;</span>  s <span class="sc">%%</span> plot <span class="sc">==</span> <span class="dv">0</span>) {    <span class="co"># plot every value of argument</span></span>
<span id="cb600-50"><a href="bayesian-topic-model.html#cb600-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">require</span>(corrplot)</span>
<span id="cb600-51"><a href="bayesian-topic-model.html#cb600-51" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb600-52"><a href="bayesian-topic-model.html#cb600-52" aria-hidden="true" tabindex="-1"></a>      <span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">10</span>))</span>
<span id="cb600-53"><a href="bayesian-topic-model.html#cb600-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">corrplot</span>(</span>
<span id="cb600-54"><a href="bayesian-topic-model.html#cb600-54" aria-hidden="true" tabindex="-1"></a>        theta,</span>
<span id="cb600-55"><a href="bayesian-topic-model.html#cb600-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">is.corr =</span> <span class="cn">FALSE</span>,</span>
<span id="cb600-56"><a href="bayesian-topic-model.html#cb600-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">method  =</span> <span class="st">&#39;color&#39;</span>,</span>
<span id="cb600-57"><a href="bayesian-topic-model.html#cb600-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">tl.cex  =</span> .<span class="dv">75</span>,</span>
<span id="cb600-58"><a href="bayesian-topic-model.html#cb600-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">tl.col  =</span> <span class="st">&#39;gray50&#39;</span>,</span>
<span id="cb600-59"><a href="bayesian-topic-model.html#cb600-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">cl.pos  =</span> <span class="st">&#39;n&#39;</span>,</span>
<span id="cb600-60"><a href="bayesian-topic-model.html#cb600-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">addgrid =</span> <span class="cn">NA</span></span>
<span id="cb600-61"><a href="bayesian-topic-model.html#cb600-61" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb600-62"><a href="bayesian-topic-model.html#cb600-62" aria-hidden="true" tabindex="-1"></a>      <span class="fu">corrplot</span>(</span>
<span id="cb600-63"><a href="bayesian-topic-model.html#cb600-63" aria-hidden="true" tabindex="-1"></a>        phi,</span>
<span id="cb600-64"><a href="bayesian-topic-model.html#cb600-64" aria-hidden="true" tabindex="-1"></a>        <span class="at">is.corr =</span> <span class="cn">FALSE</span>,</span>
<span id="cb600-65"><a href="bayesian-topic-model.html#cb600-65" aria-hidden="true" tabindex="-1"></a>        <span class="at">method  =</span> <span class="st">&#39;color&#39;</span>,</span>
<span id="cb600-66"><a href="bayesian-topic-model.html#cb600-66" aria-hidden="true" tabindex="-1"></a>        <span class="at">tl.cex  =</span> <span class="dv">1</span>,</span>
<span id="cb600-67"><a href="bayesian-topic-model.html#cb600-67" aria-hidden="true" tabindex="-1"></a>        <span class="at">tl.col  =</span> <span class="st">&#39;gray50&#39;</span>,</span>
<span id="cb600-68"><a href="bayesian-topic-model.html#cb600-68" aria-hidden="true" tabindex="-1"></a>        <span class="at">cl.pos  =</span> <span class="st">&#39;n&#39;</span>,</span>
<span id="cb600-69"><a href="bayesian-topic-model.html#cb600-69" aria-hidden="true" tabindex="-1"></a>        <span class="at">addgrid =</span> <span class="cn">NA</span></span>
<span id="cb600-70"><a href="bayesian-topic-model.html#cb600-70" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb600-71"><a href="bayesian-topic-model.html#cb600-71" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (dotsortext <span class="sc">==</span> <span class="st">&#39;dots&#39;</span>) {</span>
<span id="cb600-72"><a href="bayesian-topic-model.html#cb600-72" aria-hidden="true" tabindex="-1"></a>        Zplot <span class="ot">=</span> Z</span>
<span id="cb600-73"><a href="bayesian-topic-model.html#cb600-73" aria-hidden="true" tabindex="-1"></a>        Zplot[Zplot <span class="sc">==</span> <span class="dv">2</span>] <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb600-74"><a href="bayesian-topic-model.html#cb600-74" aria-hidden="true" tabindex="-1"></a>        <span class="fu">corrplot</span>(</span>
<span id="cb600-75"><a href="bayesian-topic-model.html#cb600-75" aria-hidden="true" tabindex="-1"></a>          Zplot,</span>
<span id="cb600-76"><a href="bayesian-topic-model.html#cb600-76" aria-hidden="true" tabindex="-1"></a>          <span class="at">is.corr =</span> <span class="cn">FALSE</span>,</span>
<span id="cb600-77"><a href="bayesian-topic-model.html#cb600-77" aria-hidden="true" tabindex="-1"></a>          <span class="at">method  =</span> <span class="st">&#39;circle&#39;</span>,</span>
<span id="cb600-78"><a href="bayesian-topic-model.html#cb600-78" aria-hidden="true" tabindex="-1"></a>          <span class="at">tl.cex  =</span> .<span class="dv">75</span>,</span>
<span id="cb600-79"><a href="bayesian-topic-model.html#cb600-79" aria-hidden="true" tabindex="-1"></a>          <span class="at">tl.col  =</span> <span class="st">&#39;gray50&#39;</span>,</span>
<span id="cb600-80"><a href="bayesian-topic-model.html#cb600-80" aria-hidden="true" tabindex="-1"></a>          <span class="at">cl.pos  =</span> <span class="st">&#39;n&#39;</span>,</span>
<span id="cb600-81"><a href="bayesian-topic-model.html#cb600-81" aria-hidden="true" tabindex="-1"></a>          <span class="at">addgrid =</span> <span class="cn">NA</span></span>
<span id="cb600-82"><a href="bayesian-topic-model.html#cb600-82" aria-hidden="true" tabindex="-1"></a>        ) </span>
<span id="cb600-83"><a href="bayesian-topic-model.html#cb600-83" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb600-84"><a href="bayesian-topic-model.html#cb600-84" aria-hidden="true" tabindex="-1"></a>        cols <span class="ot">=</span> <span class="fu">apply</span>(Z, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="cf">function</span>(topicvalue)</span>
<span id="cb600-85"><a href="bayesian-topic-model.html#cb600-85" aria-hidden="true" tabindex="-1"></a>          <span class="fu">ifelse</span>(topicvalue <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&#39;#053061&#39;</span>, <span class="st">&#39;#67001F&#39;</span>))</span>
<span id="cb600-86"><a href="bayesian-topic-model.html#cb600-86" aria-hidden="true" tabindex="-1"></a>        <span class="fu">plot</span>(</span>
<span id="cb600-87"><a href="bayesian-topic-model.html#cb600-87" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(wordmat),</span>
<span id="cb600-88"><a href="bayesian-topic-model.html#cb600-88" aria-hidden="true" tabindex="-1"></a>          <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(wordmat),</span>
<span id="cb600-89"><a href="bayesian-topic-model.html#cb600-89" aria-hidden="true" tabindex="-1"></a>          <span class="at">type =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb600-90"><a href="bayesian-topic-model.html#cb600-90" aria-hidden="true" tabindex="-1"></a>          <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb600-91"><a href="bayesian-topic-model.html#cb600-91" aria-hidden="true" tabindex="-1"></a>          <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb600-92"><a href="bayesian-topic-model.html#cb600-92" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">&#39;&#39;</span></span>
<span id="cb600-93"><a href="bayesian-topic-model.html#cb600-93" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb600-94"><a href="bayesian-topic-model.html#cb600-94" aria-hidden="true" tabindex="-1"></a>        <span class="fu">text</span>(<span class="fu">col</span>(wordmat),</span>
<span id="cb600-95"><a href="bayesian-topic-model.html#cb600-95" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rev</span>(<span class="fu">row</span>(wordmat)),</span>
<span id="cb600-96"><a href="bayesian-topic-model.html#cb600-96" aria-hidden="true" tabindex="-1"></a>             wordmat,</span>
<span id="cb600-97"><a href="bayesian-topic-model.html#cb600-97" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> cols,</span>
<span id="cb600-98"><a href="bayesian-topic-model.html#cb600-98" aria-hidden="true" tabindex="-1"></a>             <span class="at">cex =</span> .<span class="dv">75</span>)</span>
<span id="cb600-99"><a href="bayesian-topic-model.html#cb600-99" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb600-100"><a href="bayesian-topic-model.html#cb600-100" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb600-101"><a href="bayesian-topic-model.html#cb600-101" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb600-102"><a href="bayesian-topic-model.html#cb600-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb600-103"><a href="bayesian-topic-model.html#cb600-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for every document and every word in the document</span></span>
<span id="cb600-104"><a href="bayesian-topic-model.html#cb600-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d) {</span>
<span id="cb600-105"><a href="bayesian-topic-model.html#cb600-105" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(wordmat[i,])) {</span>
<span id="cb600-106"><a href="bayesian-topic-model.html#cb600-106" aria-hidden="true" tabindex="-1"></a>        word.id <span class="ot">=</span> <span class="fu">which</span>(vocab <span class="sc">==</span> wordmat[i, j])</span>
<span id="cb600-107"><a href="bayesian-topic-model.html#cb600-107" aria-hidden="true" tabindex="-1"></a>        topic.old <span class="ot">=</span> Z[i, j]</span>
<span id="cb600-108"><a href="bayesian-topic-model.html#cb600-108" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb600-109"><a href="bayesian-topic-model.html#cb600-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Decrement counts before computing equation (3) in paper noted above</span></span>
<span id="cb600-110"><a href="bayesian-topic-model.html#cb600-110" aria-hidden="true" tabindex="-1"></a>        C_dt[i, topic.old] <span class="ot">=</span> C_dt[i, topic.old] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb600-111"><a href="bayesian-topic-model.html#cb600-111" aria-hidden="true" tabindex="-1"></a>        C_wt[word.id, topic.old] <span class="ot">=</span> C_wt[word.id, topic.old] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb600-112"><a href="bayesian-topic-model.html#cb600-112" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb600-113"><a href="bayesian-topic-model.html#cb600-113" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate equation (3) for each topic</span></span>
<span id="cb600-114"><a href="bayesian-topic-model.html#cb600-114" aria-hidden="true" tabindex="-1"></a>        vals <span class="ot">=</span> <span class="fu">prop.table</span>(C_wt <span class="sc">+</span> beta, <span class="dv">2</span>)[word.id,] <span class="sc">*</span> <span class="fu">prop.table</span>(C_dt[i,] <span class="sc">+</span> alpha)</span>
<span id="cb600-115"><a href="bayesian-topic-model.html#cb600-115" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb600-116"><a href="bayesian-topic-model.html#cb600-116" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sample the new topic from the results for (3);         </span></span>
<span id="cb600-117"><a href="bayesian-topic-model.html#cb600-117" aria-hidden="true" tabindex="-1"></a>        <span class="co"># note, sample function does not require you to have the probs sum to 1</span></span>
<span id="cb600-118"><a href="bayesian-topic-model.html#cb600-118" aria-hidden="true" tabindex="-1"></a>        <span class="co"># explicitly, i.e.  prob=c(1,1,1) is the same as prob = c(1/3, 1/3, 1/3)</span></span>
<span id="cb600-119"><a href="bayesian-topic-model.html#cb600-119" aria-hidden="true" tabindex="-1"></a>        Z.new <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="dv">1</span>, <span class="at">prob =</span> vals)</span>
<span id="cb600-120"><a href="bayesian-topic-model.html#cb600-120" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb600-121"><a href="bayesian-topic-model.html#cb600-121" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set the new topic and update counts</span></span>
<span id="cb600-122"><a href="bayesian-topic-model.html#cb600-122" aria-hidden="true" tabindex="-1"></a>        Z[i,j] <span class="ot">=</span> Z.new</span>
<span id="cb600-123"><a href="bayesian-topic-model.html#cb600-123" aria-hidden="true" tabindex="-1"></a>        C_dt[i, Z.new] <span class="ot">=</span> C_dt[i, Z.new] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb600-124"><a href="bayesian-topic-model.html#cb600-124" aria-hidden="true" tabindex="-1"></a>        C_wt[word.id, Z.new] <span class="ot">=</span> C_wt[word.id, Z.new] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb600-125"><a href="bayesian-topic-model.html#cb600-125" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb600-126"><a href="bayesian-topic-model.html#cb600-126" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb600-127"><a href="bayesian-topic-model.html#cb600-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb600-128"><a href="bayesian-topic-model.html#cb600-128" aria-hidden="true" tabindex="-1"></a>    theta <span class="ot">=</span> <span class="fu">prop.table</span>(C_dt <span class="sc">+</span> alpha,<span class="dv">1</span>)           <span class="co"># doc topic distribution</span></span>
<span id="cb600-129"><a href="bayesian-topic-model.html#cb600-129" aria-hidden="true" tabindex="-1"></a>    phi   <span class="ot">=</span> <span class="fu">prop.table</span>(C_wt <span class="sc">+</span> beta,<span class="dv">2</span>)            <span class="co"># word topic distribution</span></span>
<span id="cb600-130"><a href="bayesian-topic-model.html#cb600-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb600-131"><a href="bayesian-topic-model.html#cb600-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># save simulations</span></span>
<span id="cb600-132"><a href="bayesian-topic-model.html#cb600-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (s <span class="sc">%in%</span> saveSim){</span>
<span id="cb600-133"><a href="bayesian-topic-model.html#cb600-133" aria-hidden="true" tabindex="-1"></a>      theta_list[[<span class="fu">paste</span>(s)]] <span class="ot">=</span> theta</span>
<span id="cb600-134"><a href="bayesian-topic-model.html#cb600-134" aria-hidden="true" tabindex="-1"></a>      phi_list[[<span class="fu">paste</span>(s)]]   <span class="ot">=</span> phi</span>
<span id="cb600-135"><a href="bayesian-topic-model.html#cb600-135" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb600-136"><a href="bayesian-topic-model.html#cb600-136" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb600-137"><a href="bayesian-topic-model.html#cb600-137" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb600-138"><a href="bayesian-topic-model.html#cb600-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="dv">1</span>) <span class="co"># reset plot window</span></span>
<span id="cb600-139"><a href="bayesian-topic-model.html#cb600-139" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb600-140"><a href="bayesian-topic-model.html#cb600-140" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb600-141"><a href="bayesian-topic-model.html#cb600-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb600-142"><a href="bayesian-topic-model.html#cb600-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta =</span> theta,</span>
<span id="cb600-143"><a href="bayesian-topic-model.html#cb600-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi   =</span> phi,</span>
<span id="cb600-144"><a href="bayesian-topic-model.html#cb600-144" aria-hidden="true" tabindex="-1"></a>    <span class="at">theta_sims =</span> abind<span class="sc">::</span><span class="fu">abind</span>(theta_list, <span class="at">along =</span> <span class="dv">3</span>),</span>
<span id="cb600-145"><a href="bayesian-topic-model.html#cb600-145" aria-hidden="true" tabindex="-1"></a>    <span class="at">phi_sims   =</span> abind<span class="sc">::</span><span class="fu">abind</span>(phi_list, <span class="at">along =</span> <span class="dv">3</span>)</span>
<span id="cb600-146"><a href="bayesian-topic-model.html#cb600-146" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb600-147"><a href="bayesian-topic-model.html#cb600-147" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="estimation-33" class="section level2">
<h2>Estimation</h2>
<p>We use the values of alpha and beta as suggested in paper. The following will result in 500 posterior sample points, so bump if you want more than that. These settings take around 20 seconds.</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="bayesian-topic-model.html#cb601-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb601-2"><a href="bayesian-topic-model.html#cb601-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-3"><a href="bayesian-topic-model.html#cb601-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> K<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb601-4"><a href="bayesian-topic-model.html#cb601-4" aria-hidden="true" tabindex="-1"></a>beta  <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb601-5"><a href="bayesian-topic-model.html#cb601-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb601-6"><a href="bayesian-topic-model.html#cb601-6" aria-hidden="true" tabindex="-1"></a>fit_tm <span class="ot">=</span> <span class="fu">topic_model</span>(</span>
<span id="cb601-7"><a href="bayesian-topic-model.html#cb601-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha  =</span> alpha,</span>
<span id="cb601-8"><a href="bayesian-topic-model.html#cb601-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta   =</span> beta,</span>
<span id="cb601-9"><a href="bayesian-topic-model.html#cb601-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim   =</span> <span class="dv">1000</span>,</span>
<span id="cb601-10"><a href="bayesian-topic-model.html#cb601-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup =</span> <span class="dv">500</span>,</span>
<span id="cb601-11"><a href="bayesian-topic-model.html#cb601-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin   =</span> <span class="dv">1</span>,</span>
<span id="cb601-12"><a href="bayesian-topic-model.html#cb601-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span>,</span>
<span id="cb601-13"><a href="bayesian-topic-model.html#cb601-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot    =</span> <span class="cn">FALSE</span></span>
<span id="cb601-14"><a href="bayesian-topic-model.html#cb601-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="comparison-38" class="section level2">
<h2>Comparison</h2>
<p>First we can explore the results, in particular topic assignment probabilities and term topic probabilities.</p>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="bayesian-topic-model.html#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fit_tm, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>List of 4
 $ theta     : num [1:16, 1:2] 0.00249 0.00249 0.00249 0.00249 0.00249 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
 $ phi       : num [1:5, 1:2] 0.267293 0.415735 0.316774 0.000099 0.000099 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 2
 $ theta_sims: num [1:16, 1:2, 1:500] 0.00249 0.00249 0.00249 0.00249 0.00249 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 3
 $ phi_sims  : num [1:5, 1:2, 1:500] 2.38e-01 4.00e-01 3.62e-01 9.52e-05 9.52e-05 ...
  ..- attr(*, &quot;dimnames&quot;)=List of 3</code></pre>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="bayesian-topic-model.html#cb604-1" aria-hidden="true" tabindex="-1"></a>purrr<span class="sc">::</span><span class="fu">map</span>(fit_tm[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], round, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>$theta
         1    2
doc1  0.00 1.00
doc2  0.00 1.00
doc3  0.00 1.00
doc4  0.00 1.00
doc5  0.00 1.00
doc6  0.00 1.00
doc7  0.06 0.94
doc8  0.19 0.81
doc9  0.50 0.50
doc10 0.44 0.56
doc11 0.44 0.56
doc12 0.81 0.19
doc13 0.87 0.13
doc14 1.00 0.00
doc15 1.00 0.00
doc16 1.00 0.00

$phi
       [,1] [,2]
river  0.27 0.00
stream 0.42 0.00
bank   0.32 0.41
money  0.00 0.31
loan   0.00 0.28</code></pre>
<p>Now we can compare our result to reported paper estimates for <span class="math inline">\(\phi\)</span> and <span class="pack" style="">topicmodels</span> package (note delta is the beta above; the vignette actually references Steyvers &amp; Griffiths paper).</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb606-1"><a href="bayesian-topic-model.html#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(topicmodels)</span>
<span id="cb606-2"><a href="bayesian-topic-model.html#cb606-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb606-3"><a href="bayesian-topic-model.html#cb606-3" aria-hidden="true" tabindex="-1"></a>fit_lda <span class="ot">=</span> <span class="fu">LDA</span>(</span>
<span id="cb606-4"><a href="bayesian-topic-model.html#cb606-4" aria-hidden="true" tabindex="-1"></a>  dtm,</span>
<span id="cb606-5"><a href="bayesian-topic-model.html#cb606-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">2</span>,</span>
<span id="cb606-6"><a href="bayesian-topic-model.html#cb606-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method   =</span> <span class="st">&#39;Gibbs&#39;</span>,</span>
<span id="cb606-7"><a href="bayesian-topic-model.html#cb606-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">control  =</span> <span class="fu">list</span>(</span>
<span id="cb606-8"><a href="bayesian-topic-model.html#cb606-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha  =</span> alpha,</span>
<span id="cb606-9"><a href="bayesian-topic-model.html#cb606-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta  =</span> .<span class="dv">01</span>,</span>
<span id="cb606-10"><a href="bayesian-topic-model.html#cb606-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter   =</span> <span class="dv">5500</span>,</span>
<span id="cb606-11"><a href="bayesian-topic-model.html#cb606-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">burnin =</span> <span class="dv">500</span>,</span>
<span id="cb606-12"><a href="bayesian-topic-model.html#cb606-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">thin   =</span> <span class="dv">10</span>,</span>
<span id="cb606-13"><a href="bayesian-topic-model.html#cb606-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">initialize =</span> <span class="st">&#39;random&#39;</span></span>
<span id="cb606-14"><a href="bayesian-topic-model.html#cb606-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb606-15"><a href="bayesian-topic-model.html#cb606-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Start with <span class="math inline">\(\phi\)</span> estimates. Note that the labels of what is topic 1 vs. topic 2 is arbitrary, the main thing is the separation of the words that should go to different topics, while bank is probable for both topics.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
fit.1
</th>
<th style="text-align:right;">
fit.2
</th>
<th style="text-align:right;">
paper.1
</th>
<th style="text-align:right;">
paper.2
</th>
<th style="text-align:right;">
ldapack.1
</th>
<th style="text-align:right;">
ldapack.2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
river
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
stream
</td>
<td style="text-align:right;">
0.42
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.46
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
bank
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.41
</td>
<td style="text-align:right;">
0.39
</td>
<td style="text-align:right;">
0.35
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.44
</td>
</tr>
<tr>
<td style="text-align:left;">
money
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.32
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.29
</td>
</tr>
<tr>
<td style="text-align:left;">
loan
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.27
</td>
</tr>
</tbody>
</table>
<p>Interval estimates for term probabilities for each topic.</p>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="bayesian-topic-model.html#cb607-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb607-2"><a href="bayesian-topic-model.html#cb607-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-3"><a href="bayesian-topic-model.html#cb607-3" aria-hidden="true" tabindex="-1"></a>phi_estimates_topic_1 <span class="ot">=</span> <span class="fu">as.mcmc</span>(<span class="fu">t</span>(fit_tm<span class="sc">$</span>phi_sims[, <span class="dv">1</span>, ]))</span>
<span id="cb607-4"><a href="bayesian-topic-model.html#cb607-4" aria-hidden="true" tabindex="-1"></a>phi_estimates_topic_2 <span class="ot">=</span> <span class="fu">as.mcmc</span>(<span class="fu">t</span>(fit_tm<span class="sc">$</span>phi_sims[, <span class="dv">2</span>, ]))</span>
<span id="cb607-5"><a href="bayesian-topic-model.html#cb607-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb607-6"><a href="bayesian-topic-model.html#cb607-6" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(phi_estimates_topic_1)</span></span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
rowname
</th>
<th style="text-align:left;">
Topic
</th>
<th style="text-align:right;">
lower
</th>
<th style="text-align:right;">
upper
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
river…1
</td>
<td style="text-align:left;">
Topic 1
</td>
<td style="text-align:right;">
0.24
</td>
<td style="text-align:right;">
0.28
</td>
</tr>
<tr>
<td style="text-align:left;">
stream…2
</td>
<td style="text-align:left;">
Topic 1
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.43
</td>
</tr>
<tr>
<td style="text-align:left;">
bank…3
</td>
<td style="text-align:left;">
Topic 1
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.38
</td>
</tr>
<tr>
<td style="text-align:left;">
money…4
</td>
<td style="text-align:left;">
Topic 1
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
loan…5
</td>
<td style="text-align:left;">
Topic 1
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
river…6
</td>
<td style="text-align:left;">
Topic 2
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
stream…7
</td>
<td style="text-align:left;">
Topic 2
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
</tr>
<tr>
<td style="text-align:left;">
bank…8
</td>
<td style="text-align:left;">
Topic 2
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
0.42
</td>
</tr>
<tr>
<td style="text-align:left;">
money…9
</td>
<td style="text-align:left;">
Topic 2
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.33
</td>
</tr>
<tr>
<td style="text-align:left;">
loan…10
</td>
<td style="text-align:left;">
Topic 2
</td>
<td style="text-align:right;">
0.27
</td>
<td style="text-align:right;">
0.30
</td>
</tr>
</tbody>
</table>
<p>Symmetrized or mean <a href="https://en.wikipedia.org/wiki/Kullback%E2%80%93Leibler_divergence">Kullback-Liebler divergence</a> for topic (dis)similarity.</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="bayesian-topic-model.html#cb608-1" aria-hidden="true" tabindex="-1"></a>kl_divergence <span class="ot">=</span> .<span class="dv">5</span> <span class="sc">*</span> <span class="fu">sum</span>(</span>
<span id="cb608-2"><a href="bayesian-topic-model.html#cb608-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(</span>
<span id="cb608-3"><a href="bayesian-topic-model.html#cb608-3" aria-hidden="true" tabindex="-1"></a>    fit_tm<span class="sc">$</span>phi, </span>
<span id="cb608-4"><a href="bayesian-topic-model.html#cb608-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="cf">function</span>(row)  row[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">log2</span>(row[<span class="dv">1</span>] <span class="sc">/</span> row[<span class="dv">2</span>]) <span class="sc">+</span> row[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log2</span>(row[<span class="dv">2</span>] <span class="sc">/</span> row[<span class="dv">1</span>])</span>
<span id="cb608-5"><a href="bayesian-topic-model.html#cb608-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb608-6"><a href="bayesian-topic-model.html#cb608-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb608-7"><a href="bayesian-topic-model.html#cb608-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb608-8"><a href="bayesian-topic-model.html#cb608-8" aria-hidden="true" tabindex="-1"></a>kl_divergence</span></code></pre></div>
<pre><code>[1] 7.678387</code></pre>
<p>We can compare with various other packages for KL-divergence (not shown).</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="bayesian-topic-model.html#cb610-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(</span>
<span id="cb610-2"><a href="bayesian-topic-model.html#cb610-2" aria-hidden="true" tabindex="-1"></a>  entropy<span class="sc">::</span><span class="fu">KL.empirical</span>(fit_tm<span class="sc">$</span>phi[,<span class="dv">1</span>], fit_tm<span class="sc">$</span>phi[,<span class="dv">2</span>], <span class="at">unit =</span> <span class="st">&#39;log2&#39;</span>),</span>
<span id="cb610-3"><a href="bayesian-topic-model.html#cb610-3" aria-hidden="true" tabindex="-1"></a>  entropy<span class="sc">::</span><span class="fu">KL.empirical</span>(fit_tm<span class="sc">$</span>phi[,<span class="dv">2</span>], fit_tm<span class="sc">$</span>phi[,<span class="dv">1</span>], <span class="at">unit =</span> <span class="st">&#39;log2&#39;</span>)</span>
<span id="cb610-4"><a href="bayesian-topic-model.html#cb610-4" aria-hidden="true" tabindex="-1"></a>  ))</span></code></pre></div>
<p>Symmetrized or mean Kullback-Liebler divergence for document (dis)similarity.</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="bayesian-topic-model.html#cb611-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example</span></span>
<span id="cb611-2"><a href="bayesian-topic-model.html#cb611-2" aria-hidden="true" tabindex="-1"></a>docs2compare <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">16</span>)</span>
<span id="cb611-3"><a href="bayesian-topic-model.html#cb611-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb611-4"><a href="bayesian-topic-model.html#cb611-4" aria-hidden="true" tabindex="-1"></a>.<span class="dv">5</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">apply</span>(fit_tm<span class="sc">$</span>theta[docs2compare, ], <span class="dv">2</span>,</span>
<span id="cb611-5"><a href="bayesian-topic-model.html#cb611-5" aria-hidden="true" tabindex="-1"></a>               <span class="cf">function</span>(topicprob)</span>
<span id="cb611-6"><a href="bayesian-topic-model.html#cb611-6" aria-hidden="true" tabindex="-1"></a>                 topicprob[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">log</span>(topicprob[<span class="dv">1</span>] <span class="sc">/</span> topicprob[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb611-7"><a href="bayesian-topic-model.html#cb611-7" aria-hidden="true" tabindex="-1"></a>                 topicprob[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(topicprob[<span class="dv">2</span>] <span class="sc">/</span> topicprob[<span class="dv">1</span>])))</span></code></pre></div>
<pre><code>[1] 5.964141</code></pre>
<p>Let’s create a function to work on theta to produce Kullback-Liebler or Jensen-Shannon divergence.</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="bayesian-topic-model.html#cb613-1" aria-hidden="true" tabindex="-1"></a>divergence <span class="ot">&lt;-</span> <span class="cf">function</span>(input, <span class="at">method =</span> <span class="st">&#39;KL&#39;</span>) {</span>
<span id="cb613-2"><a href="bayesian-topic-model.html#cb613-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (method <span class="sc">==</span> <span class="st">&#39;KL&#39;</span>) {</span>
<span id="cb613-3"><a href="bayesian-topic-model.html#cb613-3" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">5</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">apply</span>(fit_tm<span class="sc">$</span>theta[input, ], <span class="dv">2</span>,</span>
<span id="cb613-4"><a href="bayesian-topic-model.html#cb613-4" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(topicprob)</span>
<span id="cb613-5"><a href="bayesian-topic-model.html#cb613-5" aria-hidden="true" tabindex="-1"></a>                     topicprob[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">log2</span>(topicprob[<span class="dv">1</span>] <span class="sc">/</span> topicprob[<span class="dv">2</span>]) <span class="sc">+</span></span>
<span id="cb613-6"><a href="bayesian-topic-model.html#cb613-6" aria-hidden="true" tabindex="-1"></a>                     topicprob[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log2</span>(topicprob[<span class="dv">2</span>] <span class="sc">/</span> topicprob[<span class="dv">1</span>])))</span>
<span id="cb613-7"><a href="bayesian-topic-model.html#cb613-7" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb613-8"><a href="bayesian-topic-model.html#cb613-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb613-9"><a href="bayesian-topic-model.html#cb613-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dv">5</span> <span class="sc">*</span> <span class="fu">sum</span>(<span class="fu">apply</span>(fit_tm<span class="sc">$</span>theta[input, ], <span class="dv">2</span>,</span>
<span id="cb613-10"><a href="bayesian-topic-model.html#cb613-10" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(topicprob)</span>
<span id="cb613-11"><a href="bayesian-topic-model.html#cb613-11" aria-hidden="true" tabindex="-1"></a>                     topicprob[<span class="dv">1</span>] <span class="sc">*</span> <span class="fu">log2</span>(topicprob[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">mean</span>(topicprob)) <span class="sc">+</span></span>
<span id="cb613-12"><a href="bayesian-topic-model.html#cb613-12" aria-hidden="true" tabindex="-1"></a>                     topicprob[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log2</span>(topicprob[<span class="dv">2</span>] <span class="sc">/</span> <span class="fu">mean</span>(topicprob))))</span>
<span id="cb613-13"><a href="bayesian-topic-model.html#cb613-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb613-14"><a href="bayesian-topic-model.html#cb613-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now apply to all pairs of documents.</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="bayesian-topic-model.html#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now do for all</span></span>
<span id="cb614-2"><a href="bayesian-topic-model.html#cb614-2" aria-hidden="true" tabindex="-1"></a>docpairs <span class="ot">=</span> <span class="fu">combn</span>(<span class="dv">1</span><span class="sc">:</span>d, <span class="dv">2</span>)</span>
<span id="cb614-3"><a href="bayesian-topic-model.html#cb614-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-4"><a href="bayesian-topic-model.html#cb614-4" aria-hidden="true" tabindex="-1"></a>kl_divergence <span class="ot">=</span> <span class="fu">apply</span>(docpairs, <span class="dv">2</span>, divergence)</span>
<span id="cb614-5"><a href="bayesian-topic-model.html#cb614-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-6"><a href="bayesian-topic-model.html#cb614-6" aria-hidden="true" tabindex="-1"></a>mat0 <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, d, d)</span>
<span id="cb614-7"><a href="bayesian-topic-model.html#cb614-7" aria-hidden="true" tabindex="-1"></a>mat0[<span class="fu">lower.tri</span>(mat0)] <span class="ot">=</span> kl_divergence</span>
<span id="cb614-8"><a href="bayesian-topic-model.html#cb614-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-9"><a href="bayesian-topic-model.html#cb614-9" aria-hidden="true" tabindex="-1"></a>kl_divergence <span class="ot">=</span> mat0 <span class="sc">+</span> <span class="fu">t</span>(mat0)</span>
<span id="cb614-10"><a href="bayesian-topic-model.html#cb614-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-11"><a href="bayesian-topic-model.html#cb614-11" aria-hidden="true" tabindex="-1"></a><span class="fu">dimnames</span>(kl_divergence) <span class="ot">=</span> <span class="fu">list</span>(<span class="fu">rownames</span>(dtm))</span></code></pre></div>
<p>We can visualizes as follows, red implies documents are more dissimilar.</p>
<div id="htmlwidget-23acfc8df40fd67c2027" style="width:75%;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-23acfc8df40fd67c2027">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"z":[[1,1,1,1,1,1,0.677670623523124,0.504943768530761,0.25,0.292982949201252,0.292982949201252,0.0709745149544398,0.0423864176248927,0,0,0],[1,1,1,1,1,1,0.677670623523124,0.504943768530761,0.25,0.292982949201252,0.292982949201252,0.0709745149544398,0.0423864176248927,0,0,0],[1,1,1,1,1,1,0.677670623523124,0.504943768530761,0.25,0.292982949201252,0.292982949201252,0.0709745149544398,0.0423864176248927,0,0,0],[0.578295076625751,0.578295076625751,0.578295076625751,0.578295076625751,0.578295076625751,0.578295076625751,0.311802825824905,0.194134814896811,0.0603407471253218,0.0795231654694045,0.0795231654694045,0.00246496283903359,0,0.0423864176248927,0.0423864176248927,0.0423864176248927],[0.504943768530761,0.504943768530761,0.504943768530761,0.504943768530761,0.504943768530761,0.504943768530761,0.25823843900074,0.151836566970401,0.0379591417426003,0.0533729362252882,0.0533729362252882,0,0.00246496283903359,0.0709745149544398,0.0709745149544398,0.0709745149544398],[0.209624372843471,0.209624372843471,0.209624372843471,0.209624372843471,0.209624372843471,0.209624372843471,0.0757462832750818,0.025152669304635,0.0013036610223613,0,0,0.0533729362252882,0.0795231654694045,0.292982949201252,0.292982949201252,0.292982949201252],[0.209624372843471,0.209624372843471,0.209624372843471,0.209624372843471,0.209624372843471,0.209624372843471,0.0757462832750818,0.025152669304635,0.0013036610223613,0,0,0.0533729362252882,0.0795231654694045,0.292982949201252,0.292982949201252,0.292982949201252],[0.25,0.25,0.25,0.25,0.25,0.25,0.0974962909774579,0.0379591417426003,0,0.0013036610223613,0.0013036610223613,0.0379591417426003,0.0603407471253218,0.25,0.25,0.25],[0.0709745149544398,0.0709745149544398,0.0709745149544398,0.0709745149544398,0.0709745149544398,0.0709745149544398,0.0126724264393764,0,0.0379591417426003,0.025152669304635,0.025152669304635,0.151836566970401,0.194134814896811,0.504943768530761,0.504943768530761,0.504943768530761],[0.0173219584317917,0.0173219584317917,0.0173219584317917,0.0173219584317917,0.0173219584317917,0.0173219584317917,0,0.0126724264393764,0.0974962909774579,0.0757462832750818,0.0757462832750818,0.25823843900074,0.311802825824905,0.677670623523124,0.677670623523124,0.677670623523124],[0,0,0,0,0,0,0.0173219584317917,0.0709745149544398,0.25,0.209624372843471,0.209624372843471,0.504943768530761,0.578295076625751,1,1,1],[0,0,0,0,0,0,0.0173219584317917,0.0709745149544398,0.25,0.209624372843471,0.209624372843471,0.504943768530761,0.578295076625751,1,1,1],[0,0,0,0,0,0,0.0173219584317917,0.0709745149544398,0.25,0.209624372843471,0.209624372843471,0.504943768530761,0.578295076625751,1,1,1],[0,0,0,0,0,0,0.0173219584317917,0.0709745149544398,0.25,0.209624372843471,0.209624372843471,0.504943768530761,0.578295076625751,1,1,1],[0,0,0,0,0,0,0.0173219584317917,0.0709745149544398,0.25,0.209624372843471,0.209624372843471,0.504943768530761,0.578295076625751,1,1,1],[0,0,0,0,0,0,0.0173219584317917,0.0709745149544398,0.25,0.209624372843471,0.209624372843471,0.504943768530761,0.578295076625751,1,1,1]],"text":[["row: doc16<br>column: 1<br>value: 8.60444","row: doc16<br>column: 2<br>value: 8.60444","row: doc16<br>column: 3<br>value: 8.60444","row: doc16<br>column: 4<br>value: 8.60444","row: doc16<br>column: 5<br>value: 8.60444","row: doc16<br>column: 6<br>value: 8.60444","row: doc16<br>column: 7<br>value: 5.83097","row: doc16<br>column: 8<br>value: 4.34476","row: doc16<br>column: 9<br>value: 2.15111","row: doc16<br>column: 10<br>value: 2.52095","row: doc16<br>column: 11<br>value: 2.52095","row: doc16<br>column: 12<br>value: 0.61070","row: doc16<br>column: 13<br>value: 0.36471","row: doc16<br>column: 14<br>value: 0.00000","row: doc16<br>column: 15<br>value: 0.00000","row: doc16<br>column: 16<br>value: 0.00000"],["row: doc15<br>column: 1<br>value: 8.60444","row: doc15<br>column: 2<br>value: 8.60444","row: doc15<br>column: 3<br>value: 8.60444","row: doc15<br>column: 4<br>value: 8.60444","row: doc15<br>column: 5<br>value: 8.60444","row: doc15<br>column: 6<br>value: 8.60444","row: doc15<br>column: 7<br>value: 5.83097","row: doc15<br>column: 8<br>value: 4.34476","row: doc15<br>column: 9<br>value: 2.15111","row: doc15<br>column: 10<br>value: 2.52095","row: doc15<br>column: 11<br>value: 2.52095","row: doc15<br>column: 12<br>value: 0.61070","row: doc15<br>column: 13<br>value: 0.36471","row: doc15<br>column: 14<br>value: 0.00000","row: doc15<br>column: 15<br>value: 0.00000","row: doc15<br>column: 16<br>value: 0.00000"],["row: doc14<br>column: 1<br>value: 8.60444","row: doc14<br>column: 2<br>value: 8.60444","row: doc14<br>column: 3<br>value: 8.60444","row: doc14<br>column: 4<br>value: 8.60444","row: doc14<br>column: 5<br>value: 8.60444","row: doc14<br>column: 6<br>value: 8.60444","row: doc14<br>column: 7<br>value: 5.83097","row: doc14<br>column: 8<br>value: 4.34476","row: doc14<br>column: 9<br>value: 2.15111","row: doc14<br>column: 10<br>value: 2.52095","row: doc14<br>column: 11<br>value: 2.52095","row: doc14<br>column: 12<br>value: 0.61070","row: doc14<br>column: 13<br>value: 0.36471","row: doc14<br>column: 14<br>value: 0.00000","row: doc14<br>column: 15<br>value: 0.00000","row: doc14<br>column: 16<br>value: 0.00000"],["row: doc13<br>column: 1<br>value: 4.97590","row: doc13<br>column: 2<br>value: 4.97590","row: doc13<br>column: 3<br>value: 4.97590","row: doc13<br>column: 4<br>value: 4.97590","row: doc13<br>column: 5<br>value: 4.97590","row: doc13<br>column: 6<br>value: 4.97590","row: doc13<br>column: 7<br>value: 2.68289","row: doc13<br>column: 8<br>value: 1.67042","row: doc13<br>column: 9<br>value: 0.51920","row: doc13<br>column: 10<br>value: 0.68425","row: doc13<br>column: 11<br>value: 0.68425","row: doc13<br>column: 12<br>value: 0.02121","row: doc13<br>column: 13<br>value: 0.00000","row: doc13<br>column: 14<br>value: 0.36471","row: doc13<br>column: 15<br>value: 0.36471","row: doc13<br>column: 16<br>value: 0.36471"],["row: doc12<br>column: 1<br>value: 4.34476","row: doc12<br>column: 2<br>value: 4.34476","row: doc12<br>column: 3<br>value: 4.34476","row: doc12<br>column: 4<br>value: 4.34476","row: doc12<br>column: 5<br>value: 4.34476","row: doc12<br>column: 6<br>value: 4.34476","row: doc12<br>column: 7<br>value: 2.22200","row: doc12<br>column: 8<br>value: 1.30647","row: doc12<br>column: 9<br>value: 0.32662","row: doc12<br>column: 10<br>value: 0.45924","row: doc12<br>column: 11<br>value: 0.45924","row: doc12<br>column: 12<br>value: 0.00000","row: doc12<br>column: 13<br>value: 0.02121","row: doc12<br>column: 14<br>value: 0.61070","row: doc12<br>column: 15<br>value: 0.61070","row: doc12<br>column: 16<br>value: 0.61070"],["row: doc11<br>column: 1<br>value: 1.80370","row: doc11<br>column: 2<br>value: 1.80370","row: doc11<br>column: 3<br>value: 1.80370","row: doc11<br>column: 4<br>value: 1.80370","row: doc11<br>column: 5<br>value: 1.80370","row: doc11<br>column: 6<br>value: 1.80370","row: doc11<br>column: 7<br>value: 0.65175","row: doc11<br>column: 8<br>value: 0.21642","row: doc11<br>column: 9<br>value: 0.01122","row: doc11<br>column: 10<br>value: 0.00000","row: doc11<br>column: 11<br>value: 0.00000","row: doc11<br>column: 12<br>value: 0.45924","row: doc11<br>column: 13<br>value: 0.68425","row: doc11<br>column: 14<br>value: 2.52095","row: doc11<br>column: 15<br>value: 2.52095","row: doc11<br>column: 16<br>value: 2.52095"],["row: doc10<br>column: 1<br>value: 1.80370","row: doc10<br>column: 2<br>value: 1.80370","row: doc10<br>column: 3<br>value: 1.80370","row: doc10<br>column: 4<br>value: 1.80370","row: doc10<br>column: 5<br>value: 1.80370","row: doc10<br>column: 6<br>value: 1.80370","row: doc10<br>column: 7<br>value: 0.65175","row: doc10<br>column: 8<br>value: 0.21642","row: doc10<br>column: 9<br>value: 0.01122","row: doc10<br>column: 10<br>value: 0.00000","row: doc10<br>column: 11<br>value: 0.00000","row: doc10<br>column: 12<br>value: 0.45924","row: doc10<br>column: 13<br>value: 0.68425","row: doc10<br>column: 14<br>value: 2.52095","row: doc10<br>column: 15<br>value: 2.52095","row: doc10<br>column: 16<br>value: 2.52095"],["row: doc9<br>column: 1<br>value: 2.15111","row: doc9<br>column: 2<br>value: 2.15111","row: doc9<br>column: 3<br>value: 2.15111","row: doc9<br>column: 4<br>value: 2.15111","row: doc9<br>column: 5<br>value: 2.15111","row: doc9<br>column: 6<br>value: 2.15111","row: doc9<br>column: 7<br>value: 0.83890","row: doc9<br>column: 8<br>value: 0.32662","row: doc9<br>column: 9<br>value: 0.00000","row: doc9<br>column: 10<br>value: 0.01122","row: doc9<br>column: 11<br>value: 0.01122","row: doc9<br>column: 12<br>value: 0.32662","row: doc9<br>column: 13<br>value: 0.51920","row: doc9<br>column: 14<br>value: 2.15111","row: doc9<br>column: 15<br>value: 2.15111","row: doc9<br>column: 16<br>value: 2.15111"],["row: doc8<br>column: 1<br>value: 0.61070","row: doc8<br>column: 2<br>value: 0.61070","row: doc8<br>column: 3<br>value: 0.61070","row: doc8<br>column: 4<br>value: 0.61070","row: doc8<br>column: 5<br>value: 0.61070","row: doc8<br>column: 6<br>value: 0.61070","row: doc8<br>column: 7<br>value: 0.10904","row: doc8<br>column: 8<br>value: 0.00000","row: doc8<br>column: 9<br>value: 0.32662","row: doc8<br>column: 10<br>value: 0.21642","row: doc8<br>column: 11<br>value: 0.21642","row: doc8<br>column: 12<br>value: 1.30647","row: doc8<br>column: 13<br>value: 1.67042","row: doc8<br>column: 14<br>value: 4.34476","row: doc8<br>column: 15<br>value: 4.34476","row: doc8<br>column: 16<br>value: 4.34476"],["row: doc7<br>column: 1<br>value: 0.14905","row: doc7<br>column: 2<br>value: 0.14905","row: doc7<br>column: 3<br>value: 0.14905","row: doc7<br>column: 4<br>value: 0.14905","row: doc7<br>column: 5<br>value: 0.14905","row: doc7<br>column: 6<br>value: 0.14905","row: doc7<br>column: 7<br>value: 0.00000","row: doc7<br>column: 8<br>value: 0.10904","row: doc7<br>column: 9<br>value: 0.83890","row: doc7<br>column: 10<br>value: 0.65175","row: doc7<br>column: 11<br>value: 0.65175","row: doc7<br>column: 12<br>value: 2.22200","row: doc7<br>column: 13<br>value: 2.68289","row: doc7<br>column: 14<br>value: 5.83097","row: doc7<br>column: 15<br>value: 5.83097","row: doc7<br>column: 16<br>value: 5.83097"],["row: doc6<br>column: 1<br>value: 0.00000","row: doc6<br>column: 2<br>value: 0.00000","row: doc6<br>column: 3<br>value: 0.00000","row: doc6<br>column: 4<br>value: 0.00000","row: doc6<br>column: 5<br>value: 0.00000","row: doc6<br>column: 6<br>value: 0.00000","row: doc6<br>column: 7<br>value: 0.14905","row: doc6<br>column: 8<br>value: 0.61070","row: doc6<br>column: 9<br>value: 2.15111","row: doc6<br>column: 10<br>value: 1.80370","row: doc6<br>column: 11<br>value: 1.80370","row: doc6<br>column: 12<br>value: 4.34476","row: doc6<br>column: 13<br>value: 4.97590","row: doc6<br>column: 14<br>value: 8.60444","row: doc6<br>column: 15<br>value: 8.60444","row: doc6<br>column: 16<br>value: 8.60444"],["row: doc5<br>column: 1<br>value: 0.00000","row: doc5<br>column: 2<br>value: 0.00000","row: doc5<br>column: 3<br>value: 0.00000","row: doc5<br>column: 4<br>value: 0.00000","row: doc5<br>column: 5<br>value: 0.00000","row: doc5<br>column: 6<br>value: 0.00000","row: doc5<br>column: 7<br>value: 0.14905","row: doc5<br>column: 8<br>value: 0.61070","row: doc5<br>column: 9<br>value: 2.15111","row: doc5<br>column: 10<br>value: 1.80370","row: doc5<br>column: 11<br>value: 1.80370","row: doc5<br>column: 12<br>value: 4.34476","row: doc5<br>column: 13<br>value: 4.97590","row: doc5<br>column: 14<br>value: 8.60444","row: doc5<br>column: 15<br>value: 8.60444","row: doc5<br>column: 16<br>value: 8.60444"],["row: doc4<br>column: 1<br>value: 0.00000","row: doc4<br>column: 2<br>value: 0.00000","row: doc4<br>column: 3<br>value: 0.00000","row: doc4<br>column: 4<br>value: 0.00000","row: doc4<br>column: 5<br>value: 0.00000","row: doc4<br>column: 6<br>value: 0.00000","row: doc4<br>column: 7<br>value: 0.14905","row: doc4<br>column: 8<br>value: 0.61070","row: doc4<br>column: 9<br>value: 2.15111","row: doc4<br>column: 10<br>value: 1.80370","row: doc4<br>column: 11<br>value: 1.80370","row: doc4<br>column: 12<br>value: 4.34476","row: doc4<br>column: 13<br>value: 4.97590","row: doc4<br>column: 14<br>value: 8.60444","row: doc4<br>column: 15<br>value: 8.60444","row: doc4<br>column: 16<br>value: 8.60444"],["row: doc3<br>column: 1<br>value: 0.00000","row: doc3<br>column: 2<br>value: 0.00000","row: doc3<br>column: 3<br>value: 0.00000","row: doc3<br>column: 4<br>value: 0.00000","row: doc3<br>column: 5<br>value: 0.00000","row: doc3<br>column: 6<br>value: 0.00000","row: doc3<br>column: 7<br>value: 0.14905","row: doc3<br>column: 8<br>value: 0.61070","row: doc3<br>column: 9<br>value: 2.15111","row: doc3<br>column: 10<br>value: 1.80370","row: doc3<br>column: 11<br>value: 1.80370","row: doc3<br>column: 12<br>value: 4.34476","row: doc3<br>column: 13<br>value: 4.97590","row: doc3<br>column: 14<br>value: 8.60444","row: doc3<br>column: 15<br>value: 8.60444","row: doc3<br>column: 16<br>value: 8.60444"],["row: doc2<br>column: 1<br>value: 0.00000","row: doc2<br>column: 2<br>value: 0.00000","row: doc2<br>column: 3<br>value: 0.00000","row: doc2<br>column: 4<br>value: 0.00000","row: doc2<br>column: 5<br>value: 0.00000","row: doc2<br>column: 6<br>value: 0.00000","row: doc2<br>column: 7<br>value: 0.14905","row: doc2<br>column: 8<br>value: 0.61070","row: doc2<br>column: 9<br>value: 2.15111","row: doc2<br>column: 10<br>value: 1.80370","row: doc2<br>column: 11<br>value: 1.80370","row: doc2<br>column: 12<br>value: 4.34476","row: doc2<br>column: 13<br>value: 4.97590","row: doc2<br>column: 14<br>value: 8.60444","row: doc2<br>column: 15<br>value: 8.60444","row: doc2<br>column: 16<br>value: 8.60444"],["row: doc1<br>column: 1<br>value: 0.00000","row: doc1<br>column: 2<br>value: 0.00000","row: doc1<br>column: 3<br>value: 0.00000","row: doc1<br>column: 4<br>value: 0.00000","row: doc1<br>column: 5<br>value: 0.00000","row: doc1<br>column: 6<br>value: 0.00000","row: doc1<br>column: 7<br>value: 0.14905","row: doc1<br>column: 8<br>value: 0.61070","row: doc1<br>column: 9<br>value: 2.15111","row: doc1<br>column: 10<br>value: 1.80370","row: doc1<br>column: 11<br>value: 1.80370","row: doc1<br>column: 12<br>value: 4.34476","row: doc1<br>column: 13<br>value: 4.97590","row: doc1<br>column: 14<br>value: 8.60444","row: doc1<br>column: 15<br>value: 8.60444","row: doc1<br>column: 16<br>value: 8.60444"]],"colorscale":[[0,"#3B4CC0"],[0.0013036610223613,"#3B4DC1"],[0.00246496283903359,"#3C4DC1"],[0.0126724264393764,"#3E51C5"],[0.0173219584317917,"#3F54C7"],[0.025152669304635,"#4257CA"],[0.0379591417426003,"#465DCF"],[0.0423864176248927,"#485FD1"],[0.0533729362252882,"#4B64D5"],[0.0603407471253218,"#4D67D7"],[0.0709745149544398,"#506BDA"],[0.0757462832750818,"#526EDC"],[0.0795231654694045,"#536FDD"],[0.0974962909774579,"#5977E3"],[0.151836566970401,"#6B8DF0"],[0.194134814896811,"#7A9DF8"],[0.209624372843471,"#7FA2FA"],[0.25,"#8DB0FE"],[0.25823843900074,"#90B2FE"],[0.292982949201252,"#9CBDFF"],[0.311802825824905,"#A3C2FE"],[0.504943768530761,"#DEDCDB"],[0.578295076625751,"#EED0C0"],[0.677670623523124,"#F7B497"],[1,"#B40426"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_42d5079b43b0d87511f2cf5e51aa1068","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#3B4CC0"],[0.00334448160535117,"#3C4EC2"],[0.00668896321070234,"#3D4FC3"],[0.0100334448160535,"#3E51C4"],[0.0133779264214047,"#3E52C6"],[0.0167224080267559,"#3F54C7"],[0.020066889632107,"#4055C8"],[0.0234113712374582,"#4257CA"],[0.0267558528428094,"#4358CB"],[0.0301003344481605,"#4459CC"],[0.0334448160535117,"#455BCD"],[0.0367892976588629,"#455DCE"],[0.040133779264214,"#465ECF"],[0.0434782608695652,"#485FD1"],[0.0468227424749164,"#4961D2"],[0.0501672240802676,"#4A63D4"],[0.0535117056856187,"#4B64D5"],[0.0568561872909699,"#4C65D5"],[0.0602006688963211,"#4D67D7"],[0.0635451505016722,"#4E68D8"],[0.0668896321070234,"#4F6AD9"],[0.0702341137123746,"#506BDA"],[0.0735785953177258,"#516DDB"],[0.0769230769230769,"#526EDC"],[0.0802675585284281,"#536FDD"],[0.0836120401337793,"#5471DE"],[0.0869565217391304,"#5572DF"],[0.0903010033444816,"#5674E0"],[0.0936454849498328,"#5875E2"],[0.0969899665551839,"#5976E3"],[0.100334448160535,"#5A78E4"],[0.103678929765886,"#5A79E4"],[0.107023411371237,"#5C7BE5"],[0.110367892976589,"#5D7CE6"],[0.11371237458194,"#5E7DE7"],[0.117056856187291,"#5F7FE8"],[0.120401337792642,"#6080E9"],[0.123745819397993,"#6282EA"],[0.127090301003344,"#6283EA"],[0.130434782608696,"#6484EB"],[0.133779264214047,"#6585EC"],[0.137123745819398,"#6687ED"],[0.140468227424749,"#6788EE"],[0.1438127090301,"#6889EF"],[0.147157190635452,"#698BF0"],[0.150501672240803,"#6A8CF0"],[0.153846153846154,"#6B8DF0"],[0.157190635451505,"#6C8FF1"],[0.160535117056856,"#6E90F2"],[0.163879598662207,"#6F92F3"],[0.167224080267559,"#7093F4"],[0.17056856187291,"#7194F4"],[0.173913043478261,"#7295F4"],[0.177257525083612,"#7396F5"],[0.180602006688963,"#7598F6"],[0.183946488294314,"#7699F6"],[0.187290969899666,"#779AF7"],[0.190635451505017,"#789BF8"],[0.193979933110368,"#799CF8"],[0.197324414715719,"#7A9EF8"],[0.20066889632107,"#7B9FF9"],[0.204013377926421,"#7DA0F9"],[0.207357859531773,"#7EA2FA"],[0.210702341137124,"#7FA3FA"],[0.214046822742475,"#81A4FB"],[0.217391304347826,"#81A5FB"],[0.220735785953177,"#83A6FB"],[0.224080267558528,"#84A7FC"],[0.22742474916388,"#85A8FC"],[0.230769230769231,"#86AAFC"],[0.234113712374582,"#87ABFD"],[0.237458193979933,"#89ACFD"],[0.240802675585284,"#8AACFD"],[0.244147157190635,"#8BAEFD"],[0.247491638795987,"#8CAFFE"],[0.250836120401338,"#8DB0FE"],[0.254180602006689,"#8FB1FE"],[0.25752508361204,"#90B2FE"],[0.260869565217391,"#91B3FE"],[0.264214046822742,"#92B4FE"],[0.267558528428094,"#93B5FF"],[0.270903010033445,"#94B6FF"],[0.274247491638796,"#96B7FF"],[0.277591973244147,"#97B8FF"],[0.280936454849498,"#98B9FF"],[0.284280936454849,"#99BAFF"],[0.287625418060201,"#9ABBFF"],[0.290969899665552,"#9BBCFF"],[0.294314381270903,"#9DBDFF"],[0.297658862876254,"#9EBEFF"],[0.301003344481605,"#9FBFFF"],[0.304347826086956,"#A0C0FF"],[0.307692307692308,"#A1C0FF"],[0.311036789297659,"#A2C1FF"],[0.31438127090301,"#A3C2FE"],[0.317725752508361,"#A5C3FE"],[0.321070234113712,"#A6C4FE"],[0.324414715719064,"#A7C5FE"],[0.327759197324415,"#A9C6FE"],[0.331103678929766,"#A9C6FE"],[0.334448160535117,"#ABC7FD"],[0.337792642140468,"#ACC8FD"],[0.341137123745819,"#ADC9FD"],[0.344481605351171,"#AEC9FC"],[0.347826086956522,"#AFCAFC"],[0.351170568561873,"#B1CBFC"],[0.354515050167224,"#B1CBFC"],[0.357859531772575,"#B2CCFB"],[0.361204013377926,"#B3CDFB"],[0.364548494983278,"#B5CEFA"],[0.367892976588629,"#B6CEFA"],[0.37123745819398,"#B7CFF9"],[0.374581939799331,"#B8D0F9"],[0.377926421404682,"#B9D0F9"],[0.381270903010033,"#BAD1F8"],[0.384615384615385,"#BBD1F8"],[0.387959866220736,"#BCD2F7"],[0.391304347826087,"#BED3F6"],[0.394648829431438,"#BFD3F6"],[0.397993311036789,"#BFD3F6"],[0.40133779264214,"#C0D4F5"],[0.404682274247492,"#C1D4F4"],[0.408026755852843,"#C3D5F4"],[0.411371237458194,"#C4D6F3"],[0.414715719063545,"#C5D6F2"],[0.418060200668896,"#C6D7F1"],[0.421404682274247,"#C7D7F1"],[0.424749163879599,"#C8D7F1"],[0.42809364548495,"#C9D8F0"],[0.431438127090301,"#CAD8EF"],[0.434782608695652,"#CBD8EE"],[0.438127090301003,"#CCD9ED"],[0.441471571906355,"#CDD9EC"],[0.444816053511706,"#CDD9EC"],[0.448160535117057,"#CFDAEB"],[0.451505016722408,"#D0DAEA"],[0.454849498327759,"#D1DAE9"],[0.45819397993311,"#D2DBE8"],[0.461538461538462,"#D3DBE7"],[0.464882943143813,"#D4DBE6"],[0.468227424749164,"#D4DBE6"],[0.471571906354515,"#D5DBE5"],[0.474916387959866,"#D6DCE4"],[0.478260869565217,"#D7DCE3"],[0.481605351170569,"#D8DCE2"],[0.48494983277592,"#D9DCE1"],[0.488294314381271,"#DADCE0"],[0.491638795986622,"#DADCDF"],[0.494983277591973,"#DBDDDE"],[0.498327759197324,"#DCDDDD"],[0.501672240802676,"#DDDCDC"],[0.505016722408027,"#DEDCDB"],[0.508361204013378,"#DFDBDA"],[0.511705685618729,"#DFDBD9"],[0.51505016722408,"#E1DBD7"],[0.518394648829431,"#E2DAD6"],[0.521739130434783,"#E3DAD5"],[0.525083612040134,"#E4D9D3"],[0.528428093645485,"#E4D9D2"],[0.531772575250836,"#E5D8D1"],[0.535117056856187,"#E5D8D0"],[0.538461538461538,"#E6D8CF"],[0.54180602006689,"#E7D7CE"],[0.545150501672241,"#E8D6CC"],[0.548494983277592,"#E9D6CB"],[0.551839464882943,"#EAD5CA"],[0.555183946488294,"#EBD4C8"],[0.558528428093646,"#EBD4C7"],[0.561872909698997,"#EBD3C6"],[0.565217391304348,"#ECD3C5"],[0.568561872909699,"#EDD2C3"],[0.57190635451505,"#EED1C2"],[0.575250836120401,"#EED0C1"],[0.578595317725752,"#EFCFBF"],[0.581939799331104,"#EFCFBE"],[0.585284280936455,"#EFCEBD"],[0.588628762541806,"#F0CEBC"],[0.591973244147157,"#F1CDBA"],[0.595317725752508,"#F1CCB8"],[0.59866220735786,"#F2CBB7"],[0.602006688963211,"#F2CAB6"],[0.605351170568562,"#F2CAB5"],[0.608695652173913,"#F3C9B4"],[0.612040133779264,"#F3C8B2"],[0.615384615384615,"#F4C7B1"],[0.618729096989967,"#F4C6AF"],[0.622073578595318,"#F4C5AE"],[0.625418060200669,"#F4C5AD"],[0.62876254180602,"#F5C4AB"],[0.632107023411371,"#F5C3AA"],[0.635451505016722,"#F5C1A9"],[0.638795986622074,"#F6C0A7"],[0.642140468227425,"#F6BFA6"],[0.645484949832776,"#F6BEA5"],[0.648829431438127,"#F6BEA3"],[0.652173913043478,"#F6BDA2"],[0.655518394648829,"#F7BCA1"],[0.658862876254181,"#F7BA9F"],[0.662207357859532,"#F7B99E"],[0.665551839464883,"#F7B89D"],[0.668896321070234,"#F7B79B"],[0.672240802675585,"#F7B69A"],[0.675585284280936,"#F7B598"],[0.678929765886288,"#F7B497"],[0.682274247491639,"#F7B396"],[0.68561872909699,"#F7B194"],[0.688963210702341,"#F7B093"],[0.692307692307692,"#F7AF92"],[0.695652173913043,"#F7AE91"],[0.698996655518395,"#F7AD90"],[0.702341137123746,"#F7AC8E"],[0.705685618729097,"#F7AB8C"],[0.709030100334448,"#F7A98B"],[0.712374581939799,"#F7A88A"],[0.71571906354515,"#F7A788"],[0.719063545150502,"#F7A687"],[0.722408026755853,"#F6A586"],[0.725752508361204,"#F6A385"],[0.729096989966555,"#F6A283"],[0.732441471571906,"#F6A081"],[0.735785953177257,"#F59F80"],[0.739130434782609,"#F59E7F"],[0.74247491638796,"#F59D7E"],[0.745819397993311,"#F59C7D"],[0.749163879598662,"#F49A7B"],[0.752508361204013,"#F4997A"],[0.755852842809365,"#F49879"],[0.759197324414716,"#F39677"],[0.762541806020067,"#F39576"],[0.765886287625418,"#F39375"],[0.769230769230769,"#F29274"],[0.77257525083612,"#F29072"],[0.775919732441471,"#F18F71"],[0.779264214046823,"#F18E70"],[0.782608695652174,"#F08C6E"],[0.785953177257525,"#F08B6D"],[0.789297658862876,"#F0896C"],[0.792642140468227,"#EF886B"],[0.795986622073579,"#EE8669"],[0.79933110367893,"#EE8568"],[0.802675585284281,"#ED8467"],[0.806020066889632,"#EC8265"],[0.809364548494983,"#EC8064"],[0.812709030100334,"#EC7F63"],[0.816053511705686,"#EB7D62"],[0.819397993311037,"#EA7C60"],[0.822742474916388,"#EA7A5F"],[0.826086956521739,"#E9795E"],[0.82943143812709,"#E8775C"],[0.832775919732441,"#E8755C"],[0.836120401337793,"#E7745B"],[0.839464882943144,"#E67259"],[0.842809364548495,"#E57058"],[0.846153846153846,"#E56F56"],[0.849498327759197,"#E46E55"],[0.852842809364549,"#E46C55"],[0.8561872909699,"#E36A53"],[0.859531772575251,"#E26952"],[0.862876254180602,"#E16751"],[0.866220735785953,"#E0654F"],[0.869565217391304,"#DF644E"],[0.872909698996655,"#DE624D"],[0.876254180602007,"#DE604C"],[0.879598662207358,"#DD5E4B"],[0.882943143812709,"#DC5D4A"],[0.88628762541806,"#DB5B49"],[0.889632107023411,"#DA5947"],[0.892976588628763,"#D95746"],[0.896321070234114,"#D75545"],[0.899665551839465,"#D75345"],[0.903010033444816,"#D65143"],[0.906354515050167,"#D55042"],[0.909698996655518,"#D44E41"],[0.91304347826087,"#D34C40"],[0.916387959866221,"#D24A3F"],[0.919732441471572,"#D0483D"],[0.923076923076923,"#D0463D"],[0.926421404682274,"#CF453C"],[0.929765886287625,"#CE433B"],[0.933110367892977,"#CC4039"],[0.936454849498328,"#CB3E38"],[0.939799331103679,"#CA3C37"],[0.94314381270903,"#C93A36"],[0.946488294314381,"#C83836"],[0.949832775919732,"#C73635"],[0.953177257525084,"#C63434"],[0.956521739130435,"#C43132"],[0.959866220735786,"#C32F31"],[0.963210702341137,"#C22C30"],[0.966555183946488,"#C12A30"],[0.969899665551839,"#C0272F"],[0.973244147157191,"#BF242E"],[0.976588628762542,"#BD222D"],[0.979933110367893,"#BC1E2C"],[0.983277591973244,"#BB1B2B"],[0.986622073578595,"#B9182A"],[0.989966555183946,"#B81429"],[0.993311036789298,"#B70F28"],[0.996655518394649,"#B60A27"],[1,"#B40426"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0","2","4","6","8"],"tickvals":[0,0.232438238020418,0.464876476040836,0.697314714061255,0.929752952081673],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,16.5],"tickmode":"array","ticktext":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"categoryorder":"array","categoryarray":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,16.5],"tickmode":"array","ticktext":["doc16","doc15","doc14","doc13","doc12","doc11","doc10","doc9","doc8","doc7","doc6","doc5","doc4","doc3","doc2","doc1"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"categoryorder":"array","categoryarray":["doc16","doc15","doc14","doc13","doc12","doc11","doc10","doc9","doc8","doc7","doc6","doc5","doc4","doc3","doc2","doc1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":30,"r":null,"b":15.9402241594022,"l":39.8505603985056},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Kullback-Liebler Divergence"},"attrs":{"15f1b69d2c8a3":{"fill":{},"text":{},"x":{},"y":{},"type":"heatmap"}},"source":"A","config":{"doubleClick":"reset","showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Likewise, we can visualize <a href="https://en.wikipedia.org/wiki/Jensen%E2%80%93Shannon_divergence">Jensen-Shannon divergence</a>.</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="bayesian-topic-model.html#cb615-1" aria-hidden="true" tabindex="-1"></a>js_divergence <span class="ot">=</span> <span class="fu">apply</span>(docpairs, <span class="dv">2</span>, divergence, <span class="at">method =</span> <span class="st">&#39;JS&#39;</span>)</span></code></pre></div>
<div id="htmlwidget-a709d8c7d17cf4080686" style="width:75%;height:504px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a709d8c7d17cf4080686">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"y":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"z":[[1,1,1,1,1,1,0.832692346532229,0.628218028335077,0.308434394826434,0.360714791264063,0.360714791264063,0.0955468191301317,0.0603083989636501,0,0,0],[1,1,1,1,1,1,0.832692346532229,0.628218028335077,0.308434394826434,0.360714791264063,0.360714791264063,0.0955468191301317,0.0603083989636501,0,0,0],[1,1,1,1,1,1,0.832692346532229,0.628218028335077,0.308434394826434,0.360714791264063,0.360714791264063,0.0955468191301317,0.0603083989636501,0,0,0],[0.719943818736704,0.719943818736704,0.719943818736704,0.719943818736704,0.719943818736704,0.719943818736704,0.56411240450865,0.382680851994968,0.125866623523924,0.164417399085115,0.164417399085115,0.00540856573027638,0,0.0603083989636501,0.0603083989636501,0.0603083989636501],[0.628218028335077,0.628218028335077,0.628218028335077,0.628218028335077,0.628218028335077,0.628218028335077,0.478203867259373,0.308248553985407,0.0813834984815395,0.113591931219153,0.113591931219153,0,0.00540856573027638,0.0955468191301317,0.0955468191301317,0.0955468191301317],[0.260009195655116,0.260009195655116,0.260009195655116,0.260009195655116,0.260009195655116,0.260009195655116,0.149728343952677,0.0543089621600647,0.00287463664570212,0,0,0.113591931219153,0.164417399085115,0.360714791264063,0.360714791264063,0.360714791264063],[0.260009195655116,0.260009195655116,0.260009195655116,0.260009195655116,0.260009195655116,0.260009195655116,0.149728343952677,0.0543089621600647,0.00287463664570212,0,0,0.113591931219153,0.164417399085115,0.360714791264063,0.360714791264063,0.360714791264063],[0.308434394826434,0.308434394826434,0.308434394826434,0.308434394826434,0.308434394826434,0.308434394826434,0.19053250115059,0.0813834984815395,0,0.00287463664570212,0.00287463664570212,0.0813834984815395,0.125866623523924,0.308434394826434,0.308434394826434,0.308434394826434],[0.0955468191301317,0.0955468191301317,0.0955468191301317,0.0955468191301317,0.0955468191301317,0.0955468191301317,0.0268399905462473,0,0.0813834984815395,0.0543089621600647,0.0543089621600647,0.308248553985407,0.382680851994968,0.628218028335077,0.628218028335077,0.628218028335077],[0.0273148316369981,0.0273148316369981,0.0273148316369981,0.0273148316369981,0.0273148316369981,0.0273148316369981,0,0.0268399905462473,0.19053250115059,0.149728343952677,0.149728343952677,0.478203867259373,0.56411240450865,0.832692346532229,0.832692346532229,0.832692346532229],[0,0,0,0,0,0,0.0273148316369981,0.0955468191301317,0.308434394826434,0.260009195655116,0.260009195655116,0.628218028335077,0.719943818736704,1,1,1],[0,0,0,0,0,0,0.0273148316369981,0.0955468191301317,0.308434394826434,0.260009195655116,0.260009195655116,0.628218028335077,0.719943818736704,1,1,1],[0,0,0,0,0,0,0.0273148316369981,0.0955468191301317,0.308434394826434,0.260009195655116,0.260009195655116,0.628218028335077,0.719943818736704,1,1,1],[0,0,0,0,0,0,0.0273148316369981,0.0955468191301317,0.308434394826434,0.260009195655116,0.260009195655116,0.628218028335077,0.719943818736704,1,1,1],[0,0,0,0,0,0,0.0273148316369981,0.0955468191301317,0.308434394826434,0.260009195655116,0.260009195655116,0.628218028335077,0.719943818736704,1,1,1],[0,0,0,0,0,0,0.0273148316369981,0.0955468191301317,0.308434394826434,0.260009195655116,0.260009195655116,0.628218028335077,0.719943818736704,1,1,1]],"text":[["row: doc16<br>column: 1<br>value: 0.974896","row: doc16<br>column: 2<br>value: 0.974896","row: doc16<br>column: 3<br>value: 0.974896","row: doc16<br>column: 4<br>value: 0.974896","row: doc16<br>column: 5<br>value: 0.974896","row: doc16<br>column: 6<br>value: 0.974896","row: doc16<br>column: 7<br>value: 0.811788","row: doc16<br>column: 8<br>value: 0.612447","row: doc16<br>column: 9<br>value: 0.300691","row: doc16<br>column: 10<br>value: 0.351659","row: doc16<br>column: 11<br>value: 0.351659","row: doc16<br>column: 12<br>value: 0.093148","row: doc16<br>column: 13<br>value: 0.058794","row: doc16<br>column: 14<br>value: 0.000000","row: doc16<br>column: 15<br>value: 0.000000","row: doc16<br>column: 16<br>value: 0.000000"],["row: doc15<br>column: 1<br>value: 0.974896","row: doc15<br>column: 2<br>value: 0.974896","row: doc15<br>column: 3<br>value: 0.974896","row: doc15<br>column: 4<br>value: 0.974896","row: doc15<br>column: 5<br>value: 0.974896","row: doc15<br>column: 6<br>value: 0.974896","row: doc15<br>column: 7<br>value: 0.811788","row: doc15<br>column: 8<br>value: 0.612447","row: doc15<br>column: 9<br>value: 0.300691","row: doc15<br>column: 10<br>value: 0.351659","row: doc15<br>column: 11<br>value: 0.351659","row: doc15<br>column: 12<br>value: 0.093148","row: doc15<br>column: 13<br>value: 0.058794","row: doc15<br>column: 14<br>value: 0.000000","row: doc15<br>column: 15<br>value: 0.000000","row: doc15<br>column: 16<br>value: 0.000000"],["row: doc14<br>column: 1<br>value: 0.974896","row: doc14<br>column: 2<br>value: 0.974896","row: doc14<br>column: 3<br>value: 0.974896","row: doc14<br>column: 4<br>value: 0.974896","row: doc14<br>column: 5<br>value: 0.974896","row: doc14<br>column: 6<br>value: 0.974896","row: doc14<br>column: 7<br>value: 0.811788","row: doc14<br>column: 8<br>value: 0.612447","row: doc14<br>column: 9<br>value: 0.300691","row: doc14<br>column: 10<br>value: 0.351659","row: doc14<br>column: 11<br>value: 0.351659","row: doc14<br>column: 12<br>value: 0.093148","row: doc14<br>column: 13<br>value: 0.058794","row: doc14<br>column: 14<br>value: 0.000000","row: doc14<br>column: 15<br>value: 0.000000","row: doc14<br>column: 16<br>value: 0.000000"],["row: doc13<br>column: 1<br>value: 0.701870","row: doc13<br>column: 2<br>value: 0.701870","row: doc13<br>column: 3<br>value: 0.701870","row: doc13<br>column: 4<br>value: 0.701870","row: doc13<br>column: 5<br>value: 0.701870","row: doc13<br>column: 6<br>value: 0.701870","row: doc13<br>column: 7<br>value: 0.549951","row: doc13<br>column: 8<br>value: 0.373074","row: doc13<br>column: 9<br>value: 0.122707","row: doc13<br>column: 10<br>value: 0.160290","row: doc13<br>column: 11<br>value: 0.160290","row: doc13<br>column: 12<br>value: 0.005273","row: doc13<br>column: 13<br>value: 0.000000","row: doc13<br>column: 14<br>value: 0.058794","row: doc13<br>column: 15<br>value: 0.058794","row: doc13<br>column: 16<br>value: 0.058794"],["row: doc12<br>column: 1<br>value: 0.612447","row: doc12<br>column: 2<br>value: 0.612447","row: doc12<br>column: 3<br>value: 0.612447","row: doc12<br>column: 4<br>value: 0.612447","row: doc12<br>column: 5<br>value: 0.612447","row: doc12<br>column: 6<br>value: 0.612447","row: doc12<br>column: 7<br>value: 0.466199","row: doc12<br>column: 8<br>value: 0.300510","row: doc12<br>column: 9<br>value: 0.079340","row: doc12<br>column: 10<br>value: 0.110740","row: doc12<br>column: 11<br>value: 0.110740","row: doc12<br>column: 12<br>value: 0.000000","row: doc12<br>column: 13<br>value: 0.005273","row: doc12<br>column: 14<br>value: 0.093148","row: doc12<br>column: 15<br>value: 0.093148","row: doc12<br>column: 16<br>value: 0.093148"],["row: doc11<br>column: 1<br>value: 0.253482","row: doc11<br>column: 2<br>value: 0.253482","row: doc11<br>column: 3<br>value: 0.253482","row: doc11<br>column: 4<br>value: 0.253482","row: doc11<br>column: 5<br>value: 0.253482","row: doc11<br>column: 6<br>value: 0.253482","row: doc11<br>column: 7<br>value: 0.145970","row: doc11<br>column: 8<br>value: 0.052946","row: doc11<br>column: 9<br>value: 0.002802","row: doc11<br>column: 10<br>value: 0.000000","row: doc11<br>column: 11<br>value: 0.000000","row: doc11<br>column: 12<br>value: 0.110740","row: doc11<br>column: 13<br>value: 0.160290","row: doc11<br>column: 14<br>value: 0.351659","row: doc11<br>column: 15<br>value: 0.351659","row: doc11<br>column: 16<br>value: 0.351659"],["row: doc10<br>column: 1<br>value: 0.253482","row: doc10<br>column: 2<br>value: 0.253482","row: doc10<br>column: 3<br>value: 0.253482","row: doc10<br>column: 4<br>value: 0.253482","row: doc10<br>column: 5<br>value: 0.253482","row: doc10<br>column: 6<br>value: 0.253482","row: doc10<br>column: 7<br>value: 0.145970","row: doc10<br>column: 8<br>value: 0.052946","row: doc10<br>column: 9<br>value: 0.002802","row: doc10<br>column: 10<br>value: 0.000000","row: doc10<br>column: 11<br>value: 0.000000","row: doc10<br>column: 12<br>value: 0.110740","row: doc10<br>column: 13<br>value: 0.160290","row: doc10<br>column: 14<br>value: 0.351659","row: doc10<br>column: 15<br>value: 0.351659","row: doc10<br>column: 16<br>value: 0.351659"],["row: doc9<br>column: 1<br>value: 0.300691","row: doc9<br>column: 2<br>value: 0.300691","row: doc9<br>column: 3<br>value: 0.300691","row: doc9<br>column: 4<br>value: 0.300691","row: doc9<br>column: 5<br>value: 0.300691","row: doc9<br>column: 6<br>value: 0.300691","row: doc9<br>column: 7<br>value: 0.185749","row: doc9<br>column: 8<br>value: 0.079340","row: doc9<br>column: 9<br>value: 0.000000","row: doc9<br>column: 10<br>value: 0.002802","row: doc9<br>column: 11<br>value: 0.002802","row: doc9<br>column: 12<br>value: 0.079340","row: doc9<br>column: 13<br>value: 0.122707","row: doc9<br>column: 14<br>value: 0.300691","row: doc9<br>column: 15<br>value: 0.300691","row: doc9<br>column: 16<br>value: 0.300691"],["row: doc8<br>column: 1<br>value: 0.093148","row: doc8<br>column: 2<br>value: 0.093148","row: doc8<br>column: 3<br>value: 0.093148","row: doc8<br>column: 4<br>value: 0.093148","row: doc8<br>column: 5<br>value: 0.093148","row: doc8<br>column: 6<br>value: 0.093148","row: doc8<br>column: 7<br>value: 0.026166","row: doc8<br>column: 8<br>value: 0.000000","row: doc8<br>column: 9<br>value: 0.079340","row: doc8<br>column: 10<br>value: 0.052946","row: doc8<br>column: 11<br>value: 0.052946","row: doc8<br>column: 12<br>value: 0.300510","row: doc8<br>column: 13<br>value: 0.373074","row: doc8<br>column: 14<br>value: 0.612447","row: doc8<br>column: 15<br>value: 0.612447","row: doc8<br>column: 16<br>value: 0.612447"],["row: doc7<br>column: 1<br>value: 0.026629","row: doc7<br>column: 2<br>value: 0.026629","row: doc7<br>column: 3<br>value: 0.026629","row: doc7<br>column: 4<br>value: 0.026629","row: doc7<br>column: 5<br>value: 0.026629","row: doc7<br>column: 6<br>value: 0.026629","row: doc7<br>column: 7<br>value: 0.000000","row: doc7<br>column: 8<br>value: 0.026166","row: doc7<br>column: 9<br>value: 0.185749","row: doc7<br>column: 10<br>value: 0.145970","row: doc7<br>column: 11<br>value: 0.145970","row: doc7<br>column: 12<br>value: 0.466199","row: doc7<br>column: 13<br>value: 0.549951","row: doc7<br>column: 14<br>value: 0.811788","row: doc7<br>column: 15<br>value: 0.811788","row: doc7<br>column: 16<br>value: 0.811788"],["row: doc6<br>column: 1<br>value: 0.000000","row: doc6<br>column: 2<br>value: 0.000000","row: doc6<br>column: 3<br>value: 0.000000","row: doc6<br>column: 4<br>value: 0.000000","row: doc6<br>column: 5<br>value: 0.000000","row: doc6<br>column: 6<br>value: 0.000000","row: doc6<br>column: 7<br>value: 0.026629","row: doc6<br>column: 8<br>value: 0.093148","row: doc6<br>column: 9<br>value: 0.300691","row: doc6<br>column: 10<br>value: 0.253482","row: doc6<br>column: 11<br>value: 0.253482","row: doc6<br>column: 12<br>value: 0.612447","row: doc6<br>column: 13<br>value: 0.701870","row: doc6<br>column: 14<br>value: 0.974896","row: doc6<br>column: 15<br>value: 0.974896","row: doc6<br>column: 16<br>value: 0.974896"],["row: doc5<br>column: 1<br>value: 0.000000","row: doc5<br>column: 2<br>value: 0.000000","row: doc5<br>column: 3<br>value: 0.000000","row: doc5<br>column: 4<br>value: 0.000000","row: doc5<br>column: 5<br>value: 0.000000","row: doc5<br>column: 6<br>value: 0.000000","row: doc5<br>column: 7<br>value: 0.026629","row: doc5<br>column: 8<br>value: 0.093148","row: doc5<br>column: 9<br>value: 0.300691","row: doc5<br>column: 10<br>value: 0.253482","row: doc5<br>column: 11<br>value: 0.253482","row: doc5<br>column: 12<br>value: 0.612447","row: doc5<br>column: 13<br>value: 0.701870","row: doc5<br>column: 14<br>value: 0.974896","row: doc5<br>column: 15<br>value: 0.974896","row: doc5<br>column: 16<br>value: 0.974896"],["row: doc4<br>column: 1<br>value: 0.000000","row: doc4<br>column: 2<br>value: 0.000000","row: doc4<br>column: 3<br>value: 0.000000","row: doc4<br>column: 4<br>value: 0.000000","row: doc4<br>column: 5<br>value: 0.000000","row: doc4<br>column: 6<br>value: 0.000000","row: doc4<br>column: 7<br>value: 0.026629","row: doc4<br>column: 8<br>value: 0.093148","row: doc4<br>column: 9<br>value: 0.300691","row: doc4<br>column: 10<br>value: 0.253482","row: doc4<br>column: 11<br>value: 0.253482","row: doc4<br>column: 12<br>value: 0.612447","row: doc4<br>column: 13<br>value: 0.701870","row: doc4<br>column: 14<br>value: 0.974896","row: doc4<br>column: 15<br>value: 0.974896","row: doc4<br>column: 16<br>value: 0.974896"],["row: doc3<br>column: 1<br>value: 0.000000","row: doc3<br>column: 2<br>value: 0.000000","row: doc3<br>column: 3<br>value: 0.000000","row: doc3<br>column: 4<br>value: 0.000000","row: doc3<br>column: 5<br>value: 0.000000","row: doc3<br>column: 6<br>value: 0.000000","row: doc3<br>column: 7<br>value: 0.026629","row: doc3<br>column: 8<br>value: 0.093148","row: doc3<br>column: 9<br>value: 0.300691","row: doc3<br>column: 10<br>value: 0.253482","row: doc3<br>column: 11<br>value: 0.253482","row: doc3<br>column: 12<br>value: 0.612447","row: doc3<br>column: 13<br>value: 0.701870","row: doc3<br>column: 14<br>value: 0.974896","row: doc3<br>column: 15<br>value: 0.974896","row: doc3<br>column: 16<br>value: 0.974896"],["row: doc2<br>column: 1<br>value: 0.000000","row: doc2<br>column: 2<br>value: 0.000000","row: doc2<br>column: 3<br>value: 0.000000","row: doc2<br>column: 4<br>value: 0.000000","row: doc2<br>column: 5<br>value: 0.000000","row: doc2<br>column: 6<br>value: 0.000000","row: doc2<br>column: 7<br>value: 0.026629","row: doc2<br>column: 8<br>value: 0.093148","row: doc2<br>column: 9<br>value: 0.300691","row: doc2<br>column: 10<br>value: 0.253482","row: doc2<br>column: 11<br>value: 0.253482","row: doc2<br>column: 12<br>value: 0.612447","row: doc2<br>column: 13<br>value: 0.701870","row: doc2<br>column: 14<br>value: 0.974896","row: doc2<br>column: 15<br>value: 0.974896","row: doc2<br>column: 16<br>value: 0.974896"],["row: doc1<br>column: 1<br>value: 0.000000","row: doc1<br>column: 2<br>value: 0.000000","row: doc1<br>column: 3<br>value: 0.000000","row: doc1<br>column: 4<br>value: 0.000000","row: doc1<br>column: 5<br>value: 0.000000","row: doc1<br>column: 6<br>value: 0.000000","row: doc1<br>column: 7<br>value: 0.026629","row: doc1<br>column: 8<br>value: 0.093148","row: doc1<br>column: 9<br>value: 0.300691","row: doc1<br>column: 10<br>value: 0.253482","row: doc1<br>column: 11<br>value: 0.253482","row: doc1<br>column: 12<br>value: 0.612447","row: doc1<br>column: 13<br>value: 0.701870","row: doc1<br>column: 14<br>value: 0.974896","row: doc1<br>column: 15<br>value: 0.974896","row: doc1<br>column: 16<br>value: 0.974896"]],"colorscale":[[0,"#3B4CC0"],[0.00287463664570212,"#3C4DC1"],[0.00540856573027638,"#3C4FC2"],[0.0268399905462473,"#4358CB"],[0.0273148316369981,"#4358CB"],[0.0543089621600647,"#4B64D5"],[0.0603083989636501,"#4D67D7"],[0.0813834984815395,"#5470DE"],[0.0955468191301317,"#5876E2"],[0.113591931219153,"#5E7DE7"],[0.125866623523924,"#6282EA"],[0.149728343952677,"#6A8CF0"],[0.164417399085115,"#6F92F3"],[0.19053250115059,"#789BF8"],[0.260009195655116,"#91B3FE"],[0.308248553985407,"#A2C1FF"],[0.308434394826434,"#A2C1FF"],[0.360714791264063,"#B3CDFB"],[0.382680851994968,"#BBD1F8"],[0.478203867259373,"#D7DCE3"],[0.56411240450865,"#ECD3C5"],[0.628218028335077,"#F5C4AC"],[0.719943818736704,"#F6A587"],[0.832692346532229,"#E8755C"],[1,"#B40426"]],"type":"heatmap","showscale":false,"autocolorscale":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[1],"name":"99_fa4e24b399e5e9d553c2c2787e02d1f9","type":"scatter","mode":"markers","opacity":0,"hoverinfo":"skip","showlegend":false,"marker":{"color":[0,1],"colorscale":[[0,"#3B4CC0"],[0.00334448160535117,"#3C4EC2"],[0.00668896321070234,"#3D4FC3"],[0.0100334448160535,"#3E51C4"],[0.0133779264214047,"#3E52C6"],[0.0167224080267559,"#3F54C7"],[0.020066889632107,"#4055C8"],[0.0234113712374582,"#4257CA"],[0.0267558528428094,"#4358CB"],[0.0301003344481605,"#4459CC"],[0.0334448160535117,"#455BCD"],[0.0367892976588629,"#455DCE"],[0.040133779264214,"#465ECF"],[0.0434782608695652,"#485FD1"],[0.0468227424749164,"#4961D2"],[0.0501672240802676,"#4A63D4"],[0.0535117056856187,"#4B64D5"],[0.0568561872909699,"#4C65D5"],[0.0602006688963211,"#4D67D7"],[0.0635451505016722,"#4E68D8"],[0.0668896321070234,"#4F6AD9"],[0.0702341137123746,"#506BDA"],[0.0735785953177258,"#516DDB"],[0.0769230769230769,"#526EDC"],[0.0802675585284281,"#536FDD"],[0.0836120401337793,"#5471DE"],[0.0869565217391304,"#5572DF"],[0.0903010033444816,"#5674E0"],[0.0936454849498328,"#5875E2"],[0.096989966555184,"#5976E3"],[0.100334448160535,"#5A78E4"],[0.103678929765886,"#5A79E4"],[0.107023411371237,"#5C7BE5"],[0.110367892976589,"#5D7CE6"],[0.11371237458194,"#5E7DE7"],[0.117056856187291,"#5F7FE8"],[0.120401337792642,"#6080E9"],[0.123745819397993,"#6282EA"],[0.127090301003344,"#6283EA"],[0.130434782608696,"#6484EB"],[0.133779264214047,"#6585EC"],[0.137123745819398,"#6687ED"],[0.140468227424749,"#6788EE"],[0.1438127090301,"#6889EF"],[0.147157190635452,"#698BF0"],[0.150501672240803,"#6A8CF0"],[0.153846153846154,"#6B8DF0"],[0.157190635451505,"#6C8FF1"],[0.160535117056856,"#6E90F2"],[0.163879598662207,"#6F92F3"],[0.167224080267559,"#7093F4"],[0.17056856187291,"#7194F4"],[0.173913043478261,"#7295F4"],[0.177257525083612,"#7396F5"],[0.180602006688963,"#7598F6"],[0.183946488294314,"#7699F6"],[0.187290969899666,"#779AF7"],[0.190635451505017,"#789BF8"],[0.193979933110368,"#799CF8"],[0.197324414715719,"#7A9EF8"],[0.20066889632107,"#7B9FF9"],[0.204013377926421,"#7DA0F9"],[0.207357859531773,"#7EA2FA"],[0.210702341137124,"#7FA3FA"],[0.214046822742475,"#81A4FB"],[0.217391304347826,"#81A5FB"],[0.220735785953177,"#83A6FB"],[0.224080267558528,"#84A7FC"],[0.22742474916388,"#85A8FC"],[0.230769230769231,"#86AAFC"],[0.234113712374582,"#87ABFD"],[0.237458193979933,"#89ACFD"],[0.240802675585284,"#8AACFD"],[0.244147157190635,"#8BAEFD"],[0.247491638795987,"#8CAFFE"],[0.250836120401338,"#8DB0FE"],[0.254180602006689,"#8FB1FE"],[0.25752508361204,"#90B2FE"],[0.260869565217391,"#91B3FE"],[0.264214046822743,"#92B4FE"],[0.267558528428094,"#93B5FF"],[0.270903010033445,"#94B6FF"],[0.274247491638796,"#96B7FF"],[0.277591973244147,"#97B8FF"],[0.280936454849498,"#98B9FF"],[0.28428093645485,"#99BAFF"],[0.287625418060201,"#9ABBFF"],[0.290969899665552,"#9BBCFF"],[0.294314381270903,"#9DBDFF"],[0.297658862876254,"#9EBEFF"],[0.301003344481605,"#9FBFFF"],[0.304347826086956,"#A0C0FF"],[0.307692307692308,"#A1C0FF"],[0.311036789297659,"#A2C1FF"],[0.31438127090301,"#A3C2FE"],[0.317725752508361,"#A5C3FE"],[0.321070234113712,"#A6C4FE"],[0.324414715719064,"#A7C5FE"],[0.327759197324415,"#A9C6FE"],[0.331103678929766,"#A9C6FE"],[0.334448160535117,"#ABC7FD"],[0.337792642140468,"#ACC8FD"],[0.341137123745819,"#ADC9FD"],[0.344481605351171,"#AEC9FC"],[0.347826086956522,"#AFCAFC"],[0.351170568561873,"#B1CBFC"],[0.354515050167224,"#B1CBFC"],[0.357859531772575,"#B2CCFB"],[0.361204013377926,"#B3CDFB"],[0.364548494983278,"#B5CEFA"],[0.367892976588629,"#B6CEFA"],[0.37123745819398,"#B7CFF9"],[0.374581939799331,"#B8D0F9"],[0.377926421404682,"#B9D0F9"],[0.381270903010033,"#BAD1F8"],[0.384615384615385,"#BBD1F8"],[0.387959866220736,"#BCD2F7"],[0.391304347826087,"#BED3F6"],[0.394648829431438,"#BFD3F6"],[0.397993311036789,"#BFD3F6"],[0.401337792642141,"#C0D4F5"],[0.404682274247492,"#C1D4F4"],[0.408026755852843,"#C3D5F4"],[0.411371237458194,"#C4D6F3"],[0.414715719063545,"#C5D6F2"],[0.418060200668896,"#C6D7F1"],[0.421404682274248,"#C7D7F1"],[0.424749163879599,"#C8D7F1"],[0.42809364548495,"#C9D8F0"],[0.431438127090301,"#CAD8EF"],[0.434782608695652,"#CBD8EE"],[0.438127090301003,"#CCD9ED"],[0.441471571906354,"#CDD9EC"],[0.444816053511706,"#CDD9EC"],[0.448160535117057,"#CFDAEB"],[0.451505016722408,"#D0DAEA"],[0.454849498327759,"#D1DAE9"],[0.45819397993311,"#D2DBE8"],[0.461538461538462,"#D3DBE7"],[0.464882943143813,"#D4DBE6"],[0.468227424749164,"#D4DBE6"],[0.471571906354515,"#D5DBE5"],[0.474916387959866,"#D6DCE4"],[0.478260869565217,"#D7DCE3"],[0.481605351170569,"#D8DCE2"],[0.48494983277592,"#D9DCE1"],[0.488294314381271,"#DADCE0"],[0.491638795986622,"#DADCDF"],[0.494983277591973,"#DBDDDE"],[0.498327759197324,"#DCDDDD"],[0.501672240802676,"#DDDCDC"],[0.505016722408027,"#DEDCDB"],[0.508361204013378,"#DFDBDA"],[0.511705685618729,"#DFDBD9"],[0.51505016722408,"#E1DBD7"],[0.518394648829431,"#E2DAD6"],[0.521739130434783,"#E3DAD5"],[0.525083612040134,"#E4D9D3"],[0.528428093645485,"#E4D9D2"],[0.531772575250836,"#E5D8D1"],[0.535117056856187,"#E5D8D0"],[0.538461538461538,"#E6D8CF"],[0.54180602006689,"#E7D7CE"],[0.545150501672241,"#E8D6CC"],[0.548494983277592,"#E9D6CB"],[0.551839464882943,"#EAD5CA"],[0.555183946488294,"#EBD4C8"],[0.558528428093646,"#EBD4C7"],[0.561872909698997,"#EBD3C6"],[0.565217391304348,"#ECD3C5"],[0.568561872909699,"#EDD2C3"],[0.57190635451505,"#EED1C2"],[0.575250836120401,"#EED0C1"],[0.578595317725752,"#EFCFBF"],[0.581939799331104,"#EFCFBE"],[0.585284280936455,"#EFCEBD"],[0.588628762541806,"#F0CEBC"],[0.591973244147157,"#F1CDBA"],[0.595317725752508,"#F1CCB8"],[0.59866220735786,"#F2CBB7"],[0.602006688963211,"#F2CAB6"],[0.605351170568562,"#F2CAB5"],[0.608695652173913,"#F3C9B4"],[0.612040133779264,"#F3C8B2"],[0.615384615384615,"#F4C7B1"],[0.618729096989967,"#F4C6AF"],[0.622073578595318,"#F4C5AE"],[0.625418060200669,"#F4C5AD"],[0.62876254180602,"#F5C4AB"],[0.632107023411371,"#F5C3AA"],[0.635451505016722,"#F5C1A9"],[0.638795986622074,"#F6C0A7"],[0.642140468227425,"#F6BFA6"],[0.645484949832776,"#F6BEA5"],[0.648829431438127,"#F6BEA3"],[0.652173913043478,"#F6BDA2"],[0.655518394648829,"#F7BCA1"],[0.658862876254181,"#F7BA9F"],[0.662207357859532,"#F7B99E"],[0.665551839464883,"#F7B89D"],[0.668896321070234,"#F7B79B"],[0.672240802675585,"#F7B69A"],[0.675585284280936,"#F7B598"],[0.678929765886288,"#F7B497"],[0.682274247491639,"#F7B396"],[0.68561872909699,"#F7B194"],[0.688963210702341,"#F7B093"],[0.692307692307692,"#F7AF92"],[0.695652173913044,"#F7AE91"],[0.698996655518395,"#F7AD90"],[0.702341137123746,"#F7AC8E"],[0.705685618729097,"#F7AB8C"],[0.709030100334448,"#F7A98B"],[0.712374581939799,"#F7A88A"],[0.71571906354515,"#F7A788"],[0.719063545150502,"#F7A687"],[0.722408026755853,"#F6A586"],[0.725752508361204,"#F6A385"],[0.729096989966555,"#F6A283"],[0.732441471571906,"#F6A081"],[0.735785953177258,"#F59F80"],[0.739130434782609,"#F59E7F"],[0.74247491638796,"#F59D7E"],[0.745819397993311,"#F59C7D"],[0.749163879598662,"#F49A7B"],[0.752508361204013,"#F4997A"],[0.755852842809365,"#F49879"],[0.759197324414716,"#F39677"],[0.762541806020067,"#F39576"],[0.765886287625418,"#F39375"],[0.769230769230769,"#F29274"],[0.77257525083612,"#F29072"],[0.775919732441472,"#F18F71"],[0.779264214046823,"#F18E70"],[0.782608695652174,"#F08C6E"],[0.785953177257525,"#F08B6D"],[0.789297658862876,"#F0896C"],[0.792642140468227,"#EF886B"],[0.795986622073579,"#EE8669"],[0.79933110367893,"#EE8568"],[0.802675585284281,"#ED8467"],[0.806020066889632,"#EC8265"],[0.809364548494983,"#EC8064"],[0.812709030100334,"#EC7F63"],[0.816053511705686,"#EB7D62"],[0.819397993311037,"#EA7C60"],[0.822742474916388,"#EA7A5F"],[0.826086956521739,"#E9795E"],[0.82943143812709,"#E8775C"],[0.832775919732442,"#E8755C"],[0.836120401337793,"#E7745B"],[0.839464882943144,"#E67259"],[0.842809364548495,"#E57058"],[0.846153846153846,"#E56F56"],[0.849498327759197,"#E46E55"],[0.852842809364548,"#E46C55"],[0.8561872909699,"#E36A53"],[0.859531772575251,"#E26952"],[0.862876254180602,"#E16751"],[0.866220735785953,"#E0654F"],[0.869565217391304,"#DF644E"],[0.872909698996656,"#DE624D"],[0.876254180602007,"#DE604C"],[0.879598662207358,"#DD5E4B"],[0.882943143812709,"#DC5D4A"],[0.88628762541806,"#DB5B49"],[0.889632107023411,"#DA5947"],[0.892976588628763,"#D95746"],[0.896321070234114,"#D75545"],[0.899665551839465,"#D75345"],[0.903010033444816,"#D65143"],[0.906354515050167,"#D55042"],[0.909698996655518,"#D44E41"],[0.91304347826087,"#D34C40"],[0.916387959866221,"#D24A3F"],[0.919732441471572,"#D0483D"],[0.923076923076923,"#D0463D"],[0.926421404682274,"#CF453C"],[0.929765886287625,"#CE433B"],[0.933110367892977,"#CC4039"],[0.936454849498328,"#CB3E38"],[0.939799331103679,"#CA3C37"],[0.94314381270903,"#C93A36"],[0.946488294314381,"#C83836"],[0.949832775919732,"#C73635"],[0.953177257525084,"#C63434"],[0.956521739130435,"#C43132"],[0.959866220735786,"#C32F31"],[0.963210702341137,"#C22C30"],[0.966555183946488,"#C12A30"],[0.969899665551839,"#C0272F"],[0.973244147157191,"#BF242E"],[0.976588628762542,"#BD222D"],[0.979933110367893,"#BC1E2C"],[0.983277591973244,"#BB1B2B"],[0.986622073578595,"#B9182A"],[0.989966555183946,"#B81429"],[0.993311036789298,"#B70F28"],[0.996655518394649,"#B60A27"],[1,"#B40426"]],"colorbar":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"thickness":23.04,"title":null,"titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"tickmode":"array","ticktext":["0.00","0.25","0.50","0.75"],"tickvals":[0,0.256437703223549,0.512875406447097,0.769313109670646],"tickfont":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"ticklen":2,"len":0.5}},"xaxis":"x","yaxis":"y","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,16.5],"tickmode":"array","ticktext":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"categoryorder":"array","categoryarray":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-45,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"","hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.5,16.5],"tickmode":"array","ticktext":["doc16","doc15","doc14","doc13","doc12","doc11","doc10","doc9","doc8","doc7","doc6","doc5","doc4","doc3","doc2","doc1"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],"categoryorder":"array","categoryarray":["doc16","doc15","doc14","doc13","doc12","doc11","doc10","doc9","doc8","doc7","doc6","doc5","doc4","doc3","doc2","doc1"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":13.2835201328352},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","hoverformat":".2f"},"annotations":[],"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"images":[],"margin":{"t":30,"r":null,"b":15.9402241594022,"l":39.8505603985056},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"y":1,"yanchor":"top"},"hovermode":"closest","barmode":"relative","title":"Jensen-Shannon Divergence"},"attrs":{"15f1b619c1bb2":{"fill":{},"text":{},"x":{},"y":{},"type":"heatmap"}},"source":"A","config":{"doubleClick":"reset","showSendToCloud":false,"displaylogo":false,"modeBarButtonsToRemove":["sendDataToCloud","select2d","lasso2d","autoScale2d","hoverClosestCartesian","hoverCompareCartesian","sendDataToCloud"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Here are examples of diagnostics with the word topic probability estimates. These use the <span style="">bayesplot</span> package.</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="bayesian-topic-model.html#cb616-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb616-2"><a href="bayesian-topic-model.html#cb616-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-3"><a href="bayesian-topic-model.html#cb616-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_combo</span>(phi_estimates_topic_1)</span></code></pre></div>
<p><img src="model-demos_files/figure-html/tm-bayes-diagnostics-1.svg" width="75%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="bayesian-topic-model.html#cb617-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_acf</span>(phi_estimates_topic_1)</span></code></pre></div>
<p><img src="model-demos_files/figure-html/tm-bayes-diagnostics-2.svg" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="source-36" class="section level2">
<h2>Source</h2>
<p>Original code available at:
<a href="https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/Bayesian/topicModelgibbs.R" class="uri">https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/Bayesian/topicModelgibbs.R</a></p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="bayesian-variational.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="maximum-likelihood.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/bayesian-topic-model.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
