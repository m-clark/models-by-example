<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Bayesian Multilevel Mediation | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Bayesian Multilevel Mediation | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian Multilevel Mediation | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/nineteeneightyR.png" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="bayesian-mixed-model.html"/>
<link rel="next" href="bayesian-irt.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-one-factor.html"><a href="mixed-model-one-factor.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-model-two-factor.html"><a href="mixed-model-two-factor.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#maximum-likelihood-estimation"><i class="fa fa-check"></i>Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#issues-with-ml-estimation"><i class="fa fa-check"></i>Issues with ML estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-model-ML.html"><a href="mixed-model-ML.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gausian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html"><i class="fa fa-check"></i>Neural Net</a>
<ul>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#example-3"><i class="fa fa-check"></i>Example 3</a>
<ul>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#python-2"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#r-2"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-net.html"><a href="neural-net.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-22"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-26"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-27"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#functions-9"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="lasso.html"><a href="lasso.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ridge.html"><a href="ridge.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-11"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-44"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-26"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-49"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-29"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-52"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-55"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-13"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-56"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-52"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-multilevel-mediation" class="section level1">
<h1>Bayesian Multilevel Mediation</h1>
<p>The following demonstrates an indirect effect in a multilevel situation. It is
based on Yuan &amp; MacKinnon 2009, which provides some Bugs code. In what follows
we essentially have two models, one where the ‘mediator’ is the response; the
other regards the primary response of interest (noted <code>y</code>). They will be referred
to with Med or Main respectively.</p>
<div id="data-setup-28" class="section level2">
<h2>Data Setup</h2>
<p>The two main models are expressed conceptually as follows:</p>
<p><span class="math display">\[\textrm{Mediator} \sim \alpha_{Med} + \beta_{Med}\cdot X\]</span>
<span class="math display">\[y \sim \alpha_{Main} + \beta_{1\_{Main}}\cdot X + \beta_{2\_{Main}}\cdot \textrm{Mediator}\]</span></p>
<p>However, there will be random effects for a grouping variable for each coefficient, i.e. random intercepts and slopes, for both the mediator model and the outcome model.</p>
<p>Let’s create data to this effect.</p>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="bayesian-mixed-mediation.html#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb496-2"><a href="bayesian-mixed-mediation.html#cb496-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-3"><a href="bayesian-mixed-mediation.html#cb496-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">8675309</span>)</span>
<span id="cb496-4"><a href="bayesian-mixed-mediation.html#cb496-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-5"><a href="bayesian-mixed-mediation.html#cb496-5" aria-hidden="true" tabindex="-1"></a><span class="co"># random effects for mediator model</span></span>
<span id="cb496-6"><a href="bayesian-mixed-mediation.html#cb496-6" aria-hidden="true" tabindex="-1"></a><span class="co"># create cov matrix of RE etc. with no covariance between model random effects</span></span>
<span id="cb496-7"><a href="bayesian-mixed-mediation.html#cb496-7" aria-hidden="true" tabindex="-1"></a><span class="co"># covmat_RE = matrix(c(1,-.15,0,0,0,</span></span>
<span id="cb496-8"><a href="bayesian-mixed-mediation.html#cb496-8" aria-hidden="true" tabindex="-1"></a><span class="co">#                       -.15,.4,0,0,0,</span></span>
<span id="cb496-9"><a href="bayesian-mixed-mediation.html#cb496-9" aria-hidden="true" tabindex="-1"></a><span class="co">#                       0,0,1,-.1,.15,</span></span>
<span id="cb496-10"><a href="bayesian-mixed-mediation.html#cb496-10" aria-hidden="true" tabindex="-1"></a><span class="co">#                       0,0,-.1,.3,0,</span></span>
<span id="cb496-11"><a href="bayesian-mixed-mediation.html#cb496-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                       0,0,.15,0,.2), nrow=5, byrow = T)</span></span>
<span id="cb496-12"><a href="bayesian-mixed-mediation.html#cb496-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-13"><a href="bayesian-mixed-mediation.html#cb496-13" aria-hidden="true" tabindex="-1"></a><span class="co"># or with slight cov added to indirect coefficient RE; both matrices are pos def</span></span>
<span id="cb496-14"><a href="bayesian-mixed-mediation.html#cb496-14" aria-hidden="true" tabindex="-1"></a>covmat_RE <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="fl">1.00</span>, <span class="sc">-</span><span class="fl">0.15</span>,  <span class="fl">0.00</span>,  <span class="fl">0.00</span>,  <span class="fl">0.00</span>,</span>
<span id="cb496-15"><a href="bayesian-mixed-mediation.html#cb496-15" aria-hidden="true" tabindex="-1"></a>                     <span class="sc">-</span><span class="fl">0.15</span>,  <span class="fl">0.64</span>,  <span class="fl">0.00</span>,  <span class="fl">0.00</span>, <span class="sc">-</span><span class="fl">0.10</span>,</span>
<span id="cb496-16"><a href="bayesian-mixed-mediation.html#cb496-16" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.00</span>,  <span class="fl">0.00</span>,  <span class="fl">1.00</span>, <span class="sc">-</span><span class="fl">0.10</span>,  <span class="fl">0.15</span>,</span>
<span id="cb496-17"><a href="bayesian-mixed-mediation.html#cb496-17" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.00</span>,  <span class="fl">0.00</span>, <span class="sc">-</span><span class="fl">0.10</span>,  <span class="fl">0.49</span>,  <span class="fl">0.00</span>,</span>
<span id="cb496-18"><a href="bayesian-mixed-mediation.html#cb496-18" aria-hidden="true" tabindex="-1"></a>                      <span class="fl">0.00</span>, <span class="sc">-</span><span class="fl">0.10</span>,  <span class="fl">0.15</span>,  <span class="fl">0.00</span>,  <span class="fl">0.25</span>), <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb496-19"><a href="bayesian-mixed-mediation.html#cb496-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb496-20"><a href="bayesian-mixed-mediation.html#cb496-20" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect</span></span>
<span id="cb496-21"><a href="bayesian-mixed-mediation.html#cb496-21" aria-hidden="true" tabindex="-1"></a>covmat_RE</span></code></pre></div>
<pre><code>      [,1]  [,2]  [,3]  [,4]  [,5]
[1,]  1.00 -0.15  0.00  0.00  0.00
[2,] -0.15  0.64  0.00  0.00 -0.10
[3,]  0.00  0.00  1.00 -0.10  0.15
[4,]  0.00  0.00 -0.10  0.49  0.00
[5,]  0.00 -0.10  0.15  0.00  0.25</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="bayesian-mixed-mediation.html#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inspect as correlation</span></span>
<span id="cb498-2"><a href="bayesian-mixed-mediation.html#cb498-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cov2cor</span>(covmat_RE)</span></code></pre></div>
<pre><code>        [,1]    [,2]       [,3]       [,4]  [,5]
[1,]  1.0000 -0.1875  0.0000000  0.0000000  0.00
[2,] -0.1875  1.0000  0.0000000  0.0000000 -0.25
[3,]  0.0000  0.0000  1.0000000 -0.1428571  0.30
[4,]  0.0000  0.0000 -0.1428571  1.0000000  0.00
[5,]  0.0000 -0.2500  0.3000000  0.0000000  1.00</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="bayesian-mixed-mediation.html#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simulate</span></span>
<span id="cb500-2"><a href="bayesian-mixed-mediation.html#cb500-2" aria-hidden="true" tabindex="-1"></a>re <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">50</span>,</span>
<span id="cb500-3"><a href="bayesian-mixed-mediation.html#cb500-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">mu    =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">5</span>),</span>
<span id="cb500-4"><a href="bayesian-mixed-mediation.html#cb500-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Sigma =</span> covmat_RE,</span>
<span id="cb500-5"><a href="bayesian-mixed-mediation.html#cb500-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">empirical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb500-6"><a href="bayesian-mixed-mediation.html#cb500-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-7"><a href="bayesian-mixed-mediation.html#cb500-7" aria-hidden="true" tabindex="-1"></a><span class="co"># random effects for mediator model</span></span>
<span id="cb500-8"><a href="bayesian-mixed-mediation.html#cb500-8" aria-hidden="true" tabindex="-1"></a>ranef_alpha_Med <span class="ot">=</span> <span class="fu">rep</span>(re[, <span class="dv">1</span>], <span class="at">e =</span> <span class="dv">10</span>)</span>
<span id="cb500-9"><a href="bayesian-mixed-mediation.html#cb500-9" aria-hidden="true" tabindex="-1"></a>ranef_beta_Med  <span class="ot">=</span> <span class="fu">rep</span>(re[, <span class="dv">2</span>], <span class="at">e =</span> <span class="dv">10</span>)</span>
<span id="cb500-10"><a href="bayesian-mixed-mediation.html#cb500-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-11"><a href="bayesian-mixed-mediation.html#cb500-11" aria-hidden="true" tabindex="-1"></a><span class="co"># random effects for main model                                                 </span></span>
<span id="cb500-12"><a href="bayesian-mixed-mediation.html#cb500-12" aria-hidden="true" tabindex="-1"></a>ranef_alpha_Main <span class="ot">=</span> <span class="fu">rep</span>(re[, <span class="dv">3</span>], <span class="at">e =</span> <span class="dv">10</span>)</span>
<span id="cb500-13"><a href="bayesian-mixed-mediation.html#cb500-13" aria-hidden="true" tabindex="-1"></a>ranef_beta1_Main <span class="ot">=</span> <span class="fu">rep</span>(re[, <span class="dv">4</span>], <span class="at">e =</span> <span class="dv">10</span>)</span>
<span id="cb500-14"><a href="bayesian-mixed-mediation.html#cb500-14" aria-hidden="true" tabindex="-1"></a>ranef_beta2_Main <span class="ot">=</span> <span class="fu">rep</span>(re[, <span class="dv">5</span>], <span class="at">e =</span> <span class="dv">10</span>)</span>
<span id="cb500-15"><a href="bayesian-mixed-mediation.html#cb500-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-16"><a href="bayesian-mixed-mediation.html#cb500-16" aria-hidden="true" tabindex="-1"></a><span class="do">## fixed effects</span></span>
<span id="cb500-17"><a href="bayesian-mixed-mediation.html#cb500-17" aria-hidden="true" tabindex="-1"></a>alpha_Med <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb500-18"><a href="bayesian-mixed-mediation.html#cb500-18" aria-hidden="true" tabindex="-1"></a>beta_Med  <span class="ot">=</span> .<span class="dv">2</span></span>
<span id="cb500-19"><a href="bayesian-mixed-mediation.html#cb500-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-20"><a href="bayesian-mixed-mediation.html#cb500-20" aria-hidden="true" tabindex="-1"></a>alpha_Main <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb500-21"><a href="bayesian-mixed-mediation.html#cb500-21" aria-hidden="true" tabindex="-1"></a>beta1_Main <span class="ot">=</span> .<span class="dv">3</span></span>
<span id="cb500-22"><a href="bayesian-mixed-mediation.html#cb500-22" aria-hidden="true" tabindex="-1"></a>beta2_Main <span class="ot">=</span> <span class="sc">-</span>.<span class="dv">2</span></span>
<span id="cb500-23"><a href="bayesian-mixed-mediation.html#cb500-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-24"><a href="bayesian-mixed-mediation.html#cb500-24" aria-hidden="true" tabindex="-1"></a><span class="co"># residual variance</span></span>
<span id="cb500-25"><a href="bayesian-mixed-mediation.html#cb500-25" aria-hidden="true" tabindex="-1"></a>resid_Med  <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">500</span>, <span class="dv">0</span>, .<span class="dv">75</span><span class="sc">^</span><span class="dv">2</span>, <span class="at">empirical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb500-26"><a href="bayesian-mixed-mediation.html#cb500-26" aria-hidden="true" tabindex="-1"></a>resid_Main <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">500</span>, <span class="dv">0</span>, .<span class="dv">50</span><span class="sc">^</span><span class="dv">2</span>, <span class="at">empirical =</span> <span class="cn">TRUE</span>)</span>
<span id="cb500-27"><a href="bayesian-mixed-mediation.html#cb500-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-28"><a href="bayesian-mixed-mediation.html#cb500-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-29"><a href="bayesian-mixed-mediation.html#cb500-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Collect parameters for later comparison</span></span>
<span id="cb500-30"><a href="bayesian-mixed-mediation.html#cb500-30" aria-hidden="true" tabindex="-1"></a>params <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb500-31"><a href="bayesian-mixed-mediation.html#cb500-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha_Med  =</span> alpha_Med,</span>
<span id="cb500-32"><a href="bayesian-mixed-mediation.html#cb500-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_Med   =</span> beta_Med,</span>
<span id="cb500-33"><a href="bayesian-mixed-mediation.html#cb500-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma_Med  =</span> <span class="fu">sd</span>(resid_Med),</span>
<span id="cb500-34"><a href="bayesian-mixed-mediation.html#cb500-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha_Main =</span> alpha_Main,</span>
<span id="cb500-35"><a href="bayesian-mixed-mediation.html#cb500-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta1_Main =</span> beta1_Main,</span>
<span id="cb500-36"><a href="bayesian-mixed-mediation.html#cb500-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta2_Main =</span> beta2_Main,</span>
<span id="cb500-37"><a href="bayesian-mixed-mediation.html#cb500-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma_y    =</span> <span class="fu">sd</span>(resid_Main),</span>
<span id="cb500-38"><a href="bayesian-mixed-mediation.html#cb500-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha_Med_sd =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(covmat_RE)[<span class="dv">1</span>]),</span>
<span id="cb500-39"><a href="bayesian-mixed-mediation.html#cb500-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta_Med_sd  =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(covmat_RE)[<span class="dv">2</span>]),</span>
<span id="cb500-40"><a href="bayesian-mixed-mediation.html#cb500-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha_sd =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(covmat_RE)[<span class="dv">3</span>]),</span>
<span id="cb500-41"><a href="bayesian-mixed-mediation.html#cb500-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta1_sd =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(covmat_RE)[<span class="dv">4</span>]),</span>
<span id="cb500-42"><a href="bayesian-mixed-mediation.html#cb500-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta2_sd =</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(covmat_RE)[<span class="dv">5</span>])</span>
<span id="cb500-43"><a href="bayesian-mixed-mediation.html#cb500-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb500-44"><a href="bayesian-mixed-mediation.html#cb500-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb500-45"><a href="bayesian-mixed-mediation.html#cb500-45" aria-hidden="true" tabindex="-1"></a>ranefs <span class="ot">=</span>  <span class="fu">cbind</span>(</span>
<span id="cb500-46"><a href="bayesian-mixed-mediation.html#cb500-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma_alpha_Med =</span> <span class="fu">unique</span>(ranef_alpha_Med),</span>
<span id="cb500-47"><a href="bayesian-mixed-mediation.html#cb500-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma_beta_Med  =</span> <span class="fu">unique</span>(ranef_beta_Med),</span>
<span id="cb500-48"><a href="bayesian-mixed-mediation.html#cb500-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma_alpha =</span> <span class="fu">unique</span>(ranef_alpha_Main),</span>
<span id="cb500-49"><a href="bayesian-mixed-mediation.html#cb500-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma_beta1 =</span> <span class="fu">unique</span>(ranef_beta1_Main),</span>
<span id="cb500-50"><a href="bayesian-mixed-mediation.html#cb500-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma_beta2 =</span> <span class="fu">unique</span>(ranef_beta2_Main)</span>
<span id="cb500-51"><a href="bayesian-mixed-mediation.html#cb500-51" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>Finally, we can create the data for analysis.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="bayesian-mixed-mediation.html#cb501-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb501-2"><a href="bayesian-mixed-mediation.html#cb501-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-3"><a href="bayesian-mixed-mediation.html#cb501-3" aria-hidden="true" tabindex="-1"></a>Med <span class="ot">=</span> (alpha_Med <span class="sc">+</span> ranef_alpha_Med) <span class="sc">+</span> (beta_Med <span class="sc">+</span> ranef_beta_Med) <span class="sc">*</span> X <span class="sc">+</span> resid_Med[, <span class="dv">1</span>]</span>
<span id="cb501-4"><a href="bayesian-mixed-mediation.html#cb501-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-5"><a href="bayesian-mixed-mediation.html#cb501-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> (alpha_Main <span class="sc">+</span> ranef_alpha_Main) <span class="sc">+</span> (beta1_Main <span class="sc">+</span> ranef_beta1_Main) <span class="sc">*</span> X <span class="sc">+</span> </span>
<span id="cb501-6"><a href="bayesian-mixed-mediation.html#cb501-6" aria-hidden="true" tabindex="-1"></a>  (beta2_Main <span class="sc">+</span> ranef_beta2_Main) <span class="sc">*</span>  Med <span class="sc">+</span> resid_Main[, <span class="dv">1</span>]</span>
<span id="cb501-7"><a href="bayesian-mixed-mediation.html#cb501-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-8"><a href="bayesian-mixed-mediation.html#cb501-8" aria-hidden="true" tabindex="-1"></a>group <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="at">e =</span> <span class="dv">10</span>)</span>
<span id="cb501-9"><a href="bayesian-mixed-mediation.html#cb501-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-10"><a href="bayesian-mixed-mediation.html#cb501-10" aria-hidden="true" tabindex="-1"></a>standat <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb501-11"><a href="bayesian-mixed-mediation.html#cb501-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">X   =</span> X,</span>
<span id="cb501-12"><a href="bayesian-mixed-mediation.html#cb501-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Med =</span> Med,</span>
<span id="cb501-13"><a href="bayesian-mixed-mediation.html#cb501-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y   =</span> y,</span>
<span id="cb501-14"><a href="bayesian-mixed-mediation.html#cb501-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> group,</span>
<span id="cb501-15"><a href="bayesian-mixed-mediation.html#cb501-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">J =</span> <span class="fu">length</span>(<span class="fu">unique</span>(group)),</span>
<span id="cb501-16"><a href="bayesian-mixed-mediation.html#cb501-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">length</span>(y)</span>
<span id="cb501-17"><a href="bayesian-mixed-mediation.html#cb501-17" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="model-code-4" class="section level2">
<h2>Model Code</h2>
<p>In the following, the cholesky decomposition of the RE covariance matrix is used for efficiency. As a rough guide, the default data where <code>N = 500</code> took about 5 min to run for the main model with <code>iter=12000</code> and <code>warmup = 2000</code>.</p>
<pre class="stan"><code>data {
  int&lt;lower = 1&gt; N;                              // Sample size
  vector[N] X;                                   // Explanatory variable
  vector[N] Med;                                 // Mediator
  vector[N] y;                                   // Response
  int&lt;lower = 1&gt; J;                              // Number of groups
  int&lt;lower = 1,upper = J&gt; Group[N];             // Groups
}

parameters{
  real alpha_Med;                                // mediator model reg parameters and related
  real beta_Med;
  real&lt;lower = 0&gt; sigma_alpha_Med;
  real&lt;lower = 0&gt; sigma_beta_Med;
  real&lt;lower = 0&gt; sigmaMed;

  real alpha_Main;                               // main model reg parameters and related
  real beta1_Main;
  real beta2_Main;
  real&lt;lower = 0&gt; sigma_alpha;
  real&lt;lower = 0&gt; sigma_beta1;
  real&lt;lower = 0&gt; sigma_beta2;
  real&lt;lower = 0&gt; sigma_y;

  cholesky_factor_corr[5] Omega_chol;            // chol decomp of corr matrix for random effects

  vector&lt;lower = 0&gt;[5] sigma_ranef;              // sd for random effects

  matrix[J,5] gamma;                             // random effects
}

transformed parameters{
  vector[J] gamma_alpha_Med;
  vector[J] gamma_beta_Med;

  vector[J] gamma_alpha;
  vector[J] gamma_beta1;
  vector[J] gamma_beta2;

  for (j in 1:J){
    gamma_alpha_Med[j] = gamma[j,1];
    gamma_beta_Med[j]  = gamma[j,2];
    gamma_alpha[j] = gamma[j,3];
    gamma_beta1[j] = gamma[j,4];
    gamma_beta2[j] = gamma[j,5];
  }
}

model {
  vector[N] mu_y;                                // linear predictors for response and mediator
  vector[N] mu_Med;
  matrix[5,5] D;
  matrix[5,5] DC;

  // priors
  // mediator model
  // fixef
  // for scale params the cauchy is a little more informative here due 
  // to the nature of the data
  sigma_alpha_Med ~ cauchy(0, 1);                
  sigma_beta_Med ~ cauchy(0, 1);
  alpha_Med ~ normal(0, sigma_alpha_Med);   
  beta_Med  ~ normal(0, sigma_beta_Med);

  // residual scale
  sigmaMed ~ cauchy(0, 1);

  // main model
  // fixef
  sigma_alpha ~ cauchy(0, 1);
  sigma_beta1 ~ cauchy(0, 1);
  sigma_beta2 ~ cauchy(0, 1);
  alpha_Main ~ normal(0, sigma_alpha);      
  beta1_Main ~ normal(0, sigma_beta1);
  beta2_Main ~ normal(0, sigma_beta2);

  // residual scale
  sigma_y ~ cauchy(0, 1);

  // ranef sampling via cholesky decomposition
  sigma_ranef ~ cauchy(0, 1);
  Omega_chol  ~  lkj_corr_cholesky(2.0);

  D  = diag_matrix(sigma_ranef);
  DC = D * Omega_chol;
  
  for (j in 1:J)                                 // loop for Group random effects
    gamma[j] ~ multi_normal_cholesky(rep_vector(0, 5), DC);

  // Linear predictors
  for (n in 1:N){
    mu_Med[n] = alpha_Med + gamma_alpha_Med[Group[n]] + 
    (beta_Med + gamma_beta_Med[Group[n]]) * X[n];
    
    mu_y[n]   = alpha_Main + gamma_alpha[Group[n]] + 
    (beta1_Main + gamma_beta1[Group[n]]) * X[n] + 
    (beta2_Main + gamma_beta2[Group[n]]) * Med[n] ;
  }
  
  
  // sampling for primary models
  Med ~ normal(mu_Med, sigmaMed);
  y   ~ normal(mu_y, sigma_y);
}

generated quantities{
  real naive_ind_effect;
  real avg_ind_effect;
  real total_effect;
  matrix[5,5] cov_RE;
  vector[N] y_hat;    
  
  cov_RE = diag_matrix(sigma_ranef) * tcrossprod(Omega_chol) * diag_matrix(sigma_ranef);

  naive_ind_effect = beta_Med*beta2_Main;
  avg_ind_effect   = beta_Med*beta2_Main + cov_RE[2,5];
  total_effect     = avg_ind_effect + beta1_Main;
  
  for (n in 1:N){
    y_hat[n]   = alpha_Main + gamma_alpha[Group[n]] + 
    (beta1_Main + gamma_beta1[Group[n]]) * X[n] + 
    (beta2_Main + gamma_beta2[Group[n]]) * Med[n] ;
  }
}</code></pre>
</div>
<div id="estimation-26" class="section level2">
<h2>Estimation</h2>
<p>Run the model and examine results. The following assumes a character string or file (<code>bayes_med_model</code>) of the previous model code.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="bayesian-mixed-mediation.html#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb503-2"><a href="bayesian-mixed-mediation.html#cb503-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb503-3"><a href="bayesian-mixed-mediation.html#cb503-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">sampling</span>(</span>
<span id="cb503-4"><a href="bayesian-mixed-mediation.html#cb503-4" aria-hidden="true" tabindex="-1"></a>  bayes_med_model,</span>
<span id="cb503-5"><a href="bayesian-mixed-mediation.html#cb503-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data    =</span> standat,</span>
<span id="cb503-6"><a href="bayesian-mixed-mediation.html#cb503-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter    =</span> <span class="dv">3000</span>,</span>
<span id="cb503-7"><a href="bayesian-mixed-mediation.html#cb503-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">warmup  =</span> <span class="dv">2000</span>,</span>
<span id="cb503-8"><a href="bayesian-mixed-mediation.html#cb503-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin    =</span> <span class="dv">4</span>,</span>
<span id="cb503-9"><a href="bayesian-mixed-mediation.html#cb503-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores   =</span> <span class="dv">4</span>,</span>
<span id="cb503-10"><a href="bayesian-mixed-mediation.html#cb503-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> .<span class="dv">99</span>, <span class="at">max_treedepth =</span> <span class="dv">15</span>)</span>
<span id="cb503-11"><a href="bayesian-mixed-mediation.html#cb503-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="comparison-31" class="section level2">
<h2>Comparison</h2>
<p>Main parameters include fixed and random effect standard deviation, plus those related to indirect effect.</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="bayesian-mixed-mediation.html#cb504-1" aria-hidden="true" tabindex="-1"></a>mainpars <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb504-2"><a href="bayesian-mixed-mediation.html#cb504-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;alpha_Med&#39;</span>,</span>
<span id="cb504-3"><a href="bayesian-mixed-mediation.html#cb504-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;beta_Med&#39;</span>,</span>
<span id="cb504-4"><a href="bayesian-mixed-mediation.html#cb504-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;sigmaMed&#39;</span>,</span>
<span id="cb504-5"><a href="bayesian-mixed-mediation.html#cb504-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;alpha_Main&#39;</span>,</span>
<span id="cb504-6"><a href="bayesian-mixed-mediation.html#cb504-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;beta1_Main&#39;</span>,</span>
<span id="cb504-7"><a href="bayesian-mixed-mediation.html#cb504-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;beta2_Main&#39;</span>,</span>
<span id="cb504-8"><a href="bayesian-mixed-mediation.html#cb504-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;sigma_y&#39;</span>,</span>
<span id="cb504-9"><a href="bayesian-mixed-mediation.html#cb504-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;sigma_ranef&#39;</span>,</span>
<span id="cb504-10"><a href="bayesian-mixed-mediation.html#cb504-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;naive_ind_effect&#39;</span>,</span>
<span id="cb504-11"><a href="bayesian-mixed-mediation.html#cb504-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;avg_ind_effect&#39;</span>,</span>
<span id="cb504-12"><a href="bayesian-mixed-mediation.html#cb504-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;total_effect&#39;</span></span>
<span id="cb504-13"><a href="bayesian-mixed-mediation.html#cb504-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb504-14"><a href="bayesian-mixed-mediation.html#cb504-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb504-15"><a href="bayesian-mixed-mediation.html#cb504-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(</span>
<span id="cb504-16"><a href="bayesian-mixed-mediation.html#cb504-16" aria-hidden="true" tabindex="-1"></a>  fit,</span>
<span id="cb504-17"><a href="bayesian-mixed-mediation.html#cb504-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span> <span class="dv">3</span>,</span>
<span id="cb504-18"><a href="bayesian-mixed-mediation.html#cb504-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">probs  =</span> <span class="fu">c</span>(.<span class="dv">025</span>, .<span class="dv">5</span>, <span class="fl">0.975</span>),</span>
<span id="cb504-19"><a href="bayesian-mixed-mediation.html#cb504-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars   =</span> mainpars</span>
<span id="cb504-20"><a href="bayesian-mixed-mediation.html#cb504-20" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>Inference for Stan model: 24fc5f9a6f9e73e28a238db856680332.
4 chains, each with iter=3000; warmup=2000; thin=4; 
post-warmup draws per chain=250, total post-warmup draws=1000.

                   mean se_mean    sd   2.5%    50%  97.5% n_eff  Rhat
alpha_Med         2.007   0.009 0.156  1.708  2.008  2.313   324 1.006
beta_Med          0.183   0.009 0.125 -0.030  0.177  0.449   188 1.002
sigmaMed          0.745   0.001 0.028  0.694  0.744  0.801   939 1.003
alpha_Main        0.964   0.008 0.165  0.649  0.964  1.314   456 1.003
beta1_Main        0.268   0.007 0.119  0.026  0.269  0.512   299 1.008
beta2_Main       -0.176   0.004 0.077 -0.317 -0.179 -0.023   436 0.999
sigma_y           0.501   0.001 0.018  0.468  0.501  0.538   758 0.999
sigma_ranef[1]    1.061   0.003 0.120  0.848  1.051  1.324  1188 1.000
sigma_ranef[2]    0.854   0.003 0.087  0.705  0.848  1.047   842 0.998
sigma_ranef[3]    1.003   0.005 0.136  0.767  0.993  1.302   761 0.998
sigma_ranef[4]    0.783   0.003 0.086  0.638  0.777  0.981   775 1.001
sigma_ranef[5]    0.479   0.002 0.065  0.366  0.473  0.611   856 0.997
naive_ind_effect -0.034   0.002 0.030 -0.108 -0.028  0.004   205 1.007
avg_ind_effect   -0.151   0.003 0.075 -0.316 -0.149 -0.013   570 1.006
total_effect      0.117   0.008 0.138 -0.169  0.118  0.391   314 1.007

Samples were drawn using NUTS(diag_e) at Wed Nov 25 17:37:09 2020.
For each parameter, n_eff is a crude measure of effective sample size,
and Rhat is the potential scale reduction factor on split chains (at 
convergence, Rhat=1).</code></pre>
<p>We can use a piecemeal mixed model via <span class="pack">lme4</span> for initial comparison. However, it can’t directly estimate mediated effect, and it won’t pick up on correlation of random effects between models.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="bayesian-mixed-mediation.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb506-2"><a href="bayesian-mixed-mediation.html#cb506-2" aria-hidden="true" tabindex="-1"></a>mod_Med <span class="ot">=</span> <span class="fu">lmer</span>(Med <span class="sc">~</span> X <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> X <span class="sc">|</span> group))</span>
<span id="cb506-3"><a href="bayesian-mixed-mediation.html#cb506-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_Med)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: Med ~ X + (1 + X | group)

REML criterion at convergence: 1456.7

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.55601 -0.66077 -0.00442  0.57621  3.12555 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 group    (Intercept) 1.0315   1.0156        
          X           0.6688   0.8178   -0.27
 Residual             0.5513   0.7425        
Number of obs: 500, groups:  group, 50

Fixed effects:
            Estimate Std. Error t value
(Intercept)   2.0221     0.1480  13.665
X             0.2197     0.1172   1.874

Correlation of Fixed Effects:
  (Intr)
X -0.257</code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="bayesian-mixed-mediation.html#cb508-1" aria-hidden="true" tabindex="-1"></a>mod_Main <span class="ot">=</span> <span class="fu">lmer</span>(y <span class="sc">~</span> X <span class="sc">+</span> Med <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> Med <span class="sc">|</span> group))</span>
<span id="cb508-2"><a href="bayesian-mixed-mediation.html#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_Main)</span></code></pre></div>
<pre><code>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: y ~ X + Med + (1 + X + Med | group)

REML criterion at convergence: 1211.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6843 -0.6232  0.0540  0.5721  2.5242 

Random effects:
 Groups   Name        Variance Std.Dev. Corr       
 group    (Intercept) 0.9208   0.9596              
          X           0.5657   0.7521   -0.19      
          Med         0.2051   0.4529    0.52 -0.03
 Residual             0.2479   0.4979              
Number of obs: 500, groups:  group, 50

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.98312    0.15318   6.418
X            0.27141    0.10924   2.484
Med         -0.19818    0.07234  -2.739

Correlation of Fixed Effects:
    (Intr) X     
X   -0.144       
Med  0.218 -0.055</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="bayesian-mixed-mediation.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="co"># should equal the naive estimate in the following code</span></span>
<span id="cb510-2"><a href="bayesian-mixed-mediation.html#cb510-2" aria-hidden="true" tabindex="-1"></a>lme_indirect_effect <span class="ot">=</span> <span class="fu">fixef</span>(mod_Med)[<span class="st">&#39;X&#39;</span>] <span class="sc">*</span> <span class="fu">fixef</span>(mod_Main)[<span class="st">&#39;Med&#39;</span>]</span></code></pre></div>
<p>Using the <span class="pack">mediation</span> package will provide a better estimate, and can handle this simple mixed model setting.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="bayesian-mixed-mediation.html#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(mediation)</span></span>
<span id="cb511-2"><a href="bayesian-mixed-mediation.html#cb511-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-3"><a href="bayesian-mixed-mediation.html#cb511-3" aria-hidden="true" tabindex="-1"></a>mediation_mixed <span class="ot">=</span> mediation<span class="sc">::</span><span class="fu">mediate</span>(</span>
<span id="cb511-4"><a href="bayesian-mixed-mediation.html#cb511-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.m  =</span> mod_Med,</span>
<span id="cb511-5"><a href="bayesian-mixed-mediation.html#cb511-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.y  =</span> mod_Main,</span>
<span id="cb511-6"><a href="bayesian-mixed-mediation.html#cb511-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">treat    =</span> <span class="st">&#39;X&#39;</span>,</span>
<span id="cb511-7"><a href="bayesian-mixed-mediation.html#cb511-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">mediator =</span> <span class="st">&#39;Med&#39;</span></span>
<span id="cb511-8"><a href="bayesian-mixed-mediation.html#cb511-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb511-9"><a href="bayesian-mixed-mediation.html#cb511-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-10"><a href="bayesian-mixed-mediation.html#cb511-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mediation_mixed)</span></code></pre></div>
<pre><code>
Causal Mediation Analysis 

Quasi-Bayesian Confidence Intervals

Mediator Groups: group 

Outcome Groups: group 

Output Based on Overall Averages Across Groups 

               Estimate 95% CI Lower 95% CI Upper p-value    
ACME            -0.1249      -0.2017        -0.06  &lt;2e-16 ***
ADE              0.2713       0.0493         0.49   0.016 *  
Total Effect     0.1464      -0.0894         0.39   0.230    
Prop. Mediated  -0.6411      -7.6171         6.73   0.230    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Sample Size Used: 500 


Simulations: 1000 </code></pre>
<p>Extract parameters for comparison.</p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="bayesian-mixed-mediation.html#cb513-1" aria-hidden="true" tabindex="-1"></a>pars_primary <span class="ot">=</span> <span class="fu">get_posterior_mean</span>(fit, <span class="at">pars =</span> mainpars)[, <span class="dv">5</span>]</span>
<span id="cb513-2"><a href="bayesian-mixed-mediation.html#cb513-2" aria-hidden="true" tabindex="-1"></a>pars_re_cov  <span class="ot">=</span> <span class="fu">get_posterior_mean</span>(fit, <span class="at">pars =</span> <span class="st">&#39;Omega_chol&#39;</span>)[, <span class="dv">5</span>] <span class="co"># or take &#39;cov_RE&#39; from monte carlo sim</span></span>
<span id="cb513-3"><a href="bayesian-mixed-mediation.html#cb513-3" aria-hidden="true" tabindex="-1"></a>pars_re      <span class="ot">=</span> <span class="fu">get_posterior_mean</span>(fit, <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&#39;sigma_ranef&#39;</span>))[, <span class="dv">5</span>]</span></code></pre></div>
<p>Fixed effects and random effect variances.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
param
</th>
<th style="text-align:right;">
true
</th>
<th style="text-align:right;">
bayes
</th>
<th style="text-align:right;">
lme4
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
alpha_Med
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
2.007
</td>
<td style="text-align:right;">
2.022
</td>
</tr>
<tr>
<td style="text-align:left;">
beta_Med
</td>
<td style="text-align:right;">
0.20
</td>
<td style="text-align:right;">
0.183
</td>
<td style="text-align:right;">
0.220
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma_Med
</td>
<td style="text-align:right;">
0.75
</td>
<td style="text-align:right;">
0.745
</td>
<td style="text-align:right;">
0.743
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha_Main
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
0.964
</td>
<td style="text-align:right;">
0.983
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1_Main
</td>
<td style="text-align:right;">
0.30
</td>
<td style="text-align:right;">
0.268
</td>
<td style="text-align:right;">
0.271
</td>
</tr>
<tr>
<td style="text-align:left;">
beta2_Main
</td>
<td style="text-align:right;">
-0.20
</td>
<td style="text-align:right;">
-0.176
</td>
<td style="text-align:right;">
-0.198
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma_y
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.501
</td>
<td style="text-align:right;">
0.498
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha_Med_sd
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.061
</td>
<td style="text-align:right;">
1.016
</td>
</tr>
<tr>
<td style="text-align:left;">
beta_Med_sd
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.854
</td>
<td style="text-align:right;">
0.818
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha_sd
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.003
</td>
<td style="text-align:right;">
0.960
</td>
</tr>
<tr>
<td style="text-align:left;">
beta1_sd
</td>
<td style="text-align:right;">
0.70
</td>
<td style="text-align:right;">
0.783
</td>
<td style="text-align:right;">
0.752
</td>
</tr>
<tr>
<td style="text-align:left;">
beta2_sd
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
0.479
</td>
<td style="text-align:right;">
0.453
</td>
</tr>
</tbody>
</table>
<p>Compare the covariances of the random effects. The first shows the full covariance matrix for mediator and outcome, then broken out separately.</p>
<pre><code>$true
      [,1]  [,2]  [,3]  [,4]  [,5]
[1,]  1.00 -0.15  0.00  0.00  0.00
[2,] -0.15  0.64  0.00  0.00 -0.10
[3,]  0.00  0.00  1.00 -0.10  0.15
[4,]  0.00  0.00 -0.10  0.49  0.00
[5,]  0.00 -0.10  0.15  0.00  0.25

$estimates
      [,1]  [,2]  [,3]  [,4]  [,5]
[1,]  1.13 -0.21  0.05  0.03  0.02
[2,] -0.21  0.72  0.05 -0.01 -0.11
[3,]  0.05  0.05  0.96 -0.13  0.20
[4,]  0.03 -0.01 -0.13  0.58  0.00
[5,]  0.02 -0.11  0.20  0.00  0.21</code></pre>
<pre><code>$vcov_Med
      [,1]  [,2]
[1,]  1.00 -0.15
[2,] -0.15  0.64

$vcov_Med_bayes
      [,1]  [,2]
[1,]  1.13 -0.21
[2,] -0.21  0.72

$vcov_Med_lme4
            (Intercept)     X
(Intercept)        1.03 -0.22
X                 -0.22  0.67</code></pre>
<pre><code>$vcov_Main
      [,1]  [,2] [,3]
[1,]  1.00 -0.10 0.15
[2,] -0.10  0.49 0.00
[3,]  0.15  0.00 0.25

$vcov_Main_bayes
      [,1]  [,2] [,3]
[1,]  0.96 -0.13 0.20
[2,] -0.13  0.58 0.00
[3,]  0.20  0.00 0.21

$vcov_Main_lme4
            (Intercept)     X   Med
(Intercept)        0.92 -0.14  0.22
X                 -0.14  0.57 -0.01
Med                0.22 -0.01  0.21</code></pre>
<p>Compare indirect effects</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
true
</th>
<th style="text-align:right;">
est
</th>
<th style="text-align:right;">
naiveBayes
</th>
<th style="text-align:right;">
naiveLme
</th>
<th style="text-align:right;">
mediation_pack
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-0.14
</td>
<td style="text-align:right;">
-0.151
</td>
<td style="text-align:right;">
-0.034
</td>
<td style="text-align:right;">
-0.044
</td>
<td style="text-align:right;">
-0.125
</td>
</tr>
</tbody>
</table>
<p>Note that you can use <span class="pack" style="">brms</span> to estimate this model as follows. The <code>i</code> allows the random effects to correlate across Mediator and outcome models. We have to convert the correlation estimate back to the covariance estimate to get the indirect value to compare to our base Stan result.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="bayesian-mixed-mediation.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb517-2"><a href="bayesian-mixed-mediation.html#cb517-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-3"><a href="bayesian-mixed-mediation.html#cb517-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">=</span> </span>
<span id="cb517-4"><a href="bayesian-mixed-mediation.html#cb517-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(Med <span class="sc">~</span> X <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> X <span class="sc">|</span>i<span class="sc">|</span> group)) <span class="sc">+</span></span>
<span id="cb517-5"><a href="bayesian-mixed-mediation.html#cb517-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bf</span>(y   <span class="sc">~</span> X <span class="sc">+</span> Med <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> X <span class="sc">+</span> Med <span class="sc">|</span>i<span class="sc">|</span> group)) <span class="sc">+</span></span>
<span id="cb517-6"><a href="bayesian-mixed-mediation.html#cb517-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_rescor</span>(<span class="cn">FALSE</span>)</span>
<span id="cb517-7"><a href="bayesian-mixed-mediation.html#cb517-7" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb517-8"><a href="bayesian-mixed-mediation.html#cb517-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-9"><a href="bayesian-mixed-mediation.html#cb517-9" aria-hidden="true" tabindex="-1"></a>fit_brm <span class="ot">=</span> <span class="fu">brm</span>(</span>
<span id="cb517-10"><a href="bayesian-mixed-mediation.html#cb517-10" aria-hidden="true" tabindex="-1"></a>  f,</span>
<span id="cb517-11"><a href="bayesian-mixed-mediation.html#cb517-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data  =</span> <span class="fu">data.frame</span>(X, Med, y, group),</span>
<span id="cb517-12"><a href="bayesian-mixed-mediation.html#cb517-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">cores =</span> <span class="dv">4</span>,</span>
<span id="cb517-13"><a href="bayesian-mixed-mediation.html#cb517-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">thin  =</span> <span class="dv">4</span>,</span>
<span id="cb517-14"><a href="bayesian-mixed-mediation.html#cb517-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed  =</span> <span class="dv">1234</span></span>
<span id="cb517-15"><a href="bayesian-mixed-mediation.html#cb517-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="bayesian-mixed-mediation.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_brm)</span></code></pre></div>
<pre><code> Family: MV(gaussian, gaussian) 
  Links: mu = identity; sigma = identity
         mu = identity; sigma = identity 
Formula: Med ~ X + (1 + X | i | group) 
         y ~ X + Med + (1 + X + Med | i | group) 
   Data: data.frame(X, Med, y, group) (Number of observations: 500) 
Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 4;
         total post-warmup samples = 1000

Group-Level Effects: 
~group (Number of levels: 50) 
                               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sd(Med_Intercept)                  1.08      0.12     0.86     1.34 1.00      963      853
sd(Med_X)                          0.86      0.09     0.70     1.06 1.00      713      787
sd(y_Intercept)                    1.02      0.13     0.79     1.31 1.00      922      955
sd(y_X)                            0.80      0.09     0.64     1.00 1.00      867      650
sd(y_Med)                          0.48      0.07     0.37     0.63 1.00      887      755
cor(Med_Intercept,Med_X)          -0.24      0.14    -0.50     0.03 1.00      619      589
cor(Med_Intercept,y_Intercept)     0.06      0.16    -0.25     0.36 1.00      953      949
cor(Med_X,y_Intercept)             0.06      0.15    -0.25     0.35 1.00      810      990
cor(Med_Intercept,y_X)             0.03      0.15    -0.25     0.32 1.01      910      915
cor(Med_X,y_X)                    -0.00      0.15    -0.28     0.30 1.00      956      728
cor(y_Intercept,y_X)              -0.18      0.15    -0.46     0.13 1.00      741      819
cor(Med_Intercept,y_Med)           0.03      0.16    -0.29     0.37 1.00      947      902
cor(Med_X,y_Med)                  -0.29      0.15    -0.56     0.02 1.00     1042      782
cor(y_Intercept,y_Med)             0.45      0.17     0.10     0.75 1.00      841      782
cor(y_X,y_Med)                    -0.01      0.16    -0.31     0.30 1.00     1042      850

Population-Level Effects: 
              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
Med_Intercept     2.02      0.15     1.72     2.32 1.00      722      849
y_Intercept       0.99      0.17     0.67     1.33 1.00      796      904
Med_X             0.22      0.13    -0.02     0.46 1.00      711      908
y_X               0.31      0.12     0.07     0.56 1.00      899      995
y_Med            -0.20      0.08    -0.35    -0.05 1.00     1001      994

Family Specific Parameters: 
          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma_Med     0.74      0.03     0.69     0.80 1.00      973      889
sigma_y       0.50      0.02     0.46     0.54 1.00      986      960

Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="bayesian-mixed-mediation.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hypothesis</span>(</span>
<span id="cb520-2"><a href="bayesian-mixed-mediation.html#cb520-2" aria-hidden="true" tabindex="-1"></a>  fit_brm,</span>
<span id="cb520-3"><a href="bayesian-mixed-mediation.html#cb520-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;b_y_Med*b_Med_X + cor_group__Med_X__y_Med*sd_group__Med_X*sd_group__y_Med = 0&#39;</span>,</span>
<span id="cb520-4"><a href="bayesian-mixed-mediation.html#cb520-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">class =</span> <span class="cn">NULL</span>,</span>
<span id="cb520-5"><a href="bayesian-mixed-mediation.html#cb520-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed  =</span>  <span class="dv">1234</span></span>
<span id="cb520-6"><a href="bayesian-mixed-mediation.html#cb520-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>Hypothesis Tests for class :
                Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
1 (b_y_Med*b_Med_X+... = 0    -0.17      0.08    -0.33    -0.03         NA        NA    *
---
&#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
&#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
for two-sided hypotheses, the value tested against lies outside the 95%-CI.
Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
</div>
<div id="visualization-2" class="section level2">
<h2>Visualization</h2>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="bayesian-mixed-mediation.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb522-2"><a href="bayesian-mixed-mediation.html#cb522-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb522-3"><a href="bayesian-mixed-mediation.html#cb522-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pp_check</span>(</span>
<span id="cb522-4"><a href="bayesian-mixed-mediation.html#cb522-4" aria-hidden="true" tabindex="-1"></a>  standat<span class="sc">$</span>y, </span>
<span id="cb522-5"><a href="bayesian-mixed-mediation.html#cb522-5" aria-hidden="true" tabindex="-1"></a>  rstan<span class="sc">::</span><span class="fu">extract</span>(fit, <span class="at">par =</span> <span class="st">&#39;y_hat&#39;</span>)<span class="sc">$</span>y_hat[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ], </span>
<span id="cb522-6"><a href="bayesian-mixed-mediation.html#cb522-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="st">&#39;dens_overlay&#39;</span></span>
<span id="cb522-7"><a href="bayesian-mixed-mediation.html#cb522-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="model-demos_files/figure-html/bayes-med-vis-1.svg" width="75%" style="display: block; margin: auto;" /></p>
</div>
<div id="source-29" class="section level2">
<h2>Source</h2>
<p>Original code available at:
<a href="https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/Bayesian/rstan_multilevelMediation.R" class="uri">https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/Bayesian/rstan_multilevelMediation.R</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-mixed-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-irt.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/bayesian-mixed-mediation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
