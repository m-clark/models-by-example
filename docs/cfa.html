<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Confirmatory Factor Analysis | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Confirmatory Factor Analysis | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Confirmatory Factor Analysis | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="rkhs.html"/>
<link rel="next" href="bayesian.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#one-factor-mixed-model"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#two-factor-mixed-model"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#mixed-model-via-ml"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial Regression</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal Regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#python-2"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gaussian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html"><i class="fa fa-check"></i>Neural Network</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-3"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-4"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-3"><i class="fa fa-check"></i>Example 3</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-5"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-2"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-22"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-27"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#introduction-2"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l1-lasso-regularization"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l2-ridge-regularization"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-9"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-42"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder-Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-45"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-24"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-51"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-32"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-55"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#sgd-variants"><i class="fa fa-check"></i>SGD Variants</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-33"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-56"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-2"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-52"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-11"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-57"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-53"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-52"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-58"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-52"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="confirmatory-factor-analysis" class="section level1">
<h1>Confirmatory Factor Analysis</h1>
<p>This mostly follows Bollen (1989) for maximum likelihood estimation of a confirmatory factor analysis. In the following example we will examine a situation where there are two underlying (correlated) latent variables for 8 observed responses. The code as is will only work with this toy data set. Setup uses the <span class="pack" style="">psych</span> and <span class="pack" style="">mvtnorm</span> packages, and results are checked against the <span class="pack" style="">lavaan</span> package.</p>
<div id="data-setup-23" class="section level2">
<h2>Data Setup</h2>
<p>For the data we will simulate observed variables with specific loadings on two latent constructs (factors).</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="cfa.html#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb398-2"><a href="cfa.html#cb398-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-3"><a href="cfa.html#cb398-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb398-4"><a href="cfa.html#cb398-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-5"><a href="cfa.html#cb398-5" aria-hidden="true" tabindex="-1"></a><span class="co"># loading matrix</span></span>
<span id="cb398-6"><a href="cfa.html#cb398-6" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb398-7"><a href="cfa.html#cb398-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>,</span>
<span id="cb398-8"><a href="cfa.html#cb398-8" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">1.0</span>, <span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>), </span>
<span id="cb398-9"><a href="cfa.html#cb398-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb398-10"><a href="cfa.html#cb398-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb398-11"><a href="cfa.html#cb398-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb398-12"><a href="cfa.html#cb398-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-13"><a href="cfa.html#cb398-13" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation of factors</span></span>
<span id="cb398-14"><a href="cfa.html#cb398-14" aria-hidden="true" tabindex="-1"></a>phi <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">25</span>, .<span class="dv">25</span>, <span class="dv">1</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb398-15"><a href="cfa.html#cb398-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-16"><a href="cfa.html#cb398-16" aria-hidden="true" tabindex="-1"></a><span class="co"># factors and some noise</span></span>
<span id="cb398-17"><a href="cfa.html#cb398-17" aria-hidden="true" tabindex="-1"></a>factors <span class="ot">=</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">sigma =</span> phi, <span class="st">&quot;chol&quot;</span>)</span>
<span id="cb398-18"><a href="cfa.html#cb398-18" aria-hidden="true" tabindex="-1"></a>e <span class="ot">=</span> mvtnorm<span class="sc">::</span><span class="fu">rmvnorm</span>(<span class="dv">1000</span>, <span class="at">sigma =</span> <span class="fu">diag</span>(<span class="dv">8</span>))</span>
<span id="cb398-19"><a href="cfa.html#cb398-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-20"><a href="cfa.html#cb398-20" aria-hidden="true" tabindex="-1"></a><span class="co"># observed responses</span></span>
<span id="cb398-21"><a href="cfa.html#cb398-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">0</span> <span class="sc">+</span> factors<span class="sc">%*%</span>lambda <span class="sc">+</span> e</span>
<span id="cb398-22"><a href="cfa.html#cb398-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-23"><a href="cfa.html#cb398-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Examine</span></span>
<span id="cb398-24"><a href="cfa.html#cb398-24" aria-hidden="true" tabindex="-1"></a><span class="co">#dim(y)</span></span>
<span id="cb398-25"><a href="cfa.html#cb398-25" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(y)</span></code></pre></div>
<pre><code>   vars    n  mean   sd median trimmed  mad   min  max range  skew kurtosis   se
X1    1 1000  0.05 1.44   0.05    0.05 1.42 -5.13 4.51  9.63  0.00     0.01 0.05
X2    2 1000  0.00 1.08  -0.01    0.00 1.04 -3.34 3.25  6.59  0.00    -0.06 0.03
X3    3 1000  0.01 1.27   0.05    0.01 1.17 -5.33 4.09  9.42 -0.06     0.32 0.04
X4    4 1000  0.00 1.14  -0.03   -0.01 1.13 -3.85 3.98  7.83  0.10     0.16 0.04
X5    5 1000  0.04 1.43   0.10    0.05 1.39 -4.43 5.21  9.63 -0.02     0.07 0.05
X6    6 1000 -0.02 1.22  -0.01   -0.02 1.27 -3.35 4.68  8.03  0.04    -0.10 0.04
X7    7 1000  0.02 1.14   0.02    0.01 1.10 -3.08 3.66  6.74  0.11     0.00 0.04
X8    8 1000  0.01 1.29   0.02    0.01 1.24 -3.68 4.50  8.18 -0.02     0.10 0.04</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="cfa.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># round(cor(y), 2)</span></span>
<span id="cb400-2"><a href="cfa.html#cb400-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-3"><a href="cfa.html#cb400-3" aria-hidden="true" tabindex="-1"></a><span class="co"># see the factor structure</span></span>
<span id="cb400-4"><a href="cfa.html#cb400-4" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">cor.plot</span>(<span class="fu">cor</span>(y))</span></code></pre></div>
<p><img src="model-demos_files/figure-html/cfa-setup-1.svg" width="75%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="cfa.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example exploratory fa</span></span>
<span id="cb401-2"><a href="cfa.html#cb401-2" aria-hidden="true" tabindex="-1"></a><span class="co">#psych::fa(y, nfactors=2, rotate=&quot;oblimin&quot;) </span></span></code></pre></div>
</div>
<div id="functions-7" class="section level2">
<h2>Functions</h2>
<p>We will have two separate estimation functions, one for the covariance matrix,
and another for the correlation matrix.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="cfa.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># measurement model, covariance approach</span></span>
<span id="cb402-2"><a href="cfa.html#cb402-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-3"><a href="cfa.html#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="co"># trace function, strangely absent from base R</span></span>
<span id="cb402-4"><a href="cfa.html#cb402-4" aria-hidden="true" tabindex="-1"></a>tr <span class="ot">&lt;-</span> <span class="cf">function</span>(mat) {</span>
<span id="cb402-5"><a href="cfa.html#cb402-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">diag</span>(mat), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb402-6"><a href="cfa.html#cb402-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb402-7"><a href="cfa.html#cb402-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-8"><a href="cfa.html#cb402-8" aria-hidden="true" tabindex="-1"></a>cfa_cov <span class="ot">&lt;-</span> <span class="cf">function</span> (parms, data) {</span>
<span id="cb402-9"><a href="cfa.html#cb402-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments- </span></span>
<span id="cb402-10"><a href="cfa.html#cb402-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># parms: initial values (named)</span></span>
<span id="cb402-11"><a href="cfa.html#cb402-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># data: raw data</span></span>
<span id="cb402-12"><a href="cfa.html#cb402-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-13"><a href="cfa.html#cb402-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract parameters by name</span></span>
<span id="cb402-14"><a href="cfa.html#cb402-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-15"><a href="cfa.html#cb402-15" aria-hidden="true" tabindex="-1"></a>  l1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, parms[<span class="fu">grep</span>(<span class="st">&#39;l1&#39;</span>, <span class="fu">names</span>(parms))])      <span class="co"># loadings for factor 1</span></span>
<span id="cb402-16"><a href="cfa.html#cb402-16" aria-hidden="true" tabindex="-1"></a>  l2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, parms[<span class="fu">grep</span>(<span class="st">&#39;l2&#39;</span>, <span class="fu">names</span>(parms))])      <span class="co"># loadings for factor 2</span></span>
<span id="cb402-17"><a href="cfa.html#cb402-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-18"><a href="cfa.html#cb402-18" aria-hidden="true" tabindex="-1"></a>  cov0 <span class="ot">=</span> parms[<span class="fu">grep</span>(<span class="st">&#39;cov&#39;</span>, <span class="fu">names</span>(parms))]         <span class="co"># factor covariance, variances</span></span>
<span id="cb402-19"><a href="cfa.html#cb402-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-20"><a href="cfa.html#cb402-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Covariance matrix</span></span>
<span id="cb402-21"><a href="cfa.html#cb402-21" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">=</span> <span class="fu">cov</span>(data)<span class="sc">*</span>((<span class="fu">nrow</span>(data)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">nrow</span>(data))       <span class="co"># ML covariance div by N rather than N-1, the multiplier adjusts</span></span>
<span id="cb402-22"><a href="cfa.html#cb402-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-23"><a href="cfa.html#cb402-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># loading estimates</span></span>
<span id="cb402-24"><a href="cfa.html#cb402-24" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">=</span> <span class="fu">cbind</span>(</span>
<span id="cb402-25"><a href="cfa.html#cb402-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(l1, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(l2))),</span>
<span id="cb402-26"><a href="cfa.html#cb402-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(l1)), l2)</span>
<span id="cb402-27"><a href="cfa.html#cb402-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb402-28"><a href="cfa.html#cb402-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-29"><a href="cfa.html#cb402-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># disturbances</span></span>
<span id="cb402-30"><a href="cfa.html#cb402-30" aria-hidden="true" tabindex="-1"></a>  dist_init <span class="ot">=</span> parms[<span class="fu">grep</span>(<span class="st">&#39;dist&#39;</span>, <span class="fu">names</span>(parms))]    </span>
<span id="cb402-31"><a href="cfa.html#cb402-31" aria-hidden="true" tabindex="-1"></a>  disturbs  <span class="ot">=</span> <span class="fu">diag</span>(dist_init)</span>
<span id="cb402-32"><a href="cfa.html#cb402-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-33"><a href="cfa.html#cb402-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># factor correlation</span></span>
<span id="cb402-34"><a href="cfa.html#cb402-34" aria-hidden="true" tabindex="-1"></a>  phi_init <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(cov0[<span class="dv">1</span>], cov0[<span class="dv">2</span>], cov0[<span class="dv">2</span>], cov0[<span class="dv">3</span>]), <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co">#factor cov/correlation matrix</span></span>
<span id="cb402-35"><a href="cfa.html#cb402-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-36"><a href="cfa.html#cb402-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># other calculations and log likelihood</span></span>
<span id="cb402-37"><a href="cfa.html#cb402-37" aria-hidden="true" tabindex="-1"></a>  sigtheta <span class="ot">=</span> lambda<span class="sc">%*%</span>phi_init<span class="sc">%*%</span><span class="fu">t</span>(lambda) <span class="sc">+</span> disturbs</span>
<span id="cb402-38"><a href="cfa.html#cb402-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-39"><a href="cfa.html#cb402-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># in Bollen p + q (but for the purposes of this just p) = tr(data)</span></span>
<span id="cb402-40"><a href="cfa.html#cb402-40" aria-hidden="true" tabindex="-1"></a>  pq <span class="ot">=</span> <span class="fu">dim</span>(data)[<span class="dv">2</span>] </span>
<span id="cb402-41"><a href="cfa.html#cb402-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-42"><a href="cfa.html#cb402-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a reduced version; Bollen 1989 p.107</span></span>
<span id="cb402-43"><a href="cfa.html#cb402-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ll = -(log(det(sigtheta)) + tr(S%*%solve(sigtheta)) - log(det(S)) - pq) </span></span>
<span id="cb402-44"><a href="cfa.html#cb402-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-45"><a href="cfa.html#cb402-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># this should be the same as Mplus H0 log likelihood</span></span>
<span id="cb402-46"><a href="cfa.html#cb402-46" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">=</span> ( (<span class="sc">-</span><span class="fu">nrow</span>(data)<span class="sc">*</span>pq<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>pi) ) <span class="sc">-</span> </span>
<span id="cb402-47"><a href="cfa.html#cb402-47" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">nrow</span>(data)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> ( <span class="fu">log</span>(<span class="fu">det</span>(sigtheta)) <span class="sc">+</span> <span class="fu">tr</span>(S<span class="sc">%*%</span><span class="fu">solve</span>(sigtheta)) )</span>
<span id="cb402-48"><a href="cfa.html#cb402-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb402-49"><a href="cfa.html#cb402-49" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span>ll</span>
<span id="cb402-50"><a href="cfa.html#cb402-50" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can use the correlation matrix for standardized results. Lines correspond to those in <code>cfa_cov</code>.</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="cfa.html#cb403-1" aria-hidden="true" tabindex="-1"></a>cfa_cor <span class="ot">&lt;-</span> <span class="cf">function</span> (parms, data) {</span>
<span id="cb403-2"><a href="cfa.html#cb403-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-3"><a href="cfa.html#cb403-3" aria-hidden="true" tabindex="-1"></a>  l1 <span class="ot">=</span> parms[<span class="fu">grep</span>(<span class="st">&#39;l1&#39;</span>, <span class="fu">names</span>(parms))]      <span class="co"># loadings for factor 1</span></span>
<span id="cb403-4"><a href="cfa.html#cb403-4" aria-hidden="true" tabindex="-1"></a>  l2 <span class="ot">=</span> parms[<span class="fu">grep</span>(<span class="st">&#39;l2&#39;</span>, <span class="fu">names</span>(parms))]      <span class="co"># loadings for factor 2</span></span>
<span id="cb403-5"><a href="cfa.html#cb403-5" aria-hidden="true" tabindex="-1"></a>  cor0 <span class="ot">=</span> parms[<span class="fu">grep</span>(<span class="st">&#39;cor&#39;</span>, <span class="fu">names</span>(parms))]   <span class="co"># factor correlation</span></span>
<span id="cb403-6"><a href="cfa.html#cb403-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-7"><a href="cfa.html#cb403-7" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">=</span> <span class="fu">cor</span>(data)</span>
<span id="cb403-8"><a href="cfa.html#cb403-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-9"><a href="cfa.html#cb403-9" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">=</span> <span class="fu">cbind</span>(</span>
<span id="cb403-10"><a href="cfa.html#cb403-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(l1, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(l2))),</span>
<span id="cb403-11"><a href="cfa.html#cb403-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">length</span>(l1)), l2)</span>
<span id="cb403-12"><a href="cfa.html#cb403-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb403-13"><a href="cfa.html#cb403-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-14"><a href="cfa.html#cb403-14" aria-hidden="true" tabindex="-1"></a>  dist_init <span class="ot">=</span> parms[<span class="fu">grep</span>(<span class="st">&#39;dist&#39;</span>, <span class="fu">names</span>(parms))]</span>
<span id="cb403-15"><a href="cfa.html#cb403-15" aria-hidden="true" tabindex="-1"></a>  disturbs  <span class="ot">=</span> <span class="fu">diag</span>(dist_init)</span>
<span id="cb403-16"><a href="cfa.html#cb403-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-17"><a href="cfa.html#cb403-17" aria-hidden="true" tabindex="-1"></a>  phi_init <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, cor0, cor0, <span class="dv">1</span>), <span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb403-18"><a href="cfa.html#cb403-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-19"><a href="cfa.html#cb403-19" aria-hidden="true" tabindex="-1"></a>  sigtheta <span class="ot">=</span> lambda<span class="sc">%*%</span>phi_init<span class="sc">%*%</span><span class="fu">t</span>(lambda) <span class="sc">+</span> disturbs</span>
<span id="cb403-20"><a href="cfa.html#cb403-20" aria-hidden="true" tabindex="-1"></a>  pq <span class="ot">=</span> <span class="fu">dim</span>(data)[<span class="dv">2</span>]</span>
<span id="cb403-21"><a href="cfa.html#cb403-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-22"><a href="cfa.html#cb403-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#ll = ( log(det(sigtheta)) + tr(S%*%solve(sigtheta)) - log(det(S)) - pq )</span></span>
<span id="cb403-23"><a href="cfa.html#cb403-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-24"><a href="cfa.html#cb403-24" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">=</span> ( (<span class="sc">-</span><span class="fu">nrow</span>(data)<span class="sc">*</span>pq<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>pi) ) <span class="sc">-</span> </span>
<span id="cb403-25"><a href="cfa.html#cb403-25" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">nrow</span>(data)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">*</span> ( <span class="fu">log</span>(<span class="fu">det</span>(sigtheta)) <span class="sc">+</span> <span class="fu">tr</span>(S<span class="sc">%*%</span><span class="fu">solve</span>(sigtheta)) )</span>
<span id="cb403-26"><a href="cfa.html#cb403-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb403-27"><a href="cfa.html#cb403-27" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span>ll</span>
<span id="cb403-28"><a href="cfa.html#cb403-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="estimation-21" class="section level2">
<h2>Estimation</h2>
<p>Corresponding to the functions, we will get results based on the covariance and
correlation matrix respectively.</p>
<div id="raw" class="section level3">
<h3>Raw</h3>
<p>Set initial values.</p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="cfa.html#cb404-1" aria-hidden="true" tabindex="-1"></a>par_init_cov <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">6</span>), <span class="fu">rep</span>(.<span class="dv">05</span>, <span class="dv">8</span>), <span class="fu">rep</span>(.<span class="dv">5</span>, <span class="dv">3</span>)) </span>
<span id="cb404-2"><a href="cfa.html#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(par_init_cov) <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;l1&#39;</span>,<span class="st">&#39;l2&#39;</span>, <span class="st">&#39;dist&#39;</span>, <span class="st">&#39;cov&#39;</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">8</span>, <span class="dv">3</span>))</span></code></pre></div>
<p>Estimate and extract.</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="cfa.html#cb405-1" aria-hidden="true" tabindex="-1"></a>fit_cov <span class="ot">=</span> <span class="fu">optim</span>(</span>
<span id="cb405-2"><a href="cfa.html#cb405-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">par  =</span> par_init_cov,</span>
<span id="cb405-3"><a href="cfa.html#cb405-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn   =</span> cfa_cov,</span>
<span id="cb405-4"><a href="cfa.html#cb405-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> y,</span>
<span id="cb405-5"><a href="cfa.html#cb405-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method  =</span> <span class="st">&quot;L-BFGS-B&quot;</span>,</span>
<span id="cb405-6"><a href="cfa.html#cb405-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower   =</span> <span class="dv">0</span></span>
<span id="cb405-7"><a href="cfa.html#cb405-7" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb405-8"><a href="cfa.html#cb405-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-9"><a href="cfa.html#cb405-9" aria-hidden="true" tabindex="-1"></a>loadings_cov <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb405-10"><a href="cfa.html#cb405-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">f1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, fit_cov<span class="sc">$</span>par[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>)),</span>
<span id="cb405-11"><a href="cfa.html#cb405-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">f2 =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dv">1</span>, fit_cov<span class="sc">$</span>par[<span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb405-12"><a href="cfa.html#cb405-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb405-13"><a href="cfa.html#cb405-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-14"><a href="cfa.html#cb405-14" aria-hidden="true" tabindex="-1"></a>disturbances_cov <span class="ot">=</span> fit_cov<span class="sc">$</span>par[<span class="dv">7</span><span class="sc">:</span><span class="dv">14</span>]</span></code></pre></div>
</div>
<div id="standardized" class="section level3">
<h3>Standardized</h3>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="cfa.html#cb406-1" aria-hidden="true" tabindex="-1"></a>par_init_cor <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="fu">rep</span>(.<span class="dv">05</span>, <span class="dv">8</span>), <span class="dv">0</span>) <span class="co">#for cor</span></span>
<span id="cb406-2"><a href="cfa.html#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(par_init_cor) <span class="ot">=</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;l1&#39;</span>, <span class="st">&#39;l2&#39;</span>, <span class="st">&#39;dist&#39;</span>, <span class="st">&#39;cor&#39;</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="cfa.html#cb407-1" aria-hidden="true" tabindex="-1"></a>fit_cor <span class="ot">=</span> <span class="fu">optim</span>(</span>
<span id="cb407-2"><a href="cfa.html#cb407-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">par  =</span> par_init_cor,</span>
<span id="cb407-3"><a href="cfa.html#cb407-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fn   =</span> cfa_cor,</span>
<span id="cb407-4"><a href="cfa.html#cb407-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> y,</span>
<span id="cb407-5"><a href="cfa.html#cb407-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&quot;L-BFGS-B&quot;</span>,</span>
<span id="cb407-6"><a href="cfa.html#cb407-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower  =</span> <span class="dv">0</span>,</span>
<span id="cb407-7"><a href="cfa.html#cb407-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper  =</span> <span class="dv">1</span></span>
<span id="cb407-8"><a href="cfa.html#cb407-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb407-9"><a href="cfa.html#cb407-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-10"><a href="cfa.html#cb407-10" aria-hidden="true" tabindex="-1"></a>loadings_cor <span class="ot">=</span> <span class="fu">matrix</span>(</span>
<span id="cb407-11"><a href="cfa.html#cb407-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(fit_cor<span class="sc">$</span>par[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>], <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">4</span>), fit_cor<span class="sc">$</span>par[<span class="dv">5</span><span class="sc">:</span><span class="dv">8</span>]), </span>
<span id="cb407-12"><a href="cfa.html#cb407-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ncol =</span> <span class="dv">2</span></span>
<span id="cb407-13"><a href="cfa.html#cb407-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb407-14"><a href="cfa.html#cb407-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-15"><a href="cfa.html#cb407-15" aria-hidden="true" tabindex="-1"></a>disturbances_cor <span class="ot">=</span> fit_cor<span class="sc">$</span>par[<span class="dv">9</span><span class="sc">:</span><span class="dv">16</span>]</span></code></pre></div>
</div>
</div>
<div id="comparison-27" class="section level2">
<h2>Comparison</h2>
<p>Gather results for summarizing.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="cfa.html#cb408-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb408-2"><a href="cfa.html#cb408-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">raw =</span> <span class="fu">list</span>(</span>
<span id="cb408-3"><a href="cfa.html#cb408-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">loadings =</span> <span class="fu">round</span>(<span class="fu">data.frame</span>(loadings_cov, <span class="at">Variances =</span> disturbances_cov), <span class="dv">3</span>),</span>
<span id="cb408-4"><a href="cfa.html#cb408-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cov.fact =</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(fit_cov<span class="sc">$</span>par[<span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">16</span>, <span class="dv">17</span>)]), <span class="at">ncol =</span> <span class="dv">2</span>) , <span class="dv">3</span>)</span>
<span id="cb408-5"><a href="cfa.html#cb408-5" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb408-6"><a href="cfa.html#cb408-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb408-7"><a href="cfa.html#cb408-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">standardized =</span> <span class="fu">list</span>(</span>
<span id="cb408-8"><a href="cfa.html#cb408-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">loadings =</span> <span class="fu">round</span>(</span>
<span id="cb408-9"><a href="cfa.html#cb408-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">data.frame</span>(</span>
<span id="cb408-10"><a href="cfa.html#cb408-10" aria-hidden="true" tabindex="-1"></a>        loadings_cor,</span>
<span id="cb408-11"><a href="cfa.html#cb408-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">Variances =</span> disturbances_cor,</span>
<span id="cb408-12"><a href="cfa.html#cb408-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">Rsq =</span> (<span class="dv">1</span> <span class="sc">-</span> disturbances_cor)</span>
<span id="cb408-13"><a href="cfa.html#cb408-13" aria-hidden="true" tabindex="-1"></a>      ), <span class="dv">3</span>),</span>
<span id="cb408-14"><a href="cfa.html#cb408-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">cor.fact =</span> <span class="fu">round</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, fit_cor<span class="sc">$</span>par[<span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">17</span>)], <span class="dv">1</span>), <span class="at">ncol =</span> <span class="dv">2</span>), <span class="dv">3</span>)</span>
<span id="cb408-15"><a href="cfa.html#cb408-15" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb408-16"><a href="cfa.html#cb408-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb408-17"><a href="cfa.html#cb408-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note inclusion of intercepts for total number of par</span></span>
<span id="cb408-18"><a href="cfa.html#cb408-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">fit_lav =</span> <span class="fu">data.frame</span>(</span>
<span id="cb408-19"><a href="cfa.html#cb408-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ll  =</span> fit_cov<span class="sc">$</span>value,</span>
<span id="cb408-20"><a href="cfa.html#cb408-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">AIC =</span> <span class="dv">2</span><span class="sc">*</span>fit_cov<span class="sc">$</span>value <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">length</span>(par_init_cov) <span class="sc">+</span> <span class="fu">ncol</span>(y)),</span>
<span id="cb408-21"><a href="cfa.html#cb408-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">BIC =</span> <span class="dv">2</span><span class="sc">*</span>fit_cov<span class="sc">$</span>value <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">nrow</span>(y)) <span class="sc">*</span> (<span class="fu">length</span>(par_init_cov) <span class="sc">+</span> <span class="fu">ncol</span>(y))</span>
<span id="cb408-22"><a href="cfa.html#cb408-22" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb408-23"><a href="cfa.html#cb408-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb408-24"><a href="cfa.html#cb408-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-25"><a href="cfa.html#cb408-25" aria-hidden="true" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>$raw
$raw$loadings
     f1    f2 Variances
1 1.000 0.000     1.073
2 0.459 0.000     0.955
3 0.836 0.000     0.908
4 0.570 0.000     0.961
5 0.000 1.000     1.047
6 0.000 0.739     0.941
7 0.000 0.575     0.972
8 0.000 0.803     1.034

$raw$cov.fact
      [,1]  [,2]
[1,] 1.006 0.185
[2,] 0.185 0.989


$standardized
$standardized$loadings
     X1    X2 Variances   Rsq
1 0.696 0.000     0.516 0.484
2 0.426 0.000     0.819 0.181
3 0.661 0.000     0.563 0.437
4 0.504 0.000     0.746 0.254
5 0.000 0.697     0.514 0.486
6 0.000 0.604     0.636 0.364
7 0.000 0.502     0.748 0.252
8 0.000 0.618     0.618 0.382

$standardized$cor.fact
      [,1]  [,2]
[1,] 1.000 0.186
[2,] 0.186 1.000


$fit_lav
        ll      AIC      BIC
1 12497.68 25045.37 25168.06</code></pre>
<p>Compare with <span class="pack" style="">lavaan</span>.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="cfa.html#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb410-2"><a href="cfa.html#cb410-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-3"><a href="cfa.html#cb410-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">data.frame</span>(y)</span>
<span id="cb410-4"><a href="cfa.html#cb410-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-5"><a href="cfa.html#cb410-5" aria-hidden="true" tabindex="-1"></a>model <span class="ot">=</span> <span class="st">&#39;</span></span>
<span id="cb410-6"><a href="cfa.html#cb410-6" aria-hidden="true" tabindex="-1"></a><span class="st">  F1  =~ X1 + X2 + X3 + X4</span></span>
<span id="cb410-7"><a href="cfa.html#cb410-7" aria-hidden="true" tabindex="-1"></a><span class="st">  F2  =~ X5 + X6 + X7 + X8</span></span>
<span id="cb410-8"><a href="cfa.html#cb410-8" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;</span></span>
<span id="cb410-9"><a href="cfa.html#cb410-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-10"><a href="cfa.html#cb410-10" aria-hidden="true" tabindex="-1"></a>fit_lav <span class="ot">=</span> <span class="fu">cfa</span>(</span>
<span id="cb410-11"><a href="cfa.html#cb410-11" aria-hidden="true" tabindex="-1"></a>  model,</span>
<span id="cb410-12"><a href="cfa.html#cb410-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">data  =</span> y,</span>
<span id="cb410-13"><a href="cfa.html#cb410-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">mimic =</span> <span class="st">&#39;Mplus&#39;</span>,</span>
<span id="cb410-14"><a href="cfa.html#cb410-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">&#39;ML&#39;</span></span>
<span id="cb410-15"><a href="cfa.html#cb410-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb410-16"><a href="cfa.html#cb410-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-17"><a href="cfa.html#cb410-17" aria-hidden="true" tabindex="-1"></a>fit_lav_std <span class="ot">=</span> <span class="fu">cfa</span>(</span>
<span id="cb410-18"><a href="cfa.html#cb410-18" aria-hidden="true" tabindex="-1"></a>  model,</span>
<span id="cb410-19"><a href="cfa.html#cb410-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data  =</span> y,</span>
<span id="cb410-20"><a href="cfa.html#cb410-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">mimic =</span> <span class="st">&#39;Mplus&#39;</span>,</span>
<span id="cb410-21"><a href="cfa.html#cb410-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimator =</span> <span class="st">&#39;ML&#39;</span>,</span>
<span id="cb410-22"><a href="cfa.html#cb410-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.lv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb410-23"><a href="cfa.html#cb410-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">std.ov =</span> <span class="cn">TRUE</span></span>
<span id="cb410-24"><a href="cfa.html#cb410-24" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb410-25"><a href="cfa.html#cb410-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-26"><a href="cfa.html#cb410-26" aria-hidden="true" tabindex="-1"></a><span class="co"># note that lavaan does not count the intercepts among the free params for</span></span>
<span id="cb410-27"><a href="cfa.html#cb410-27" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC/BIC by default, (can get its result via -2 * as.numeric(lls) + k *</span></span>
<span id="cb410-28"><a href="cfa.html#cb410-28" aria-hidden="true" tabindex="-1"></a><span class="co"># attr(lls, &quot;df&quot;)), but the mimic=&#39;Mplus&#39; should have them correspond to optim&#39;s</span></span>
<span id="cb410-29"><a href="cfa.html#cb410-29" aria-hidden="true" tabindex="-1"></a><span class="co"># results</span></span>
<span id="cb410-30"><a href="cfa.html#cb410-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-31"><a href="cfa.html#cb410-31" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lav,</span>
<span id="cb410-32"><a href="cfa.html#cb410-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">fit.measures =</span> <span class="cn">TRUE</span>,</span>
<span id="cb410-33"><a href="cfa.html#cb410-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>lavaan 0.6-7 ended normally after 30 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of free parameters                         25
                                                      
  Number of observations                          1000
  Number of missing patterns                         1
                                                      
Model Test User Model:
                                                      
  Test statistic                                25.586
  Degrees of freedom                                19
  P-value (Chi-square)                           0.142

Model Test Baseline Model:

  Test statistic                              1229.322
  Degrees of freedom                                28
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.995
  Tucker-Lewis Index (TLI)                       0.992

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -12497.683
  Loglikelihood unrestricted model (H1)     -12484.890
                                                      
  Akaike (AIC)                               25045.366
  Bayesian (BIC)                             25168.060
  Sample-size adjusted Bayesian (BIC)        25088.658

Root Mean Square Error of Approximation:

  RMSEA                                          0.019
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.035
  P-value RMSEA &lt;= 0.05                          1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.018

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Observed
  Observed information based on                Hessian

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  F1 =~                                                                 
    X1                1.000                               1.003    0.696
    X2                0.459    0.046   10.043    0.000    0.460    0.426
    X3                0.836    0.066   12.590    0.000    0.839    0.661
    X4                0.570    0.050   11.450    0.000    0.572    0.504
  F2 =~                                                                 
    X5                1.000                               0.994    0.697
    X6                0.739    0.056   13.239    0.000    0.735    0.604
    X7                0.575    0.048   12.071    0.000    0.572    0.502
    X8                0.803    0.060   13.386    0.000    0.799    0.618

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  F1 ~~                                                                 
    F2                0.185    0.046    4.014    0.000    0.186    0.186

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .X1                0.054    0.046    1.173    0.241    0.054    0.037
   .X2               -0.004    0.034   -0.104    0.917   -0.004   -0.003
   .X3                0.007    0.040    0.182    0.855    0.007    0.006
   .X4                0.004    0.036    0.113    0.910    0.004    0.004
   .X5                0.044    0.045    0.964    0.335    0.044    0.031
   .X6               -0.019    0.038   -0.504    0.614   -0.019   -0.016
   .X7                0.024    0.036    0.674    0.500    0.024    0.021
   .X8                0.010    0.041    0.247    0.805    0.010    0.008
    F1                0.000                               0.000    0.000
    F2                0.000                               0.000    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .X1                1.073    0.087   12.356    0.000    1.073    0.516
   .X2                0.955    0.047   20.128    0.000    0.955    0.819
   .X3                0.908    0.065   13.887    0.000    0.908    0.563
   .X4                0.961    0.051   18.885    0.000    0.961    0.746
   .X5                1.048    0.079   13.336    0.000    1.048    0.514
   .X6                0.941    0.056   16.867    0.000    0.941    0.636
   .X7                0.972    0.050   19.255    0.000    0.972    0.748
   .X8                1.034    0.063   16.411    0.000    1.034    0.618
    F1                1.006    0.108    9.351    0.000    1.000    1.000
    F2                0.989    0.100    9.853    0.000    1.000    1.000</code></pre>
<div id="mplus" class="section level3">
<h3>Mplus</h3>
<p>If you have access to Mplus you can use Mplus Automation to prepare the data. The following code is in Mplus syntax and will produce the above model.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="cfa.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MplusAutomation)</span>
<span id="cb412-2"><a href="cfa.html#cb412-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-3"><a href="cfa.html#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">prepareMplusData</span>(<span class="fu">data.frame</span>(y), <span class="st">&quot;factsim.dat&quot;</span>)</span></code></pre></div>
<pre><code>MODEL:
 F1 BY X1-X4;
 F2 BY X5-X8;

results:
 STDYX;</code></pre>
</div>
</div>
<div id="source-23" class="section level2">
<h2>Source</h2>
<p>Original code available at
<a href="https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/cfa.R" class="uri">https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/cfa.R</a></p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="rkhs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/cfa.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
