<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Supplemental | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Supplemental | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Supplemental | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="hamiltonian-monte-carlo.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#one-factor-mixed-model"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#two-factor-mixed-model"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#mixed-model-via-ml"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial Regression</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal Regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#python-2"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gaussian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html"><i class="fa fa-check"></i>Neural Network</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-3"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-4"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-3"><i class="fa fa-check"></i>Example 3</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-5"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-2"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-22"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-27"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#introduction-2"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l1-lasso-regularization"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l2-ridge-regularization"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-9"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-42"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder-Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-45"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-24"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-51"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-32"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-55"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#sgd-variants"><i class="fa fa-check"></i>SGD Variants</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-33"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-56"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-2"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-52"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-11"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-57"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-53"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-52"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-58"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-52"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="supplemental" class="section level1">
<h1>Supplemental</h1>
<div id="other-languages" class="section level2">
<h2>Other Languages</h2>
<p>When doing some of these models and algorithms, I had some other code to work with in another language, or, at the time, just wanted to try it in that language. There is not a whole lot here, but it still may be useful to some. Refer to the corresponding chapter of R code for context.</p>
<div id="python-demos" class="section level3">
<h3>Python Demos</h3>
<div id="python-linreg" class="section level4">
<h4>Linear Regression</h4>
<div id="data-setup-54" class="section level5">
<h5>Data Setup</h5>
<div class="sourceCode" id="cb852"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb852-1"><a href="supplemental.html#cb852-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb852-2"><a href="supplemental.html#cb852-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb852-3"><a href="supplemental.html#cb852-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb852-4"><a href="supplemental.html#cb852-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb852-5"><a href="supplemental.html#cb852-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb852-6"><a href="supplemental.html#cb852-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>) <span class="co"># ensures replication</span></span>
<span id="cb852-7"><a href="supplemental.html#cb852-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb852-8"><a href="supplemental.html#cb852-8" aria-hidden="true" tabindex="-1"></a><span class="co"># predictors and response</span></span>
<span id="cb852-9"><a href="supplemental.html#cb852-9" aria-hidden="true" tabindex="-1"></a><span class="co"># increasing N will get estimated values closer to the known parameters</span></span>
<span id="cb852-10"><a href="supplemental.html#cb852-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb852-11"><a href="supplemental.html#cb852-11" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">1000</span> <span class="co"># sample size</span></span>
<span id="cb852-12"><a href="supplemental.html#cb852-12" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">2</span>   <span class="co"># number of desired predictors</span></span>
<span id="cb852-13"><a href="supplemental.html#cb852-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.matrix(np.random.normal(size <span class="op">=</span> N <span class="op">*</span> k)).reshape(N, k)</span>
<span id="cb852-14"><a href="supplemental.html#cb852-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="op">-</span><span class="fl">.5</span> <span class="op">+</span> <span class="fl">.2</span><span class="op">*</span>X[:, <span class="dv">0</span>] <span class="op">+</span> <span class="fl">.1</span><span class="op">*</span>X[:, <span class="dv">1</span>] <span class="op">+</span> np.random.normal(scale <span class="op">=</span> <span class="fl">.5</span>, size <span class="op">=</span> N).reshape(N, <span class="dv">1</span>)</span>
<span id="cb852-15"><a href="supplemental.html#cb852-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb852-16"><a href="supplemental.html#cb852-16" aria-hidden="true" tabindex="-1"></a>dfXy <span class="op">=</span> pd.DataFrame(np.column_stack([X, y]), columns <span class="op">=</span> [<span class="st">&#39;X1&#39;</span>, <span class="st">&#39;X2&#39;</span>, <span class="st">&#39;y&#39;</span>])</span></code></pre></div>
</div>
<div id="functions-13" class="section level5">
<h5>Functions</h5>
<p>A maximum likelihood approach.</p>
<div class="sourceCode" id="cb853"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb853-1"><a href="supplemental.html#cb853-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lm_ml(par, X, y):</span>
<span id="cb853-2"><a href="supplemental.html#cb853-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># par: parameters to be estimated</span></span>
<span id="cb853-3"><a href="supplemental.html#cb853-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X: predictor matrix with intercept column</span></span>
<span id="cb853-4"><a href="supplemental.html#cb853-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y: response</span></span>
<span id="cb853-5"><a href="supplemental.html#cb853-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb853-6"><a href="supplemental.html#cb853-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setup</span></span>
<span id="cb853-7"><a href="supplemental.html#cb853-7" aria-hidden="true" tabindex="-1"></a>  beta   <span class="op">=</span> par[<span class="dv">1</span>:].reshape(X.shape[<span class="dv">1</span>], <span class="dv">1</span>)    <span class="co"># coefficients</span></span>
<span id="cb853-8"><a href="supplemental.html#cb853-8" aria-hidden="true" tabindex="-1"></a>  sigma  <span class="op">=</span> par[<span class="dv">0</span>]                            <span class="co"># error sd</span></span>
<span id="cb853-9"><a href="supplemental.html#cb853-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N = X.shape[0]</span></span>
<span id="cb853-10"><a href="supplemental.html#cb853-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb853-11"><a href="supplemental.html#cb853-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear predictor</span></span>
<span id="cb853-12"><a href="supplemental.html#cb853-12" aria-hidden="true" tabindex="-1"></a>  LP <span class="op">=</span> X <span class="op">*</span> beta                              <span class="co"># linear predictor</span></span>
<span id="cb853-13"><a href="supplemental.html#cb853-13" aria-hidden="true" tabindex="-1"></a>  mu <span class="op">=</span> LP                                    <span class="co"># identity link in the glm sense</span></span>
<span id="cb853-14"><a href="supplemental.html#cb853-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb853-15"><a href="supplemental.html#cb853-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate likelihood</span></span>
<span id="cb853-16"><a href="supplemental.html#cb853-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb853-17"><a href="supplemental.html#cb853-17" aria-hidden="true" tabindex="-1"></a>  L <span class="op">=</span> norm.logpdf(y, loc <span class="op">=</span> mu, scale <span class="op">=</span> sigma) <span class="co"># log likelihood; or use norm.logpdf</span></span>
<span id="cb853-18"><a href="supplemental.html#cb853-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb853-19"><a href="supplemental.html#cb853-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># L =  -.5*N*log(sigma2) - .5*(1/sigma2)*crossprod(y-mu)    # alternate log likelihood form</span></span>
<span id="cb853-20"><a href="supplemental.html#cb853-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb853-21"><a href="supplemental.html#cb853-21" aria-hidden="true" tabindex="-1"></a>  L <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(L)       <span class="co"># optim by default is minimization, and we want to maximize the likelihood </span></span>
<span id="cb853-22"><a href="supplemental.html#cb853-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb853-23"><a href="supplemental.html#cb853-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(L)</span></code></pre></div>
<p>An approach via least squares loss function.</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb854-1"><a href="supplemental.html#cb854-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> lm_ls(par, X, y):</span>
<span id="cb854-2"><a href="supplemental.html#cb854-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># par: parameters to be estimated</span></span>
<span id="cb854-3"><a href="supplemental.html#cb854-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X: predictor matrix with intercept column</span></span>
<span id="cb854-4"><a href="supplemental.html#cb854-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y: response</span></span>
<span id="cb854-5"><a href="supplemental.html#cb854-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb854-6"><a href="supplemental.html#cb854-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setup</span></span>
<span id="cb854-7"><a href="supplemental.html#cb854-7" aria-hidden="true" tabindex="-1"></a>  beta <span class="op">=</span> par.reshape(<span class="dv">3</span>, <span class="dv">1</span>)              <span class="co"># coefficients</span></span>
<span id="cb854-8"><a href="supplemental.html#cb854-8" aria-hidden="true" tabindex="-1"></a>  N <span class="op">=</span> X.shape[<span class="dv">0</span>]</span>
<span id="cb854-9"><a href="supplemental.html#cb854-9" aria-hidden="true" tabindex="-1"></a>  p <span class="op">=</span> X.shape[<span class="dv">1</span>]</span>
<span id="cb854-10"><a href="supplemental.html#cb854-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb854-11"><a href="supplemental.html#cb854-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear predictor</span></span>
<span id="cb854-12"><a href="supplemental.html#cb854-12" aria-hidden="true" tabindex="-1"></a>  LP <span class="op">=</span> X <span class="op">*</span> beta                              <span class="co"># linear predictor</span></span>
<span id="cb854-13"><a href="supplemental.html#cb854-13" aria-hidden="true" tabindex="-1"></a>  mu <span class="op">=</span> LP                                    <span class="co"># identity link in the glm sense</span></span>
<span id="cb854-14"><a href="supplemental.html#cb854-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb854-15"><a href="supplemental.html#cb854-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># # squared error loss</span></span>
<span id="cb854-16"><a href="supplemental.html#cb854-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb854-17"><a href="supplemental.html#cb854-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(np.<span class="bu">sum</span>(np.square(y <span class="op">-</span> mu)))</span></code></pre></div>
</div>
<div id="estimation-53" class="section level5">
<h5>Estimation</h5>
<div class="sourceCode" id="cb855"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb855-1"><a href="supplemental.html#cb855-1" aria-hidden="true" tabindex="-1"></a>X_mm <span class="op">=</span> np.column_stack([np.repeat(<span class="dv">1</span>, N).reshape(N, <span class="dv">1</span>), X])</span>
<span id="cb855-2"><a href="supplemental.html#cb855-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb855-3"><a href="supplemental.html#cb855-3" aria-hidden="true" tabindex="-1"></a><span class="co"># you may get warnings, they can be ignored</span></span>
<span id="cb855-4"><a href="supplemental.html#cb855-4" aria-hidden="true" tabindex="-1"></a>fit_ml <span class="op">=</span> minimize(</span>
<span id="cb855-5"><a href="supplemental.html#cb855-5" aria-hidden="true" tabindex="-1"></a>  fun <span class="op">=</span> lm_ml,</span>
<span id="cb855-6"><a href="supplemental.html#cb855-6" aria-hidden="true" tabindex="-1"></a>  x0  <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb855-7"><a href="supplemental.html#cb855-7" aria-hidden="true" tabindex="-1"></a>  args    <span class="op">=</span> (X_mm, y),</span>
<span id="cb855-8"><a href="supplemental.html#cb855-8" aria-hidden="true" tabindex="-1"></a>  bounds  <span class="op">=</span> ((<span class="dv">0</span>, <span class="va">None</span>), (<span class="va">None</span>, <span class="va">None</span>), (<span class="va">None</span>, <span class="va">None</span>), (<span class="va">None</span>, <span class="va">None</span>)),</span>
<span id="cb855-9"><a href="supplemental.html#cb855-9" aria-hidden="true" tabindex="-1"></a>  method  <span class="op">=</span> <span class="st">&#39;L-BFGS-B&#39;</span>, </span>
<span id="cb855-10"><a href="supplemental.html#cb855-10" aria-hidden="true" tabindex="-1"></a>  tol     <span class="op">=</span> <span class="fl">1e-12</span>, </span>
<span id="cb855-11"><a href="supplemental.html#cb855-11" aria-hidden="true" tabindex="-1"></a>  options <span class="op">=</span> {<span class="st">&#39;maxiter&#39;</span>: <span class="dv">500</span>}</span>
<span id="cb855-12"><a href="supplemental.html#cb855-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb855-13"><a href="supplemental.html#cb855-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb855-14"><a href="supplemental.html#cb855-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb855-15"><a href="supplemental.html#cb855-15" aria-hidden="true" tabindex="-1"></a><span class="co"># can use least_squares directly</span></span>
<span id="cb855-16"><a href="supplemental.html#cb855-16" aria-hidden="true" tabindex="-1"></a><span class="co"># from scipy.optimize import least_squares</span></span>
<span id="cb855-17"><a href="supplemental.html#cb855-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb855-18"><a href="supplemental.html#cb855-18" aria-hidden="true" tabindex="-1"></a>fit_ls <span class="op">=</span> minimize(</span>
<span id="cb855-19"><a href="supplemental.html#cb855-19" aria-hidden="true" tabindex="-1"></a>  lm_ls,</span>
<span id="cb855-20"><a href="supplemental.html#cb855-20" aria-hidden="true" tabindex="-1"></a>  x0   <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>]),</span>
<span id="cb855-21"><a href="supplemental.html#cb855-21" aria-hidden="true" tabindex="-1"></a>  args <span class="op">=</span> (X_mm, y), </span>
<span id="cb855-22"><a href="supplemental.html#cb855-22" aria-hidden="true" tabindex="-1"></a>  tol     <span class="op">=</span> <span class="fl">1e-12</span>, </span>
<span id="cb855-23"><a href="supplemental.html#cb855-23" aria-hidden="true" tabindex="-1"></a>  options <span class="op">=</span> {<span class="st">&#39;maxiter&#39;</span>: <span class="dv">500</span>}</span>
<span id="cb855-24"><a href="supplemental.html#cb855-24" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="comparison-59" class="section level5">
<h5>Comparison</h5>
<div class="sourceCode" id="cb856"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb856-1"><a href="supplemental.html#cb856-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb856-2"><a href="supplemental.html#cb856-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb856-3"><a href="supplemental.html#cb856-3" aria-hidden="true" tabindex="-1"></a>model_sm_ols <span class="op">=</span> smf.ols(<span class="st">&#39;y ~ X1 + X2&#39;</span>, data <span class="op">=</span> dfXy)</span>
<span id="cb856-4"><a href="supplemental.html#cb856-4" aria-hidden="true" tabindex="-1"></a>fit_sm_ols   <span class="op">=</span> model_sm_ols.fit()</span>
<span id="cb856-5"><a href="supplemental.html#cb856-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb856-6"><a href="supplemental.html#cb856-6" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(</span>
<span id="cb856-7"><a href="supplemental.html#cb856-7" aria-hidden="true" tabindex="-1"></a>  [</span>
<span id="cb856-8"><a href="supplemental.html#cb856-8" aria-hidden="true" tabindex="-1"></a>  np.append(fit_ml.x[<span class="dv">0</span>]<span class="op">**</span><span class="dv">2</span>, fit_ml.x[<span class="dv">1</span>:]), </span>
<span id="cb856-9"><a href="supplemental.html#cb856-9" aria-hidden="true" tabindex="-1"></a>  np.append(fit_ls.fun<span class="op">/</span>(N <span class="op">-</span> X_mm.shape[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>), fit_ls.x), </span>
<span id="cb856-10"><a href="supplemental.html#cb856-10" aria-hidden="true" tabindex="-1"></a>  np.append(fit_sm_ols.scale, fit_sm_ols.params)</span>
<span id="cb856-11"><a href="supplemental.html#cb856-11" aria-hidden="true" tabindex="-1"></a>  ], </span>
<span id="cb856-12"><a href="supplemental.html#cb856-12" aria-hidden="true" tabindex="-1"></a>  columns <span class="op">=</span> [<span class="st">&#39;sigma&#39;</span>,<span class="st">&#39;Int&#39;</span>, <span class="st">&#39;b_X1&#39;</span>, <span class="st">&#39;b_X2&#39;</span>], </span>
<span id="cb856-13"><a href="supplemental.html#cb856-13" aria-hidden="true" tabindex="-1"></a>  index   <span class="op">=</span> [<span class="st">&#39;ML&#39;</span>, <span class="st">&#39;OLS&#39;</span>, <span class="st">&#39;SM&#39;</span>]</span>
<span id="cb856-14"><a href="supplemental.html#cb856-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
</div>
<div id="python-logreg" class="section level4">
<h4>Logistic Regression</h4>
<div id="data-setup-55" class="section level5">
<h5>Data Setup</h5>
<div class="sourceCode" id="cb857"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb857-1"><a href="supplemental.html#cb857-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb857-2"><a href="supplemental.html#cb857-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb857-3"><a href="supplemental.html#cb857-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> logistic, binom</span>
<span id="cb857-4"><a href="supplemental.html#cb857-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb857-5"><a href="supplemental.html#cb857-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb857-6"><a href="supplemental.html#cb857-6" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">123</span>) <span class="co"># ensures replication</span></span>
<span id="cb857-7"><a href="supplemental.html#cb857-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb857-8"><a href="supplemental.html#cb857-8" aria-hidden="true" tabindex="-1"></a><span class="co"># predictors and response</span></span>
<span id="cb857-9"><a href="supplemental.html#cb857-9" aria-hidden="true" tabindex="-1"></a><span class="co"># increasing N will get estimated values closer to the known parameters</span></span>
<span id="cb857-10"><a href="supplemental.html#cb857-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb857-11"><a href="supplemental.html#cb857-11" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">2500</span> <span class="co"># sample size</span></span>
<span id="cb857-12"><a href="supplemental.html#cb857-12" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">2</span>   <span class="co"># number of desired predictors</span></span>
<span id="cb857-13"><a href="supplemental.html#cb857-13" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.matrix(np.random.normal(size <span class="op">=</span> N <span class="op">*</span> k)).reshape(N, k) </span>
<span id="cb857-14"><a href="supplemental.html#cb857-14" aria-hidden="true" tabindex="-1"></a>eta <span class="op">=</span> <span class="op">-</span><span class="fl">.5</span> <span class="op">+</span> <span class="fl">.2</span><span class="op">*</span>X[:, <span class="dv">0</span>] <span class="op">+</span> <span class="fl">.1</span><span class="op">*</span>X[:, <span class="dv">1</span>]</span>
<span id="cb857-15"><a href="supplemental.html#cb857-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb857-16"><a href="supplemental.html#cb857-16" aria-hidden="true" tabindex="-1"></a>pi <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>eta))</span>
<span id="cb857-17"><a href="supplemental.html#cb857-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb857-18"><a href="supplemental.html#cb857-18" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.random.binomial(<span class="dv">1</span>, p <span class="op">=</span> pi, size <span class="op">=</span> (N, <span class="dv">1</span>))</span>
<span id="cb857-19"><a href="supplemental.html#cb857-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb857-20"><a href="supplemental.html#cb857-20" aria-hidden="true" tabindex="-1"></a>dfXy <span class="op">=</span> pd.DataFrame(np.column_stack([X, y]), columns <span class="op">=</span> [<span class="st">&#39;X1&#39;</span>, <span class="st">&#39;X2&#39;</span>, <span class="st">&#39;y&#39;</span>])</span></code></pre></div>
</div>
<div id="functions-14" class="section level5">
<h5>Functions</h5>
<p>A maximum likelihood approach.</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb858-1"><a href="supplemental.html#cb858-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> logreg_ml(par, X, y):</span>
<span id="cb858-2"><a href="supplemental.html#cb858-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># par: parameters to be estimated</span></span>
<span id="cb858-3"><a href="supplemental.html#cb858-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X: predictor matrix with intercept column</span></span>
<span id="cb858-4"><a href="supplemental.html#cb858-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y: response</span></span>
<span id="cb858-5"><a href="supplemental.html#cb858-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb858-6"><a href="supplemental.html#cb858-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setup</span></span>
<span id="cb858-7"><a href="supplemental.html#cb858-7" aria-hidden="true" tabindex="-1"></a>  beta   <span class="op">=</span> par.reshape(X.shape[<span class="dv">1</span>], <span class="dv">1</span>)             <span class="co"># coefficients</span></span>
<span id="cb858-8"><a href="supplemental.html#cb858-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># N = X.shape[0]</span></span>
<span id="cb858-9"><a href="supplemental.html#cb858-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb858-10"><a href="supplemental.html#cb858-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear predictor</span></span>
<span id="cb858-11"><a href="supplemental.html#cb858-11" aria-hidden="true" tabindex="-1"></a>  LP <span class="op">=</span> np.dot(X, beta)                              <span class="co"># linear predictor</span></span>
<span id="cb858-12"><a href="supplemental.html#cb858-12" aria-hidden="true" tabindex="-1"></a>  mu <span class="op">=</span> <span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span> np.exp(<span class="op">-</span>LP))                   <span class="co"># logit link</span></span>
<span id="cb858-13"><a href="supplemental.html#cb858-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb858-14"><a href="supplemental.html#cb858-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate likelihood</span></span>
<span id="cb858-15"><a href="supplemental.html#cb858-15" aria-hidden="true" tabindex="-1"></a>  L <span class="op">=</span> binom.logpmf(y, <span class="dv">1</span>, mu) <span class="co"># log likelihood</span></span>
<span id="cb858-16"><a href="supplemental.html#cb858-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb858-17"><a href="supplemental.html#cb858-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># L =  np.multiply(y, np.log(mu)) + np.multiply(1 - y, np.log(1 - mu))    # alternate log likelihood form</span></span>
<span id="cb858-18"><a href="supplemental.html#cb858-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb858-19"><a href="supplemental.html#cb858-19" aria-hidden="true" tabindex="-1"></a>  L <span class="op">=</span> <span class="op">-</span>np.<span class="bu">sum</span>(L)       <span class="co"># optim by default is minimization, and we want to maximize the likelihood </span></span>
<span id="cb858-20"><a href="supplemental.html#cb858-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb858-21"><a href="supplemental.html#cb858-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(L)</span></code></pre></div>
<p>Another approach via exponential loss function.</p>
<div class="sourceCode" id="cb859"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb859-1"><a href="supplemental.html#cb859-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> logreg_exp(par, X, y):</span>
<span id="cb859-2"><a href="supplemental.html#cb859-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments</span></span>
<span id="cb859-3"><a href="supplemental.html#cb859-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># par: parameters to be estimated</span></span>
<span id="cb859-4"><a href="supplemental.html#cb859-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X: predictor matrix with intercept column</span></span>
<span id="cb859-5"><a href="supplemental.html#cb859-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># y: target</span></span>
<span id="cb859-6"><a href="supplemental.html#cb859-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb859-7"><a href="supplemental.html#cb859-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># setup</span></span>
<span id="cb859-8"><a href="supplemental.html#cb859-8" aria-hidden="true" tabindex="-1"></a>  beta <span class="op">=</span> par.reshape(X.shape[<span class="dv">1</span>], <span class="dv">1</span>)                                    <span class="co"># coefficients</span></span>
<span id="cb859-9"><a href="supplemental.html#cb859-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb859-10"><a href="supplemental.html#cb859-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># linear predictor</span></span>
<span id="cb859-11"><a href="supplemental.html#cb859-11" aria-hidden="true" tabindex="-1"></a>  LP <span class="op">=</span> np.dot(X, beta)                              <span class="co"># linear predictor</span></span>
<span id="cb859-12"><a href="supplemental.html#cb859-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb859-13"><a href="supplemental.html#cb859-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate exponential loss function (convert y to -1:1 from 0:1)</span></span>
<span id="cb859-14"><a href="supplemental.html#cb859-14" aria-hidden="true" tabindex="-1"></a>  L <span class="op">=</span> np.<span class="bu">sum</span>(np.exp(<span class="op">-</span>np.multiply(np.where(y, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>), LP) <span class="op">*</span> <span class="fl">.5</span>))</span>
<span id="cb859-15"><a href="supplemental.html#cb859-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb859-16"><a href="supplemental.html#cb859-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(L)</span></code></pre></div>
</div>
<div id="estimation-54" class="section level5">
<h5>Estimation</h5>
<p>Setup for use with <span class="func" style="">optim</span>.</p>
<div class="sourceCode" id="cb860"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb860-1"><a href="supplemental.html#cb860-1" aria-hidden="true" tabindex="-1"></a>X_mm <span class="op">=</span> np.column_stack([np.repeat(<span class="dv">1</span>, N).reshape(N, <span class="dv">1</span>), X])</span>
<span id="cb860-2"><a href="supplemental.html#cb860-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-3"><a href="supplemental.html#cb860-3" aria-hidden="true" tabindex="-1"></a>fit_ml <span class="op">=</span> minimize(</span>
<span id="cb860-4"><a href="supplemental.html#cb860-4" aria-hidden="true" tabindex="-1"></a>  fun <span class="op">=</span> logreg_ml,</span>
<span id="cb860-5"><a href="supplemental.html#cb860-5" aria-hidden="true" tabindex="-1"></a>  x0  <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb860-6"><a href="supplemental.html#cb860-6" aria-hidden="true" tabindex="-1"></a>  args    <span class="op">=</span> (X_mm, y),</span>
<span id="cb860-7"><a href="supplemental.html#cb860-7" aria-hidden="true" tabindex="-1"></a>  method  <span class="op">=</span> <span class="st">&#39;BFGS&#39;</span>, </span>
<span id="cb860-8"><a href="supplemental.html#cb860-8" aria-hidden="true" tabindex="-1"></a>  tol     <span class="op">=</span> <span class="fl">1e-12</span>, </span>
<span id="cb860-9"><a href="supplemental.html#cb860-9" aria-hidden="true" tabindex="-1"></a>  options <span class="op">=</span> {<span class="st">&#39;maxiter&#39;</span>: <span class="dv">500</span>}</span>
<span id="cb860-10"><a href="supplemental.html#cb860-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb860-11"><a href="supplemental.html#cb860-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-12"><a href="supplemental.html#cb860-12" aria-hidden="true" tabindex="-1"></a>fit_exp <span class="op">=</span> minimize(</span>
<span id="cb860-13"><a href="supplemental.html#cb860-13" aria-hidden="true" tabindex="-1"></a>  fun <span class="op">=</span> logreg_exp,</span>
<span id="cb860-14"><a href="supplemental.html#cb860-14" aria-hidden="true" tabindex="-1"></a>  x0  <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb860-15"><a href="supplemental.html#cb860-15" aria-hidden="true" tabindex="-1"></a>  args    <span class="op">=</span> (X_mm, y),</span>
<span id="cb860-16"><a href="supplemental.html#cb860-16" aria-hidden="true" tabindex="-1"></a>  method  <span class="op">=</span> <span class="st">&#39;BFGS&#39;</span>, </span>
<span id="cb860-17"><a href="supplemental.html#cb860-17" aria-hidden="true" tabindex="-1"></a>  tol     <span class="op">=</span> <span class="fl">1e-12</span>, </span>
<span id="cb860-18"><a href="supplemental.html#cb860-18" aria-hidden="true" tabindex="-1"></a>  options <span class="op">=</span> {<span class="st">&#39;maxiter&#39;</span>: <span class="dv">500</span>}</span>
<span id="cb860-19"><a href="supplemental.html#cb860-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb860-20"><a href="supplemental.html#cb860-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb860-21"><a href="supplemental.html#cb860-21" aria-hidden="true" tabindex="-1"></a>pars_ml  <span class="op">=</span> fit_ml.x</span>
<span id="cb860-22"><a href="supplemental.html#cb860-22" aria-hidden="true" tabindex="-1"></a>pars_exp <span class="op">=</span> fit_exp.x</span></code></pre></div>
</div>
<div id="comparison-60" class="section level5">
<h5>Comparison</h5>
<div class="sourceCode" id="cb861"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb861-1"><a href="supplemental.html#cb861-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb861-2"><a href="supplemental.html#cb861-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-3"><a href="supplemental.html#cb861-3" aria-hidden="true" tabindex="-1"></a>model_sm_glm <span class="op">=</span> smf.logit(<span class="st">&#39;y ~ X1 + X2&#39;</span>, data <span class="op">=</span> dfXy)</span>
<span id="cb861-4"><a href="supplemental.html#cb861-4" aria-hidden="true" tabindex="-1"></a>fit_sm_glm   <span class="op">=</span> model_sm_glm.fit()</span>
<span id="cb861-5"><a href="supplemental.html#cb861-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb861-6"><a href="supplemental.html#cb861-6" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(</span>
<span id="cb861-7"><a href="supplemental.html#cb861-7" aria-hidden="true" tabindex="-1"></a>  [</span>
<span id="cb861-8"><a href="supplemental.html#cb861-8" aria-hidden="true" tabindex="-1"></a>  pars_ml, </span>
<span id="cb861-9"><a href="supplemental.html#cb861-9" aria-hidden="true" tabindex="-1"></a>  pars_exp, </span>
<span id="cb861-10"><a href="supplemental.html#cb861-10" aria-hidden="true" tabindex="-1"></a>  fit_sm_glm.params</span>
<span id="cb861-11"><a href="supplemental.html#cb861-11" aria-hidden="true" tabindex="-1"></a>  ], </span>
<span id="cb861-12"><a href="supplemental.html#cb861-12" aria-hidden="true" tabindex="-1"></a>  columns <span class="op">=</span> [<span class="st">&#39;Int&#39;</span>, <span class="st">&#39;b_X1&#39;</span>, <span class="st">&#39;b_X2&#39;</span>], </span>
<span id="cb861-13"><a href="supplemental.html#cb861-13" aria-hidden="true" tabindex="-1"></a>  index   <span class="op">=</span> [<span class="st">&#39;fit_ml&#39;</span>, <span class="st">&#39;fit_exp&#39;</span>, <span class="st">&#39;SM&#39;</span>]</span>
<span id="cb861-14"><a href="supplemental.html#cb861-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
</div>
</div>
<div id="python-qreg" class="section level4">
<h4>Quantile Regression</h4>
<p>See the <a href="supplemental.html#python-qreg">R chapter</a> for details.</p>
<div id="data-setup-56" class="section level5">
<h5>Data Setup</h5>
<div class="sourceCode" id="cb862"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb862-1"><a href="supplemental.html#cb862-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb862-2"><a href="supplemental.html#cb862-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb862-3"><a href="supplemental.html#cb862-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb862-4"><a href="supplemental.html#cb862-4" aria-hidden="true" tabindex="-1"></a><span class="co"># originally from quantreg package</span></span>
<span id="cb862-5"><a href="supplemental.html#cb862-5" aria-hidden="true" tabindex="-1"></a>engel <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/engel.csv&#39;</span>)</span>
<span id="cb862-6"><a href="supplemental.html#cb862-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb862-7"><a href="supplemental.html#cb862-7" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.column_stack([</span>
<span id="cb862-8"><a href="supplemental.html#cb862-8" aria-hidden="true" tabindex="-1"></a>  np.ones((engel.shape[<span class="dv">0</span>],<span class="dv">1</span>)),</span>
<span id="cb862-9"><a href="supplemental.html#cb862-9" aria-hidden="true" tabindex="-1"></a>  np.asarray(engel[<span class="st">&#39;income&#39;</span>])</span>
<span id="cb862-10"><a href="supplemental.html#cb862-10" aria-hidden="true" tabindex="-1"></a>  ])</span>
<span id="cb862-11"><a href="supplemental.html#cb862-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb862-12"><a href="supplemental.html#cb862-12" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.asarray(engel[<span class="st">&#39;foodexp&#39;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb863"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb863-1"><a href="supplemental.html#cb863-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> qreg(par, X, y, tau):</span>
<span id="cb863-2"><a href="supplemental.html#cb863-2" aria-hidden="true" tabindex="-1"></a>  lp <span class="op">=</span> np.dot(X, par)</span>
<span id="cb863-3"><a href="supplemental.html#cb863-3" aria-hidden="true" tabindex="-1"></a>  res <span class="op">=</span> y <span class="op">-</span> lp</span>
<span id="cb863-4"><a href="supplemental.html#cb863-4" aria-hidden="true" tabindex="-1"></a>  loss <span class="op">=</span> np.where(res <span class="op">&lt;</span> <span class="dv">0</span> , <span class="op">-</span>(<span class="dv">1</span> <span class="op">-</span> tau)<span class="op">*</span>res, tau<span class="op">*</span>res)</span>
<span id="cb863-5"><a href="supplemental.html#cb863-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb863-6"><a href="supplemental.html#cb863-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>(np.<span class="bu">sum</span>(loss))</span></code></pre></div>
</div>
<div id="estimation-55" class="section level5">
<h5>Estimation</h5>
<p>We’ll estimate the median to start.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb864-1"><a href="supplemental.html#cb864-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from scipy.stats import logistic, binom</span></span>
<span id="cb864-2"><a href="supplemental.html#cb864-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb864-3"><a href="supplemental.html#cb864-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb864-4"><a href="supplemental.html#cb864-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb864-5"><a href="supplemental.html#cb864-5" aria-hidden="true" tabindex="-1"></a>minimize(</span>
<span id="cb864-6"><a href="supplemental.html#cb864-6" aria-hidden="true" tabindex="-1"></a>  fun <span class="op">=</span> qreg,</span>
<span id="cb864-7"><a href="supplemental.html#cb864-7" aria-hidden="true" tabindex="-1"></a>  x0  <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb864-8"><a href="supplemental.html#cb864-8" aria-hidden="true" tabindex="-1"></a>  args    <span class="op">=</span> (X, y, <span class="fl">.5</span>),</span>
<span id="cb864-9"><a href="supplemental.html#cb864-9" aria-hidden="true" tabindex="-1"></a>  method  <span class="op">=</span> <span class="st">&#39;BFGS&#39;</span>, </span>
<span id="cb864-10"><a href="supplemental.html#cb864-10" aria-hidden="true" tabindex="-1"></a>  tol     <span class="op">=</span> <span class="fl">1e-12</span>, </span>
<span id="cb864-11"><a href="supplemental.html#cb864-11" aria-hidden="true" tabindex="-1"></a>  options <span class="op">=</span> {<span class="st">&#39;maxiter&#39;</span>: <span class="dv">500</span>}</span>
<span id="cb864-12"><a href="supplemental.html#cb864-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="other-quantiles-1" class="section level5">
<h5>Other quantiles</h5>
<p>Now we will add additional quantiles to estimate.</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb865-1"><a href="supplemental.html#cb865-1" aria-hidden="true" tabindex="-1"></a>pandas <span class="im">as</span> pd</span>
<span id="cb865-2"><a href="supplemental.html#cb865-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb865-3"><a href="supplemental.html#cb865-3" aria-hidden="true" tabindex="-1"></a><span class="co"># quantiles</span></span>
<span id="cb865-4"><a href="supplemental.html#cb865-4" aria-hidden="true" tabindex="-1"></a>qs <span class="op">=</span> [<span class="fl">.05</span>, <span class="fl">.1</span>, <span class="fl">.25</span>, <span class="fl">.5</span>, <span class="fl">.75</span>, <span class="fl">.9</span>, <span class="fl">.95</span>]</span>
<span id="cb865-5"><a href="supplemental.html#cb865-5" aria-hidden="true" tabindex="-1"></a>fit <span class="op">=</span> []</span>
<span id="cb865-6"><a href="supplemental.html#cb865-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb865-7"><a href="supplemental.html#cb865-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> tau <span class="kw">in</span> qs:</span>
<span id="cb865-8"><a href="supplemental.html#cb865-8" aria-hidden="true" tabindex="-1"></a>  init <span class="op">=</span> minimize(</span>
<span id="cb865-9"><a href="supplemental.html#cb865-9" aria-hidden="true" tabindex="-1"></a>    fun <span class="op">=</span> qreg,</span>
<span id="cb865-10"><a href="supplemental.html#cb865-10" aria-hidden="true" tabindex="-1"></a>    x0  <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb865-11"><a href="supplemental.html#cb865-11" aria-hidden="true" tabindex="-1"></a>    args    <span class="op">=</span> (X, y, tau),</span>
<span id="cb865-12"><a href="supplemental.html#cb865-12" aria-hidden="true" tabindex="-1"></a>    method  <span class="op">=</span> <span class="st">&#39;BFGS&#39;</span>, </span>
<span id="cb865-13"><a href="supplemental.html#cb865-13" aria-hidden="true" tabindex="-1"></a>    tol     <span class="op">=</span> <span class="fl">1e-12</span>, </span>
<span id="cb865-14"><a href="supplemental.html#cb865-14" aria-hidden="true" tabindex="-1"></a>    options <span class="op">=</span> {<span class="st">&#39;maxiter&#39;</span>: <span class="dv">500</span>}</span>
<span id="cb865-15"><a href="supplemental.html#cb865-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb865-16"><a href="supplemental.html#cb865-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb865-17"><a href="supplemental.html#cb865-17" aria-hidden="true" tabindex="-1"></a>  fit.append(</span>
<span id="cb865-18"><a href="supplemental.html#cb865-18" aria-hidden="true" tabindex="-1"></a>    pd.DataFrame(init.x.reshape(<span class="dv">1</span>,<span class="dv">2</span>),  columns <span class="op">=</span> [<span class="st">&#39;int&#39;</span>, <span class="st">&#39;slope&#39;</span>])</span>
<span id="cb865-19"><a href="supplemental.html#cb865-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb865-20"><a href="supplemental.html#cb865-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb865-21"><a href="supplemental.html#cb865-21" aria-hidden="true" tabindex="-1"></a>fit_qr <span class="op">=</span> pd.concat(fit)</span>
<span id="cb865-22"><a href="supplemental.html#cb865-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb865-23"><a href="supplemental.html#cb865-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb865-24"><a href="supplemental.html#cb865-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> <span class="op">*</span></span>
<span id="cb865-25"><a href="supplemental.html#cb865-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb865-26"><a href="supplemental.html#cb865-26" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb865-27"><a href="supplemental.html#cb865-27" aria-hidden="true" tabindex="-1"></a>  ggplot(aes(x <span class="op">=</span> <span class="st">&#39;income&#39;</span>, y <span class="op">=</span> <span class="st">&#39;foodexp&#39;</span>), data <span class="op">=</span> engel) <span class="op">+</span></span>
<span id="cb865-28"><a href="supplemental.html#cb865-28" aria-hidden="true" tabindex="-1"></a>    geom_point() <span class="op">+</span></span>
<span id="cb865-29"><a href="supplemental.html#cb865-29" aria-hidden="true" tabindex="-1"></a>    geom_abline(aes(intercept <span class="op">=</span> <span class="st">&#39;int&#39;</span>, slope <span class="op">=</span> <span class="st">&#39;slope&#39;</span>, color <span class="op">=</span> <span class="st">&#39;int&#39;</span>), </span>
<span id="cb865-30"><a href="supplemental.html#cb865-30" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> fit_qr)</span>
<span id="cb865-31"><a href="supplemental.html#cb865-31" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="python-sgd" class="section level4">
<h4>Stochastic Gradient Descent</h4>
<p>Here we use the <em>adagrad</em> approach as in the R demo. The dataset shift and other variants are not demonstrated.</p>
<div id="data-setup-57" class="section level5">
<h5>Data Setup</h5>
<p>Create some data for a standard linear regression.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb866-1"><a href="supplemental.html#cb866-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb866-2"><a href="supplemental.html#cb866-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb866-3"><a href="supplemental.html#cb866-3" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">1234</span>)</span>
<span id="cb866-4"><a href="supplemental.html#cb866-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb866-5"><a href="supplemental.html#cb866-5" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb866-6"><a href="supplemental.html#cb866-6" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> np.random.normal(size <span class="op">=</span> n)</span>
<span id="cb866-7"><a href="supplemental.html#cb866-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> np.random.normal(size <span class="op">=</span> n)</span>
<span id="cb866-8"><a href="supplemental.html#cb866-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> <span class="fl">.5</span><span class="op">*</span>x1 <span class="op">+</span> <span class="fl">.2</span><span class="op">*</span>x2 <span class="op">+</span> np.random.normal(size <span class="op">=</span> n)</span>
<span id="cb866-9"><a href="supplemental.html#cb866-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb866-10"><a href="supplemental.html#cb866-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.column_stack([np.ones(n), x1, x2])</span></code></pre></div>
</div>
<div id="function-34" class="section level5">
<h5>Function</h5>
<p>The estimating function using the <em>adagrad</em> approach.</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb867-1"><a href="supplemental.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sgd(par, X, y, stepsize, stepsize_tau <span class="op">=</span> <span class="dv">0</span>, average <span class="op">=</span> <span class="va">False</span>):</span>
<span id="cb867-2"><a href="supplemental.html#cb867-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">&quot;&quot;&quot;</span></span>
<span id="cb867-3"><a href="supplemental.html#cb867-3" aria-hidden="true" tabindex="-1"></a><span class="co">  Estimate a linear regression via stochastic gradient descent</span></span>
<span id="cb867-4"><a href="supplemental.html#cb867-4" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb867-5"><a href="supplemental.html#cb867-5" aria-hidden="true" tabindex="-1"></a><span class="co">  par: parameter estimates</span></span>
<span id="cb867-6"><a href="supplemental.html#cb867-6" aria-hidden="true" tabindex="-1"></a><span class="co">  X: model matrix</span></span>
<span id="cb867-7"><a href="supplemental.html#cb867-7" aria-hidden="true" tabindex="-1"></a><span class="co">  y: target variable</span></span>
<span id="cb867-8"><a href="supplemental.html#cb867-8" aria-hidden="true" tabindex="-1"></a><span class="co">  stepsize: the learning rate</span></span>
<span id="cb867-9"><a href="supplemental.html#cb867-9" aria-hidden="true" tabindex="-1"></a><span class="co">  stepsize_tau: if &gt; 0, a check on the LR at early iterations</span></span>
<span id="cb867-10"><a href="supplemental.html#cb867-10" aria-hidden="true" tabindex="-1"></a><span class="co">  average: an alternative method</span></span>
<span id="cb867-11"><a href="supplemental.html#cb867-11" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb867-12"><a href="supplemental.html#cb867-12" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns a dictionary of the parameter estimates, the estimates for each iteration,</span></span>
<span id="cb867-13"><a href="supplemental.html#cb867-13" aria-hidden="true" tabindex="-1"></a><span class="co">  the loss for each iteration, the root mean square error, and the fitted values</span></span>
<span id="cb867-14"><a href="supplemental.html#cb867-14" aria-hidden="true" tabindex="-1"></a><span class="co">  using the final parameter estimates</span></span>
<span id="cb867-15"><a href="supplemental.html#cb867-15" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb867-16"><a href="supplemental.html#cb867-16" aria-hidden="true" tabindex="-1"></a><span class="co">  &quot;&quot;&quot;</span></span>
<span id="cb867-17"><a href="supplemental.html#cb867-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb867-18"><a href="supplemental.html#cb867-18" aria-hidden="true" tabindex="-1"></a>  beta <span class="op">=</span> par</span>
<span id="cb867-19"><a href="supplemental.html#cb867-19" aria-hidden="true" tabindex="-1"></a>  betamat <span class="op">=</span> np.zeros_like(X)</span>
<span id="cb867-20"><a href="supplemental.html#cb867-20" aria-hidden="true" tabindex="-1"></a>  fits <span class="op">=</span> np.zeros_like(y)              <span class="co"># if you want these across iterations</span></span>
<span id="cb867-21"><a href="supplemental.html#cb867-21" aria-hidden="true" tabindex="-1"></a>  loss <span class="op">=</span> np.zeros_like(y)</span>
<span id="cb867-22"><a href="supplemental.html#cb867-22" aria-hidden="true" tabindex="-1"></a>  s <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb867-23"><a href="supplemental.html#cb867-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb867-24"><a href="supplemental.html#cb867-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> np.arange(X.shape[<span class="dv">0</span>]):</span>
<span id="cb867-25"><a href="supplemental.html#cb867-25" aria-hidden="true" tabindex="-1"></a>    Xi <span class="op">=</span> X[i]</span>
<span id="cb867-26"><a href="supplemental.html#cb867-26" aria-hidden="true" tabindex="-1"></a>    yi <span class="op">=</span> y[i]</span>
<span id="cb867-27"><a href="supplemental.html#cb867-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb867-28"><a href="supplemental.html#cb867-28" aria-hidden="true" tabindex="-1"></a>    LP   <span class="op">=</span> np.dot(Xi, beta)                                </span>
<span id="cb867-29"><a href="supplemental.html#cb867-29" aria-hidden="true" tabindex="-1"></a>    grad <span class="op">=</span> np.dot(Xi.T, LP <span class="op">-</span> yi)                           </span>
<span id="cb867-30"><a href="supplemental.html#cb867-30" aria-hidden="true" tabindex="-1"></a>    s    <span class="op">=</span> s <span class="op">+</span> grad<span class="op">**</span><span class="dv">2</span></span>
<span id="cb867-31"><a href="supplemental.html#cb867-31" aria-hidden="true" tabindex="-1"></a>    beta <span class="op">-=</span> stepsize <span class="op">*</span> grad<span class="op">/</span>(stepsize_tau <span class="op">+</span> np.sqrt(s)) </span>
<span id="cb867-32"><a href="supplemental.html#cb867-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb867-33"><a href="supplemental.html#cb867-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> average <span class="kw">and</span> i <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb867-34"><a href="supplemental.html#cb867-34" aria-hidden="true" tabindex="-1"></a>      beta <span class="op">-=</span> <span class="dv">1</span><span class="op">/</span>i <span class="op">*</span> (betamat[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> beta)</span>
<span id="cb867-35"><a href="supplemental.html#cb867-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb867-36"><a href="supplemental.html#cb867-36" aria-hidden="true" tabindex="-1"></a>    betamat[i] <span class="op">=</span> beta</span>
<span id="cb867-37"><a href="supplemental.html#cb867-37" aria-hidden="true" tabindex="-1"></a>    fits[i]    <span class="op">=</span> LP</span>
<span id="cb867-38"><a href="supplemental.html#cb867-38" aria-hidden="true" tabindex="-1"></a>    loss[i]    <span class="op">=</span> (LP <span class="op">-</span> yi)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb867-39"><a href="supplemental.html#cb867-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb867-40"><a href="supplemental.html#cb867-40" aria-hidden="true" tabindex="-1"></a>  LP <span class="op">=</span> np.dot(X, beta)</span>
<span id="cb867-41"><a href="supplemental.html#cb867-41" aria-hidden="true" tabindex="-1"></a>  lastloss <span class="op">=</span> np.dot(LP <span class="op">-</span> y, LP <span class="op">-</span> y)</span>
<span id="cb867-42"><a href="supplemental.html#cb867-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb867-43"><a href="supplemental.html#cb867-43" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span>({</span>
<span id="cb867-44"><a href="supplemental.html#cb867-44" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;par&#39;</span>: beta,                                 <span class="co"># final estimates</span></span>
<span id="cb867-45"><a href="supplemental.html#cb867-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;par_chain&#39;</span>: betamat,                        <span class="co"># all estimates</span></span>
<span id="cb867-46"><a href="supplemental.html#cb867-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;loss&#39;</span>: loss,                                <span class="co"># observation level loss</span></span>
<span id="cb867-47"><a href="supplemental.html#cb867-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;RMSE&#39;</span>: np.sqrt(np.<span class="bu">sum</span>(lastloss)<span class="op">/</span>X.shape[<span class="dv">0</span>]),</span>
<span id="cb867-48"><a href="supplemental.html#cb867-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;fitted&#39;</span>: LP</span>
<span id="cb867-49"><a href="supplemental.html#cb867-49" aria-hidden="true" tabindex="-1"></a>  })</span></code></pre></div>
<p>Set starting values and estimate. For any particular data you might have to fiddle with the <code>stepsize</code>, perhaps
choosing one based on cross-validation with old data.</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb868-1"><a href="supplemental.html#cb868-1" aria-hidden="true" tabindex="-1"></a>init <span class="op">=</span> np.zeros(<span class="dv">3</span>)</span>
<span id="cb868-2"><a href="supplemental.html#cb868-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-3"><a href="supplemental.html#cb868-3" aria-hidden="true" tabindex="-1"></a>fit_sgd <span class="op">=</span> sgd(</span>
<span id="cb868-4"><a href="supplemental.html#cb868-4" aria-hidden="true" tabindex="-1"></a>  init, </span>
<span id="cb868-5"><a href="supplemental.html#cb868-5" aria-hidden="true" tabindex="-1"></a>  X, </span>
<span id="cb868-6"><a href="supplemental.html#cb868-6" aria-hidden="true" tabindex="-1"></a>  y,</span>
<span id="cb868-7"><a href="supplemental.html#cb868-7" aria-hidden="true" tabindex="-1"></a>  stepsize <span class="op">=</span> <span class="fl">.1</span>,</span>
<span id="cb868-8"><a href="supplemental.html#cb868-8" aria-hidden="true" tabindex="-1"></a>  stepsize_tau <span class="op">=</span> <span class="fl">.5</span></span>
<span id="cb868-9"><a href="supplemental.html#cb868-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb868-10"><a href="supplemental.html#cb868-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb868-11"><a href="supplemental.html#cb868-11" aria-hidden="true" tabindex="-1"></a>fit_sgd[<span class="st">&#39;par&#39;</span>].<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb868-12"><a href="supplemental.html#cb868-12" aria-hidden="true" tabindex="-1"></a>fit_sgd[<span class="st">&#39;RMSE&#39;</span>].<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>
array([1.0172, 0.4942, 0.1937])    

0.9978
    </code></pre>
</div>
<div id="comparison-61" class="section level5">
<h5>Comparison</h5>
<p>We’ll compare our results to standard linear regression.</p>
<div class="sourceCode" id="cb870"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb870-1"><a href="supplemental.html#cb870-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb870-2"><a href="supplemental.html#cb870-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf</span>
<span id="cb870-3"><a href="supplemental.html#cb870-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-4"><a href="supplemental.html#cb870-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;x1&#39;</span>: x1, <span class="st">&#39;x2&#39;</span>: x2, <span class="st">&#39;y&#39;</span>: y})</span>
<span id="cb870-5"><a href="supplemental.html#cb870-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-6"><a href="supplemental.html#cb870-6" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="op">=</span> smf.ols(<span class="st">&#39;y ~ x1 + x2&#39;</span>, df).fit()</span>
<span id="cb870-7"><a href="supplemental.html#cb870-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb870-8"><a href="supplemental.html#cb870-8" aria-hidden="true" tabindex="-1"></a>lm_fit.params.<span class="bu">round</span>(<span class="dv">4</span>)</span>
<span id="cb870-9"><a href="supplemental.html#cb870-9" aria-hidden="true" tabindex="-1"></a>lm_fit.scale.<span class="bu">round</span>(<span class="dv">4</span>)</span></code></pre></div>
<pre><code>
Intercept    1.0037
x1           0.5032
x2           0.2000
dtype: float64   

0.9955
    </code></pre>
</div>
</div>
<div id="python-nelder" class="section level4">
<h4>Nelder-Mead</h4>
<div class="sourceCode" id="cb872"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb872-1"><a href="supplemental.html#cb872-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> copy</span>
<span id="cb872-2"><a href="supplemental.html#cb872-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-3"><a href="supplemental.html#cb872-3" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb872-4"><a href="supplemental.html#cb872-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Francois Chollet&#39;s Nelder-Mead in Python.</span></span>
<span id="cb872-5"><a href="supplemental.html#cb872-5" aria-hidden="true" tabindex="-1"></a><span class="co">    https://github.com/fchollet/nelder-mead/blob/master/nelder_mead.py</span></span>
<span id="cb872-6"><a href="supplemental.html#cb872-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Pure Python/Numpy implementation of the Nelder-Mead algorithm.</span></span>
<span id="cb872-7"><a href="supplemental.html#cb872-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Reference: https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method</span></span>
<span id="cb872-8"><a href="supplemental.html#cb872-8" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;&#39;&#39;</span></span>
<span id="cb872-9"><a href="supplemental.html#cb872-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-10"><a href="supplemental.html#cb872-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-11"><a href="supplemental.html#cb872-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nelder_mead(</span>
<span id="cb872-12"><a href="supplemental.html#cb872-12" aria-hidden="true" tabindex="-1"></a>  f,</span>
<span id="cb872-13"><a href="supplemental.html#cb872-13" aria-hidden="true" tabindex="-1"></a>  x_start,</span>
<span id="cb872-14"><a href="supplemental.html#cb872-14" aria-hidden="true" tabindex="-1"></a>  step <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span id="cb872-15"><a href="supplemental.html#cb872-15" aria-hidden="true" tabindex="-1"></a>  no_improve_thr  <span class="op">=</span> <span class="fl">10e-6</span>,</span>
<span id="cb872-16"><a href="supplemental.html#cb872-16" aria-hidden="true" tabindex="-1"></a>  no_improv_break <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb872-17"><a href="supplemental.html#cb872-17" aria-hidden="true" tabindex="-1"></a>  max_iter <span class="op">=</span> <span class="dv">0</span>,</span>
<span id="cb872-18"><a href="supplemental.html#cb872-18" aria-hidden="true" tabindex="-1"></a>  alpha <span class="op">=</span> <span class="fl">1.</span>,</span>
<span id="cb872-19"><a href="supplemental.html#cb872-19" aria-hidden="true" tabindex="-1"></a>  gamma <span class="op">=</span> <span class="fl">2.</span>,</span>
<span id="cb872-20"><a href="supplemental.html#cb872-20" aria-hidden="true" tabindex="-1"></a>  rho   <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span id="cb872-21"><a href="supplemental.html#cb872-21" aria-hidden="true" tabindex="-1"></a>  sigma <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb872-22"><a href="supplemental.html#cb872-22" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb872-23"><a href="supplemental.html#cb872-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">&#39;&#39;&#39;</span></span>
<span id="cb872-24"><a href="supplemental.html#cb872-24" aria-hidden="true" tabindex="-1"></a><span class="co">        @param f (function): function to optimize, must return a scalar score</span></span>
<span id="cb872-25"><a href="supplemental.html#cb872-25" aria-hidden="true" tabindex="-1"></a><span class="co">            and operate over a numpy array of the same dimensions as x_start</span></span>
<span id="cb872-26"><a href="supplemental.html#cb872-26" aria-hidden="true" tabindex="-1"></a><span class="co">        @param x_start (numpy array): initial position</span></span>
<span id="cb872-27"><a href="supplemental.html#cb872-27" aria-hidden="true" tabindex="-1"></a><span class="co">        @param step (float): look-around radius in initial step</span></span>
<span id="cb872-28"><a href="supplemental.html#cb872-28" aria-hidden="true" tabindex="-1"></a><span class="co">        @no_improv_thr,  no_improv_break (float, int): break after no_improv_break iterations with</span></span>
<span id="cb872-29"><a href="supplemental.html#cb872-29" aria-hidden="true" tabindex="-1"></a><span class="co">            an improvement lower than no_improv_thr</span></span>
<span id="cb872-30"><a href="supplemental.html#cb872-30" aria-hidden="true" tabindex="-1"></a><span class="co">        @max_iter (int): always break after this number of iterations.</span></span>
<span id="cb872-31"><a href="supplemental.html#cb872-31" aria-hidden="true" tabindex="-1"></a><span class="co">            Set it to 0 to loop indefinitely.</span></span>
<span id="cb872-32"><a href="supplemental.html#cb872-32" aria-hidden="true" tabindex="-1"></a><span class="co">        @alpha, gamma, rho, sigma (floats): parameters of the algorithm</span></span>
<span id="cb872-33"><a href="supplemental.html#cb872-33" aria-hidden="true" tabindex="-1"></a><span class="co">            (see Wikipedia page for reference)</span></span>
<span id="cb872-34"><a href="supplemental.html#cb872-34" aria-hidden="true" tabindex="-1"></a><span class="co">        return: tuple (best parameter array, best score)</span></span>
<span id="cb872-35"><a href="supplemental.html#cb872-35" aria-hidden="true" tabindex="-1"></a><span class="co">    &#39;&#39;&#39;</span></span>
<span id="cb872-36"><a href="supplemental.html#cb872-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-37"><a href="supplemental.html#cb872-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># init</span></span>
<span id="cb872-38"><a href="supplemental.html#cb872-38" aria-hidden="true" tabindex="-1"></a>    dim <span class="op">=</span> <span class="bu">len</span>(x_start)</span>
<span id="cb872-39"><a href="supplemental.html#cb872-39" aria-hidden="true" tabindex="-1"></a>    prev_best <span class="op">=</span> f(x_start)</span>
<span id="cb872-40"><a href="supplemental.html#cb872-40" aria-hidden="true" tabindex="-1"></a>    no_improv <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb872-41"><a href="supplemental.html#cb872-41" aria-hidden="true" tabindex="-1"></a>    res <span class="op">=</span> [[x_start, prev_best]]</span>
<span id="cb872-42"><a href="supplemental.html#cb872-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-43"><a href="supplemental.html#cb872-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(dim):</span>
<span id="cb872-44"><a href="supplemental.html#cb872-44" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> copy.copy(x_start)</span>
<span id="cb872-45"><a href="supplemental.html#cb872-45" aria-hidden="true" tabindex="-1"></a>        x[i] <span class="op">=</span> x[i] <span class="op">+</span> step</span>
<span id="cb872-46"><a href="supplemental.html#cb872-46" aria-hidden="true" tabindex="-1"></a>        score <span class="op">=</span> f(x)</span>
<span id="cb872-47"><a href="supplemental.html#cb872-47" aria-hidden="true" tabindex="-1"></a>        res.append([x, score])</span>
<span id="cb872-48"><a href="supplemental.html#cb872-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-49"><a href="supplemental.html#cb872-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># simplex iter</span></span>
<span id="cb872-50"><a href="supplemental.html#cb872-50" aria-hidden="true" tabindex="-1"></a>    iters <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb872-51"><a href="supplemental.html#cb872-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="dv">1</span>:</span>
<span id="cb872-52"><a href="supplemental.html#cb872-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># order</span></span>
<span id="cb872-53"><a href="supplemental.html#cb872-53" aria-hidden="true" tabindex="-1"></a>        res.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb872-54"><a href="supplemental.html#cb872-54" aria-hidden="true" tabindex="-1"></a>        best <span class="op">=</span> res[<span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb872-55"><a href="supplemental.html#cb872-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-56"><a href="supplemental.html#cb872-56" aria-hidden="true" tabindex="-1"></a>        <span class="co"># break after max_iter</span></span>
<span id="cb872-57"><a href="supplemental.html#cb872-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> max_iter <span class="kw">and</span> iters <span class="op">&gt;=</span> max_iter:</span>
<span id="cb872-58"><a href="supplemental.html#cb872-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> res[<span class="dv">0</span>]</span>
<span id="cb872-59"><a href="supplemental.html#cb872-59" aria-hidden="true" tabindex="-1"></a>        iters <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb872-60"><a href="supplemental.html#cb872-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-61"><a href="supplemental.html#cb872-61" aria-hidden="true" tabindex="-1"></a>        <span class="co"># break after no_improv_break iterations with no improvement</span></span>
<span id="cb872-62"><a href="supplemental.html#cb872-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> iters<span class="op">//</span><span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb872-63"><a href="supplemental.html#cb872-63" aria-hidden="true" tabindex="-1"></a>          <span class="bu">print</span>(<span class="st">&#39;...best so far:&#39;</span>, best)</span>
<span id="cb872-64"><a href="supplemental.html#cb872-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-65"><a href="supplemental.html#cb872-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> best <span class="op">&lt;</span> prev_best <span class="op">-</span> no_improve_thr:</span>
<span id="cb872-66"><a href="supplemental.html#cb872-66" aria-hidden="true" tabindex="-1"></a>            no_improv <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb872-67"><a href="supplemental.html#cb872-67" aria-hidden="true" tabindex="-1"></a>            prev_best <span class="op">=</span> best</span>
<span id="cb872-68"><a href="supplemental.html#cb872-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb872-69"><a href="supplemental.html#cb872-69" aria-hidden="true" tabindex="-1"></a>            no_improv <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb872-70"><a href="supplemental.html#cb872-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-71"><a href="supplemental.html#cb872-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> no_improv <span class="op">&gt;=</span> no_improv_break:</span>
<span id="cb872-72"><a href="supplemental.html#cb872-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> res[<span class="dv">0</span>]</span>
<span id="cb872-73"><a href="supplemental.html#cb872-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-74"><a href="supplemental.html#cb872-74" aria-hidden="true" tabindex="-1"></a>        <span class="co"># centroid</span></span>
<span id="cb872-75"><a href="supplemental.html#cb872-75" aria-hidden="true" tabindex="-1"></a>        x0 <span class="op">=</span> [<span class="fl">0.</span>] <span class="op">*</span> dim</span>
<span id="cb872-76"><a href="supplemental.html#cb872-76" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tup <span class="kw">in</span> res[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb872-77"><a href="supplemental.html#cb872-77" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(tup[<span class="dv">0</span>]):</span>
<span id="cb872-78"><a href="supplemental.html#cb872-78" aria-hidden="true" tabindex="-1"></a>                x0[i] <span class="op">+=</span> c <span class="op">/</span> (<span class="bu">len</span>(res)<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb872-79"><a href="supplemental.html#cb872-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-80"><a href="supplemental.html#cb872-80" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reflection</span></span>
<span id="cb872-81"><a href="supplemental.html#cb872-81" aria-hidden="true" tabindex="-1"></a>        xr <span class="op">=</span> x0 <span class="op">+</span> alpha<span class="op">*</span>(x0 <span class="op">-</span> res[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb872-82"><a href="supplemental.html#cb872-82" aria-hidden="true" tabindex="-1"></a>        rscore <span class="op">=</span> f(xr)</span>
<span id="cb872-83"><a href="supplemental.html#cb872-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> res[<span class="dv">0</span>][<span class="dv">1</span>] <span class="op">&lt;=</span> rscore <span class="op">&lt;</span> res[<span class="op">-</span><span class="dv">2</span>][<span class="dv">1</span>]:</span>
<span id="cb872-84"><a href="supplemental.html#cb872-84" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> res[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb872-85"><a href="supplemental.html#cb872-85" aria-hidden="true" tabindex="-1"></a>            res.append([xr, rscore])</span>
<span id="cb872-86"><a href="supplemental.html#cb872-86" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb872-87"><a href="supplemental.html#cb872-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-88"><a href="supplemental.html#cb872-88" aria-hidden="true" tabindex="-1"></a>        <span class="co"># expansion</span></span>
<span id="cb872-89"><a href="supplemental.html#cb872-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> rscore <span class="op">&lt;</span> res[<span class="dv">0</span>][<span class="dv">1</span>]:</span>
<span id="cb872-90"><a href="supplemental.html#cb872-90" aria-hidden="true" tabindex="-1"></a>            xe <span class="op">=</span> x0 <span class="op">+</span> gamma<span class="op">*</span>(x0 <span class="op">-</span> res[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb872-91"><a href="supplemental.html#cb872-91" aria-hidden="true" tabindex="-1"></a>            escore <span class="op">=</span> f(xe)</span>
<span id="cb872-92"><a href="supplemental.html#cb872-92" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> escore <span class="op">&lt;</span> rscore:</span>
<span id="cb872-93"><a href="supplemental.html#cb872-93" aria-hidden="true" tabindex="-1"></a>                <span class="kw">del</span> res[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb872-94"><a href="supplemental.html#cb872-94" aria-hidden="true" tabindex="-1"></a>                res.append([xe, escore])</span>
<span id="cb872-95"><a href="supplemental.html#cb872-95" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb872-96"><a href="supplemental.html#cb872-96" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb872-97"><a href="supplemental.html#cb872-97" aria-hidden="true" tabindex="-1"></a>                <span class="kw">del</span> res[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb872-98"><a href="supplemental.html#cb872-98" aria-hidden="true" tabindex="-1"></a>                res.append([xr, rscore])</span>
<span id="cb872-99"><a href="supplemental.html#cb872-99" aria-hidden="true" tabindex="-1"></a>                <span class="cf">continue</span></span>
<span id="cb872-100"><a href="supplemental.html#cb872-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-101"><a href="supplemental.html#cb872-101" aria-hidden="true" tabindex="-1"></a>        <span class="co"># contraction</span></span>
<span id="cb872-102"><a href="supplemental.html#cb872-102" aria-hidden="true" tabindex="-1"></a>        xc <span class="op">=</span> x0 <span class="op">+</span> rho<span class="op">*</span>(x0 <span class="op">-</span> res[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb872-103"><a href="supplemental.html#cb872-103" aria-hidden="true" tabindex="-1"></a>        cscore <span class="op">=</span> f(xc)</span>
<span id="cb872-104"><a href="supplemental.html#cb872-104" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cscore <span class="op">&lt;</span> res[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]:</span>
<span id="cb872-105"><a href="supplemental.html#cb872-105" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> res[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb872-106"><a href="supplemental.html#cb872-106" aria-hidden="true" tabindex="-1"></a>            res.append([xc, cscore])</span>
<span id="cb872-107"><a href="supplemental.html#cb872-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb872-108"><a href="supplemental.html#cb872-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-109"><a href="supplemental.html#cb872-109" aria-hidden="true" tabindex="-1"></a>        <span class="co"># reduction</span></span>
<span id="cb872-110"><a href="supplemental.html#cb872-110" aria-hidden="true" tabindex="-1"></a>        x1 <span class="op">=</span> res[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb872-111"><a href="supplemental.html#cb872-111" aria-hidden="true" tabindex="-1"></a>        nres <span class="op">=</span> []</span>
<span id="cb872-112"><a href="supplemental.html#cb872-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tup <span class="kw">in</span> res:</span>
<span id="cb872-113"><a href="supplemental.html#cb872-113" aria-hidden="true" tabindex="-1"></a>            redx <span class="op">=</span> x1 <span class="op">+</span> sigma<span class="op">*</span>(tup[<span class="dv">0</span>] <span class="op">-</span> x1)</span>
<span id="cb872-114"><a href="supplemental.html#cb872-114" aria-hidden="true" tabindex="-1"></a>            score <span class="op">=</span> f(redx)</span>
<span id="cb872-115"><a href="supplemental.html#cb872-115" aria-hidden="true" tabindex="-1"></a>            nres.append([redx, score])</span>
<span id="cb872-116"><a href="supplemental.html#cb872-116" aria-hidden="true" tabindex="-1"></a>        res <span class="op">=</span> nres</span>
<span id="cb872-117"><a href="supplemental.html#cb872-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-118"><a href="supplemental.html#cb872-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-119"><a href="supplemental.html#cb872-119" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">&quot;__main__&quot;</span>:</span>
<span id="cb872-120"><a href="supplemental.html#cb872-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># test</span></span>
<span id="cb872-121"><a href="supplemental.html#cb872-121" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> math</span>
<span id="cb872-122"><a href="supplemental.html#cb872-122" aria-hidden="true" tabindex="-1"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb872-123"><a href="supplemental.html#cb872-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-124"><a href="supplemental.html#cb872-124" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> f(x):</span>
<span id="cb872-125"><a href="supplemental.html#cb872-125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> math.sin(x[<span class="dv">0</span>]) <span class="op">*</span> math.cos(x[<span class="dv">1</span>]) <span class="op">*</span> (<span class="fl">1.</span> <span class="op">/</span> (<span class="bu">abs</span>(x[<span class="dv">2</span>]) <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb872-126"><a href="supplemental.html#cb872-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb872-127"><a href="supplemental.html#cb872-127" aria-hidden="true" tabindex="-1"></a>nelder_mead(f, np.array([<span class="fl">0.</span>, <span class="fl">0.</span>, <span class="fl">0.</span>]))</span></code></pre></div>
</div>
<div id="python-hmm" class="section level4">
<h4>HMM</h4>
<div class="sourceCode" id="cb873"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb873-1"><a href="supplemental.html#cb873-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/usr/bin/env python3</span></span>
<span id="cb873-2"><a href="supplemental.html#cb873-2" aria-hidden="true" tabindex="-1"></a><span class="co"># -*- coding: utf-8 -*-</span></span>
<span id="cb873-3"><a href="supplemental.html#cb873-3" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb873-4"><a href="supplemental.html#cb873-4" aria-hidden="true" tabindex="-1"></a><span class="co">From the wikipedia page with slight modification</span></span>
<span id="cb873-5"><a href="supplemental.html#cb873-5" aria-hidden="true" tabindex="-1"></a><span class="co">https://en.wikipedia.org/wiki/Viterbi_algorithm#Example</span></span>
<span id="cb873-6"><a href="supplemental.html#cb873-6" aria-hidden="true" tabindex="-1"></a><span class="co">&quot;&quot;&quot;</span></span>
<span id="cb873-7"><a href="supplemental.html#cb873-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-8"><a href="supplemental.html#cb873-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(obs, states, start_p, trans_p, emit_p):</span>
<span id="cb873-9"><a href="supplemental.html#cb873-9" aria-hidden="true" tabindex="-1"></a>    V <span class="op">=</span> [{}]</span>
<span id="cb873-10"><a href="supplemental.html#cb873-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-11"><a href="supplemental.html#cb873-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> st <span class="kw">in</span> states:</span>
<span id="cb873-12"><a href="supplemental.html#cb873-12" aria-hidden="true" tabindex="-1"></a>        V[<span class="dv">0</span>][st] <span class="op">=</span> {<span class="st">&quot;prob&quot;</span>: start_p[st] <span class="op">*</span> emit_p[st][obs[<span class="dv">0</span>]], <span class="st">&quot;prev&quot;</span>: <span class="va">None</span>}</span>
<span id="cb873-13"><a href="supplemental.html#cb873-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-14"><a href="supplemental.html#cb873-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Run Viterbi when t &gt; 0</span></span>
<span id="cb873-15"><a href="supplemental.html#cb873-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-16"><a href="supplemental.html#cb873-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(obs)):</span>
<span id="cb873-17"><a href="supplemental.html#cb873-17" aria-hidden="true" tabindex="-1"></a>        V.append({})</span>
<span id="cb873-18"><a href="supplemental.html#cb873-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-19"><a href="supplemental.html#cb873-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> st <span class="kw">in</span> states:</span>
<span id="cb873-20"><a href="supplemental.html#cb873-20" aria-hidden="true" tabindex="-1"></a>            max_tr_prob <span class="op">=</span> <span class="bu">max</span>(V[t<span class="op">-</span><span class="dv">1</span>][prev_st][<span class="st">&quot;prob&quot;</span>]<span class="op">*</span>trans_p[prev_st][st] <span class="cf">for</span> prev_st <span class="kw">in</span> states)</span>
<span id="cb873-21"><a href="supplemental.html#cb873-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-22"><a href="supplemental.html#cb873-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> prev_st <span class="kw">in</span> states:</span>
<span id="cb873-23"><a href="supplemental.html#cb873-23" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> V[t<span class="op">-</span><span class="dv">1</span>][prev_st][<span class="st">&quot;prob&quot;</span>] <span class="op">*</span> trans_p[prev_st][st] <span class="op">==</span> max_tr_prob:</span>
<span id="cb873-24"><a href="supplemental.html#cb873-24" aria-hidden="true" tabindex="-1"></a>                    max_prob <span class="op">=</span> max_tr_prob <span class="op">*</span> emit_p[st][obs[t]]</span>
<span id="cb873-25"><a href="supplemental.html#cb873-25" aria-hidden="true" tabindex="-1"></a>                    V[t][st] <span class="op">=</span> {<span class="st">&quot;prob&quot;</span>: max_prob, <span class="st">&quot;prev&quot;</span>: prev_st}</span>
<span id="cb873-26"><a href="supplemental.html#cb873-26" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">break</span></span>
<span id="cb873-27"><a href="supplemental.html#cb873-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-28"><a href="supplemental.html#cb873-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> dptable(V):</span>
<span id="cb873-29"><a href="supplemental.html#cb873-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(line)</span>
<span id="cb873-30"><a href="supplemental.html#cb873-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-31"><a href="supplemental.html#cb873-31" aria-hidden="true" tabindex="-1"></a>    opt <span class="op">=</span> []</span>
<span id="cb873-32"><a href="supplemental.html#cb873-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-33"><a href="supplemental.html#cb873-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># The highest probability</span></span>
<span id="cb873-34"><a href="supplemental.html#cb873-34" aria-hidden="true" tabindex="-1"></a>    max_prob <span class="op">=</span> <span class="bu">max</span>(value[<span class="st">&quot;prob&quot;</span>] <span class="cf">for</span> value <span class="kw">in</span> V[<span class="op">-</span><span class="dv">1</span>].values())</span>
<span id="cb873-35"><a href="supplemental.html#cb873-35" aria-hidden="true" tabindex="-1"></a>    previous <span class="op">=</span> <span class="va">None</span></span>
<span id="cb873-36"><a href="supplemental.html#cb873-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-37"><a href="supplemental.html#cb873-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get most probable state and its backtrack</span></span>
<span id="cb873-38"><a href="supplemental.html#cb873-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> st, data <span class="kw">in</span> V[<span class="op">-</span><span class="dv">1</span>].items():</span>
<span id="cb873-39"><a href="supplemental.html#cb873-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> data[<span class="st">&quot;prob&quot;</span>] <span class="op">==</span> max_prob:</span>
<span id="cb873-40"><a href="supplemental.html#cb873-40" aria-hidden="true" tabindex="-1"></a>            opt.append(st)</span>
<span id="cb873-41"><a href="supplemental.html#cb873-41" aria-hidden="true" tabindex="-1"></a>            previous <span class="op">=</span> st</span>
<span id="cb873-42"><a href="supplemental.html#cb873-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb873-43"><a href="supplemental.html#cb873-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-44"><a href="supplemental.html#cb873-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Follow the backtrack till the first observation</span></span>
<span id="cb873-45"><a href="supplemental.html#cb873-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(V) <span class="op">-</span> <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb873-46"><a href="supplemental.html#cb873-46" aria-hidden="true" tabindex="-1"></a>        opt.insert(<span class="dv">0</span>, V[t <span class="op">+</span> <span class="dv">1</span>][previous][<span class="st">&quot;prev&quot;</span>])</span>
<span id="cb873-47"><a href="supplemental.html#cb873-47" aria-hidden="true" tabindex="-1"></a>        previous <span class="op">=</span> V[t <span class="op">+</span> <span class="dv">1</span>][previous][<span class="st">&quot;prev&quot;</span>]</span>
<span id="cb873-48"><a href="supplemental.html#cb873-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-49"><a href="supplemental.html#cb873-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;The steps of states are &#39;</span> <span class="op">+</span> <span class="st">&#39; &#39;</span>.join(opt) <span class="op">+</span> <span class="st">&#39; with highest probability of </span><span class="sc">%s</span><span class="st">&#39;</span> <span class="op">%</span> max_prob)</span>
<span id="cb873-50"><a href="supplemental.html#cb873-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-51"><a href="supplemental.html#cb873-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-52"><a href="supplemental.html#cb873-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dptable(V):</span>
<span id="cb873-53"><a href="supplemental.html#cb873-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print a table of steps from dictionary</span></span>
<span id="cb873-54"><a href="supplemental.html#cb873-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="st">&quot; &quot;</span>.join((<span class="st">&quot;</span><span class="sc">%12d</span><span class="st">&quot;</span> <span class="op">%</span> i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(V)))</span>
<span id="cb873-55"><a href="supplemental.html#cb873-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb873-56"><a href="supplemental.html#cb873-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state <span class="kw">in</span> V[<span class="dv">0</span>]:</span>
<span id="cb873-57"><a href="supplemental.html#cb873-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="st">&quot;</span><span class="sc">%.7s</span><span class="st">: &quot;</span> <span class="op">%</span> state <span class="op">+</span> <span class="st">&quot; &quot;</span>.join(<span class="st">&quot;</span><span class="sc">%.7s</span><span class="st">&quot;</span> <span class="op">%</span> (<span class="st">&quot;</span><span class="sc">%f</span><span class="st">&quot;</span> <span class="op">%</span> v[state][<span class="st">&quot;prob&quot;</span>]) <span class="cf">for</span> v <span class="kw">in</span> V)</span>
<span id="cb873-58"><a href="supplemental.html#cb873-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-59"><a href="supplemental.html#cb873-59" aria-hidden="true" tabindex="-1"></a><span class="co"># The function viterbi takes the following arguments: obs is the sequence of</span></span>
<span id="cb873-60"><a href="supplemental.html#cb873-60" aria-hidden="true" tabindex="-1"></a><span class="co"># observations, e.g. [&#39;normal&#39;, &#39;cold&#39;, &#39;dizzy&#39;]; states is the set of hidden</span></span>
<span id="cb873-61"><a href="supplemental.html#cb873-61" aria-hidden="true" tabindex="-1"></a><span class="co"># states; start_p is the start probability; trans_p are the transition</span></span>
<span id="cb873-62"><a href="supplemental.html#cb873-62" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities; and emit_p are the emission probabilities. For simplicity of</span></span>
<span id="cb873-63"><a href="supplemental.html#cb873-63" aria-hidden="true" tabindex="-1"></a><span class="co"># code, we assume that the observation sequence obs is non-empty and that</span></span>
<span id="cb873-64"><a href="supplemental.html#cb873-64" aria-hidden="true" tabindex="-1"></a><span class="co"># trans_p[i][j] and emit_p[i][j] is defined for all states i,j.</span></span>
<span id="cb873-65"><a href="supplemental.html#cb873-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-66"><a href="supplemental.html#cb873-66" aria-hidden="true" tabindex="-1"></a><span class="co"># In the running example, the forward/Viterbi algorithm is used as follows:</span></span>
<span id="cb873-67"><a href="supplemental.html#cb873-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-68"><a href="supplemental.html#cb873-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-69"><a href="supplemental.html#cb873-69" aria-hidden="true" tabindex="-1"></a>obs <span class="op">=</span> (<span class="st">&#39;normal&#39;</span>, <span class="st">&#39;cold&#39;</span>, <span class="st">&#39;dizzy&#39;</span>)</span>
<span id="cb873-70"><a href="supplemental.html#cb873-70" aria-hidden="true" tabindex="-1"></a>states <span class="op">=</span> (<span class="st">&#39;Healthy&#39;</span>, <span class="st">&#39;Fever&#39;</span>)</span>
<span id="cb873-71"><a href="supplemental.html#cb873-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-72"><a href="supplemental.html#cb873-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-73"><a href="supplemental.html#cb873-73" aria-hidden="true" tabindex="-1"></a>start_p <span class="op">=</span> {<span class="st">&#39;Healthy&#39;</span>: <span class="fl">0.6</span>, <span class="st">&#39;Fever&#39;</span>: <span class="fl">0.4</span>}</span>
<span id="cb873-74"><a href="supplemental.html#cb873-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb873-75"><a href="supplemental.html#cb873-75" aria-hidden="true" tabindex="-1"></a>trans_p <span class="op">=</span> {</span>
<span id="cb873-76"><a href="supplemental.html#cb873-76" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Healthy&#39;</span> : {<span class="st">&#39;Healthy&#39;</span>: <span class="fl">0.7</span>, <span class="st">&#39;Fever&#39;</span>: <span class="fl">0.3</span>},</span>
<span id="cb873-77"><a href="supplemental.html#cb873-77" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Fever&#39;</span> : {<span class="st">&#39;Healthy&#39;</span>: <span class="fl">0.4</span>, <span class="st">&#39;Fever&#39;</span>: <span class="fl">0.6</span>}</span>
<span id="cb873-78"><a href="supplemental.html#cb873-78" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb873-79"><a href="supplemental.html#cb873-79" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb873-80"><a href="supplemental.html#cb873-80" aria-hidden="true" tabindex="-1"></a>emit_p <span class="op">=</span> {</span>
<span id="cb873-81"><a href="supplemental.html#cb873-81" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Healthy&#39;</span> : {<span class="st">&#39;normal&#39;</span>: <span class="fl">0.5</span>, <span class="st">&#39;cold&#39;</span>: <span class="fl">0.4</span>, <span class="st">&#39;dizzy&#39;</span>: <span class="fl">0.1</span>},</span>
<span id="cb873-82"><a href="supplemental.html#cb873-82" aria-hidden="true" tabindex="-1"></a>   <span class="st">&#39;Fever&#39;</span> : {<span class="st">&#39;normal&#39;</span>: <span class="fl">0.1</span>, <span class="st">&#39;cold&#39;</span>: <span class="fl">0.3</span>, <span class="st">&#39;dizzy&#39;</span>: <span class="fl">0.6</span>}</span>
<span id="cb873-83"><a href="supplemental.html#cb873-83" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb873-84"><a href="supplemental.html#cb873-84" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb873-85"><a href="supplemental.html#cb873-85" aria-hidden="true" tabindex="-1"></a>viterbi(obs,states,start_p,trans_p,emit_p)</span></code></pre></div>
</div>
</div>
<div id="julia-demos" class="section level3">
<h3>Julia Demos</h3>
<p>I haven’t played with Julia in a very long time, but briefly hacked the old code to get something that worked. As Julia has gone though notable changes, it’s doubtful these are very good as far as Julia programming standards go, though conceptually they may still provide some utility. Perhaps at some point I’ll reteach myself the basics and come back to these. In any case the code did run on a <a href="https://jupyter.org/">Jupyter notebook</a>.</p>
<div id="mixed-models-1" class="section level4">
<h4>Mixed Models</h4>
<div id="one-factor" class="section level5">
<h5>One-factor</h5>
<div class="sourceCode" id="cb874"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb874-1"><a href="supplemental.html#cb874-1" aria-hidden="true" tabindex="-1"></a><span class="co">#####################</span></span>
<span id="cb874-2"><a href="supplemental.html#cb874-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Main function </span><span class="al">###</span></span>
<span id="cb874-3"><a href="supplemental.html#cb874-3" aria-hidden="true" tabindex="-1"></a><span class="co">#####################</span></span>
<span id="cb874-4"><a href="supplemental.html#cb874-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb874-5"><a href="supplemental.html#cb874-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> LinearAlgebra</span>
<span id="cb874-6"><a href="supplemental.html#cb874-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Statistics</span>
<span id="cb874-7"><a href="supplemental.html#cb874-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb874-8"><a href="supplemental.html#cb874-8" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> one_factor_re_loglike(par<span class="op">::</span><span class="dt">Vector</span>)    </span>
<span id="cb874-9"><a href="supplemental.html#cb874-9" aria-hidden="true" tabindex="-1"></a>    d<span class="op">,</span> ni <span class="op">=</span> size(y)</span>
<span id="cb874-10"><a href="supplemental.html#cb874-10" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> par[<span class="fl">1</span>]</span>
<span id="cb874-11"><a href="supplemental.html#cb874-11" aria-hidden="true" tabindex="-1"></a>    sigma2_mu <span class="op">=</span> par[<span class="fl">2</span>]</span>
<span id="cb874-12"><a href="supplemental.html#cb874-12" aria-hidden="true" tabindex="-1"></a>    sigma2 <span class="op">=</span> par[<span class="fl">3</span>]</span>
<span id="cb874-13"><a href="supplemental.html#cb874-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb874-14"><a href="supplemental.html#cb874-14" aria-hidden="true" tabindex="-1"></a>    Sigmai <span class="op">=</span> sigma2<span class="op">*</span>I(ni) <span class="op">+</span> sigma2_mu<span class="op">*</span>ones(ni<span class="op">,</span> ni)</span>
<span id="cb874-15"><a href="supplemental.html#cb874-15" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="op">-</span>(ni<span class="op">*</span>d)<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(<span class="fl">2</span><span class="op">*</span><span class="cn">pi</span>) <span class="op">-</span> d<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(det(Sigmai))</span>
<span id="cb874-16"><a href="supplemental.html#cb874-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb874-17"><a href="supplemental.html#cb874-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span> i <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>d</span>
<span id="cb874-18"><a href="supplemental.html#cb874-18" aria-hidden="true" tabindex="-1"></a>      yi <span class="op">=</span> y[i<span class="op">,:</span>]</span>
<span id="cb874-19"><a href="supplemental.html#cb874-19" aria-hidden="true" tabindex="-1"></a>      l <span class="op">=</span> l <span class="op">-</span> <span class="fl">.5</span>(yi .<span class="op">-</span> mu)<span class="op">&#39;</span> <span class="op">*</span> (Sigmai<span class="op">\</span>(yi .<span class="op">-</span> mu))</span>
<span id="cb874-20"><a href="supplemental.html#cb874-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb874-21"><a href="supplemental.html#cb874-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb874-22"><a href="supplemental.html#cb874-22" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="op">-</span>l[<span class="fl">1</span>]</span>
<span id="cb874-23"><a href="supplemental.html#cb874-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb874-24"><a href="supplemental.html#cb874-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> l</span>
<span id="cb874-25"><a href="supplemental.html#cb874-25" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb875"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb875-1"><a href="supplemental.html#cb875-1" aria-hidden="true" tabindex="-1"></a><span class="co">###################</span></span>
<span id="cb875-2"><a href="supplemental.html#cb875-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Data set up </span><span class="al">###</span></span>
<span id="cb875-3"><a href="supplemental.html#cb875-3" aria-hidden="true" tabindex="-1"></a><span class="co">###################</span></span>
<span id="cb875-4"><a href="supplemental.html#cb875-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-5"><a href="supplemental.html#cb875-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="fl">22.6</span> <span class="fl">20.5</span> <span class="fl">20.8</span></span>
<span id="cb875-6"><a href="supplemental.html#cb875-6" aria-hidden="true" tabindex="-1"></a>     <span class="fl">22.6</span> <span class="fl">21.2</span> <span class="fl">20.5</span></span>
<span id="cb875-7"><a href="supplemental.html#cb875-7" aria-hidden="true" tabindex="-1"></a>     <span class="fl">17.3</span> <span class="fl">16.2</span> <span class="fl">16.6</span></span>
<span id="cb875-8"><a href="supplemental.html#cb875-8" aria-hidden="true" tabindex="-1"></a>     <span class="fl">21.4</span> <span class="fl">23.7</span> <span class="fl">23.2</span></span>
<span id="cb875-9"><a href="supplemental.html#cb875-9" aria-hidden="true" tabindex="-1"></a>     <span class="fl">20.9</span> <span class="fl">22.2</span> <span class="fl">22.6</span></span>
<span id="cb875-10"><a href="supplemental.html#cb875-10" aria-hidden="true" tabindex="-1"></a>     <span class="fl">14.5</span> <span class="fl">10.5</span> <span class="fl">12.3</span></span>
<span id="cb875-11"><a href="supplemental.html#cb875-11" aria-hidden="true" tabindex="-1"></a>     <span class="fl">20.8</span> <span class="fl">19.1</span> <span class="fl">21.3</span></span>
<span id="cb875-12"><a href="supplemental.html#cb875-12" aria-hidden="true" tabindex="-1"></a>     <span class="fl">17.4</span> <span class="fl">18.6</span> <span class="fl">18.6</span></span>
<span id="cb875-13"><a href="supplemental.html#cb875-13" aria-hidden="true" tabindex="-1"></a>     <span class="fl">25.1</span> <span class="fl">24.8</span> <span class="fl">24.9</span></span>
<span id="cb875-14"><a href="supplemental.html#cb875-14" aria-hidden="true" tabindex="-1"></a>     <span class="fl">14.9</span> <span class="fl">16.3</span> <span class="fl">16.6</span>]</span>
<span id="cb875-15"><a href="supplemental.html#cb875-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-16"><a href="supplemental.html#cb875-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-17"><a href="supplemental.html#cb875-17" aria-hidden="true" tabindex="-1"></a><span class="co">################################</span></span>
<span id="cb875-18"><a href="supplemental.html#cb875-18" aria-hidden="true" tabindex="-1"></a><span class="co">### Starting values and test </span><span class="al">###</span></span>
<span id="cb875-19"><a href="supplemental.html#cb875-19" aria-hidden="true" tabindex="-1"></a><span class="co">################################</span></span>
<span id="cb875-20"><a href="supplemental.html#cb875-20" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Statistics</span>
<span id="cb875-21"><a href="supplemental.html#cb875-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-22"><a href="supplemental.html#cb875-22" aria-hidden="true" tabindex="-1"></a>mu0 <span class="op">=</span> mean(y)</span>
<span id="cb875-23"><a href="supplemental.html#cb875-23" aria-hidden="true" tabindex="-1"></a>sigma2_mu0 <span class="op">=</span> var(mean(y<span class="op">,</span> dims <span class="op">=</span> <span class="fl">2</span>))</span>
<span id="cb875-24"><a href="supplemental.html#cb875-24" aria-hidden="true" tabindex="-1"></a>sigma20 <span class="op">=</span> mean(var(y<span class="op">,</span> dims <span class="op">=</span> <span class="fl">2</span>))</span>
<span id="cb875-25"><a href="supplemental.html#cb875-25" aria-hidden="true" tabindex="-1"></a>theta0  <span class="op">=</span> [mu0<span class="op">,</span> sigma2_mu0<span class="op">,</span> sigma20]</span>
<span id="cb875-26"><a href="supplemental.html#cb875-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb875-27"><a href="supplemental.html#cb875-27" aria-hidden="true" tabindex="-1"></a><span class="co">### test</span></span>
<span id="cb875-28"><a href="supplemental.html#cb875-28" aria-hidden="true" tabindex="-1"></a>one_factor_re_loglike(theta0)</span></code></pre></div>
<div class="sourceCode" id="cb876"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb876-1"><a href="supplemental.html#cb876-1" aria-hidden="true" tabindex="-1"></a><span class="co">###########</span></span>
<span id="cb876-2"><a href="supplemental.html#cb876-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Run </span><span class="al">###</span></span>
<span id="cb876-3"><a href="supplemental.html#cb876-3" aria-hidden="true" tabindex="-1"></a><span class="co">###########</span></span>
<span id="cb876-4"><a href="supplemental.html#cb876-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb876-5"><a href="supplemental.html#cb876-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Optim</span>
<span id="cb876-6"><a href="supplemental.html#cb876-6" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> optimize(one_factor_re_loglike<span class="op">,</span> theta0<span class="op">,</span> LBFGS())</span>
<span id="cb876-7"><a href="supplemental.html#cb876-7" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>
 * Status: success

 * Candidate solution
    Final objective value:     6.226441e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 2.93e-08 ≰ 0.0e+00
    |x - x&#39;|/|x&#39;|          = 1.49e-09 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 1.42e-14 ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 2.28e-16 ≰ 0.0e+00
    |g(x)|                 = 1.17e-09 ≤ 1.0e-08

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    7
    f(x) calls:    22
    ∇f(x) calls:   22
  
  </code></pre>
<div class="sourceCode" id="cb878"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb878-1"><a href="supplemental.html#cb878-1" aria-hidden="true" tabindex="-1"></a>Optim.minimizer(res)</span></code></pre></div>
<pre><code>
3-element Array{Float64,1}:
19.599999980440952
12.193999992338886
1.1666666662195693</code></pre>
<div class="sourceCode" id="cb880"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb880-1"><a href="supplemental.html#cb880-1" aria-hidden="true" tabindex="-1"></a>Optim.minimum(res)</span></code></pre></div>
<pre><code>62.30661224610756</code></pre>
</div>
<div id="two-factor" class="section level5">
<h5>Two-factor</h5>
<div class="sourceCode" id="cb882"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb882-1"><a href="supplemental.html#cb882-1" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> LinearAlgebra</span>
<span id="cb882-2"><a href="supplemental.html#cb882-2" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Statistics</span>
<span id="cb882-3"><a href="supplemental.html#cb882-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb882-4"><a href="supplemental.html#cb882-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> sfran2_loglike(par<span class="op">::</span><span class="dt">Vector</span>)</span>
<span id="cb882-5"><a href="supplemental.html#cb882-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> length(y)</span>
<span id="cb882-6"><a href="supplemental.html#cb882-6" aria-hidden="true" tabindex="-1"></a>    mu <span class="op">=</span> par[<span class="fl">1</span>]</span>
<span id="cb882-7"><a href="supplemental.html#cb882-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb882-8"><a href="supplemental.html#cb882-8" aria-hidden="true" tabindex="-1"></a>    sigma2_alpha <span class="op">=</span> exp(par[<span class="fl">2</span>])</span>
<span id="cb882-9"><a href="supplemental.html#cb882-9" aria-hidden="true" tabindex="-1"></a>    sigma2_gamma <span class="op">=</span> exp(par[<span class="fl">3</span>])</span>
<span id="cb882-10"><a href="supplemental.html#cb882-10" aria-hidden="true" tabindex="-1"></a>    sigma2 <span class="op">=</span> exp(par[<span class="fl">4</span>])</span>
<span id="cb882-11"><a href="supplemental.html#cb882-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb882-12"><a href="supplemental.html#cb882-12" aria-hidden="true" tabindex="-1"></a>    Sigma <span class="op">=</span> sigma2<span class="op">*</span>I(n) <span class="op">+</span> sigma2_alpha<span class="op">*</span>(Xalpha <span class="op">*</span> Xalpha<span class="op">&#39;</span>) <span class="op">+</span> sigma2_gamma <span class="op">*</span> (Xgamma <span class="op">*</span> Xgamma<span class="op">&#39;</span>)</span>
<span id="cb882-13"><a href="supplemental.html#cb882-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb882-14"><a href="supplemental.html#cb882-14" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="op">-</span>n<span class="op">/</span><span class="fl">2</span><span class="op">*</span>log(<span class="fl">2</span><span class="op">*</span><span class="cn">pi</span>) <span class="op">-</span> sum(log.(diag(cholesky(Sigma).L))) <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(y .<span class="op">-</span> mu)<span class="op">&#39;</span> <span class="op">*</span> (Sigma<span class="op">\</span>(y .<span class="op">-</span> mu))</span>
<span id="cb882-15"><a href="supplemental.html#cb882-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb882-16"><a href="supplemental.html#cb882-16" aria-hidden="true" tabindex="-1"></a>    l <span class="op">=</span> <span class="op">-</span>l[<span class="fl">1</span>]</span>
<span id="cb882-17"><a href="supplemental.html#cb882-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">return</span> l</span>
<span id="cb882-18"><a href="supplemental.html#cb882-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb883"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb883-1"><a href="supplemental.html#cb883-1" aria-hidden="true" tabindex="-1"></a><span class="co">##################</span></span>
<span id="cb883-2"><a href="supplemental.html#cb883-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Data setup </span><span class="al">###</span></span>
<span id="cb883-3"><a href="supplemental.html#cb883-3" aria-hidden="true" tabindex="-1"></a><span class="co">##################</span></span>
<span id="cb883-4"><a href="supplemental.html#cb883-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="fl">1.39</span><span class="op">,</span><span class="fl">1.29</span><span class="op">,</span><span class="fl">1.12</span><span class="op">,</span><span class="fl">1.16</span><span class="op">,</span><span class="fl">1.52</span><span class="op">,</span><span class="fl">1.62</span><span class="op">,</span><span class="fl">1.88</span><span class="op">,</span><span class="fl">1.87</span><span class="op">,</span><span class="fl">1.24</span><span class="op">,</span><span class="fl">1.18</span><span class="op">,</span></span>
<span id="cb883-5"><a href="supplemental.html#cb883-5" aria-hidden="true" tabindex="-1"></a>     <span class="fl">.95</span><span class="op">,</span><span class="fl">.96</span><span class="op">,</span><span class="fl">.82</span><span class="op">,</span><span class="fl">.92</span><span class="op">,</span><span class="fl">1.18</span><span class="op">,</span><span class="fl">1.20</span><span class="op">,</span><span class="fl">1.47</span><span class="op">,</span><span class="fl">1.41</span><span class="op">,</span><span class="fl">1.57</span><span class="op">,</span><span class="fl">1.65</span>]</span>
<span id="cb883-6"><a href="supplemental.html#cb883-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb883-7"><a href="supplemental.html#cb883-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb883-8"><a href="supplemental.html#cb883-8" aria-hidden="true" tabindex="-1"></a><span class="co">################################</span></span>
<span id="cb883-9"><a href="supplemental.html#cb883-9" aria-hidden="true" tabindex="-1"></a><span class="co">### Starting values and test </span><span class="al">###</span></span>
<span id="cb883-10"><a href="supplemental.html#cb883-10" aria-hidden="true" tabindex="-1"></a><span class="co">################################</span></span>
<span id="cb883-11"><a href="supplemental.html#cb883-11" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> mean(reshape(y<span class="op">,</span> <span class="fl">4</span><span class="op">,</span> <span class="fl">5</span>)<span class="op">,</span> <span class="fl">1</span>)</span>
<span id="cb883-12"><a href="supplemental.html#cb883-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb883-13"><a href="supplemental.html#cb883-13" aria-hidden="true" tabindex="-1"></a>theta0 <span class="op">=</span> [mean(y)<span class="op">,</span> log(var(yhat))<span class="op">,</span> log(var(y)<span class="op">/</span><span class="fl">3</span>)<span class="op">,</span> log(var(y)<span class="op">/</span><span class="fl">3</span>)]</span>
<span id="cb883-14"><a href="supplemental.html#cb883-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb883-15"><a href="supplemental.html#cb883-15" aria-hidden="true" tabindex="-1"></a>sfran2_loglike(theta0)</span></code></pre></div>
<div class="sourceCode" id="cb884"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb884-1"><a href="supplemental.html#cb884-1" aria-hidden="true" tabindex="-1"></a><span class="co">###########</span></span>
<span id="cb884-2"><a href="supplemental.html#cb884-2" aria-hidden="true" tabindex="-1"></a><span class="co">### Run </span><span class="al">###</span></span>
<span id="cb884-3"><a href="supplemental.html#cb884-3" aria-hidden="true" tabindex="-1"></a><span class="co">###########</span></span>
<span id="cb884-4"><a href="supplemental.html#cb884-4" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> Optim</span>
<span id="cb884-5"><a href="supplemental.html#cb884-5" aria-hidden="true" tabindex="-1"></a>res <span class="op">=</span> optimize(sfran2_loglike<span class="op">,</span> theta0<span class="op">,</span> method <span class="op">=</span> <span class="op">:</span>l_bfgs)</span>
<span id="cb884-6"><a href="supplemental.html#cb884-6" aria-hidden="true" tabindex="-1"></a>res</span></code></pre></div>
<pre><code>
 * Status: success

 * Candidate solution
    Final objective value:     -1.199315e+01

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 6.60e-09 ≰ 0.0e+00
    |x - x&#39;|/|x&#39;|          = 1.08e-09 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 5.33e-15 ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 4.44e-16 ≰ 0.0e+00
    |g(x)|                 = 7.02e-10 ≤ 1.0e-08

 * Work counters
    Seconds run:   0  (vs limit Inf)
    Iterations:    9
    f(x) calls:    23
    ∇f(x) calls:   23</code></pre>
<div class="sourceCode" id="cb886"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb886-1"><a href="supplemental.html#cb886-1" aria-hidden="true" tabindex="-1"></a>exp.(Optim.minimizer(res))</span></code></pre></div>
<pre><code>
4-element Array{Float64,1}:
 3.7434213772629223
 0.053720000000540405
 0.031790000003692476
 0.002290000000530042</code></pre>
<div class="sourceCode" id="cb888"><pre class="sourceCode julia"><code class="sourceCode julia"><span id="cb888-1"><a href="supplemental.html#cb888-1" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="fl">2</span><span class="op">*</span>Optim.minimum(res)</span></code></pre></div>
<pre><code>23.98630759443859</code></pre>
</div>
</div>
</div>
<div id="matlab-demos" class="section level3">
<h3>Matlab Demos</h3>
<p>I don’t code in Matlab, nor have any particular desire to, so this is provided here just for reference.</p>
<div id="mixed-models-2" class="section level4">
<h4>Mixed Models</h4>
<div id="one-factor-1" class="section level5">
<h5>One-factor</h5>
<div class="sourceCode" id="cb890"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb890-1"><a href="supplemental.html#cb890-1" aria-hidden="true" tabindex="-1"></a><span class="co">% matlab from Statistical Modeling and Computation (2014 p 311).  See the </span></span>
<span id="cb890-2"><a href="supplemental.html#cb890-2" aria-hidden="true" tabindex="-1"></a><span class="co">% associated twofactorRE.R file for details.</span></span>
<span id="cb890-3"><a href="supplemental.html#cb890-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb890-4"><a href="supplemental.html#cb890-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">one_factor_re_loglike</span>(<span class="va">mu</span><span class="op">,</span> <span class="va">sigma2_mu</span><span class="op">,</span> <span class="va">sigma2</span><span class="op">,</span> <span class="va">y</span>)</span>
<span id="cb890-5"><a href="supplemental.html#cb890-5" aria-hidden="true" tabindex="-1"></a>    [<span class="va">d</span> <span class="va">ni</span>] <span class="op">=</span> <span class="va">size</span>(<span class="va">y</span>)<span class="op">;</span></span>
<span id="cb890-6"><a href="supplemental.html#cb890-6" aria-hidden="true" tabindex="-1"></a>    <span class="va">Sigmai</span> <span class="op">=</span> <span class="va">sigma2</span><span class="op">*</span><span class="va">eye</span>(<span class="va">ni</span>) <span class="op">+</span> <span class="va">sigma2_mu</span><span class="op">*</span><span class="va">ones</span>(<span class="va">ni</span><span class="op">,</span><span class="va">ni</span>)<span class="op">;</span></span>
<span id="cb890-7"><a href="supplemental.html#cb890-7" aria-hidden="true" tabindex="-1"></a>    <span class="va">l</span> <span class="op">=</span> <span class="op">-</span>(<span class="va">ni</span><span class="op">*</span><span class="va">d</span>) <span class="op">/</span> <span class="fl">2</span><span class="op">*</span><span class="va">log</span>(<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>) <span class="op">-</span> <span class="va">d</span> <span class="op">/</span> <span class="fl">2</span><span class="op">*</span><span class="va">log</span>(<span class="va">det</span>(<span class="va">Sigmai</span>))<span class="op">;</span></span>
<span id="cb890-8"><a href="supplemental.html#cb890-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">d</span></span>
<span id="cb890-9"><a href="supplemental.html#cb890-9" aria-hidden="true" tabindex="-1"></a>      <span class="va">yi</span> <span class="op">=</span> <span class="va">y</span>(<span class="va">i</span><span class="op">,</span> <span class="op">:</span>)<span class="op">&#39;;</span></span>
<span id="cb890-10"><a href="supplemental.html#cb890-10" aria-hidden="true" tabindex="-1"></a>      <span class="va">l</span> <span class="op">=</span> <span class="va">l</span> <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(<span class="va">yi</span> <span class="op">-</span> <span class="va">mu</span>)<span class="op">&#39;</span> <span class="op">*</span> (<span class="va">Sigmai</span><span class="op">\</span>(<span class="va">yi</span> <span class="op">-</span> <span class="va">mu</span>))<span class="op">;</span></span>
<span id="cb890-11"><a href="supplemental.html#cb890-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb890-12"><a href="supplemental.html#cb890-12" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb890-13"><a href="supplemental.html#cb890-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb890-14"><a href="supplemental.html#cb890-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb890-15"><a href="supplemental.html#cb890-15" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> <span class="op">=</span> [<span class="fl">22.6</span> <span class="fl">20.5</span> <span class="fl">20.8</span><span class="op">;</span></span>
<span id="cb890-16"><a href="supplemental.html#cb890-16" aria-hidden="true" tabindex="-1"></a>     <span class="fl">22.6</span> <span class="fl">21.2</span> <span class="fl">20.5</span><span class="op">;</span></span>
<span id="cb890-17"><a href="supplemental.html#cb890-17" aria-hidden="true" tabindex="-1"></a>     <span class="fl">17.3</span> <span class="fl">16.2</span> <span class="fl">16.6</span><span class="op">;</span></span>
<span id="cb890-18"><a href="supplemental.html#cb890-18" aria-hidden="true" tabindex="-1"></a>     <span class="fl">21.4</span> <span class="fl">23.7</span> <span class="fl">23.2</span><span class="op">;</span></span>
<span id="cb890-19"><a href="supplemental.html#cb890-19" aria-hidden="true" tabindex="-1"></a>     <span class="fl">20.9</span> <span class="fl">22.2</span> <span class="fl">22.6</span><span class="op">;</span></span>
<span id="cb890-20"><a href="supplemental.html#cb890-20" aria-hidden="true" tabindex="-1"></a>     <span class="fl">14.5</span> <span class="fl">10.5</span> <span class="fl">12.3</span><span class="op">;</span></span>
<span id="cb890-21"><a href="supplemental.html#cb890-21" aria-hidden="true" tabindex="-1"></a>     <span class="fl">20.8</span> <span class="fl">19.1</span> <span class="fl">21.3</span><span class="op">;</span></span>
<span id="cb890-22"><a href="supplemental.html#cb890-22" aria-hidden="true" tabindex="-1"></a>     <span class="fl">17.4</span> <span class="fl">18.6</span> <span class="fl">18.6</span><span class="op">;</span></span>
<span id="cb890-23"><a href="supplemental.html#cb890-23" aria-hidden="true" tabindex="-1"></a>     <span class="fl">25.1</span> <span class="fl">24.8</span> <span class="fl">24.9</span><span class="op">;</span></span>
<span id="cb890-24"><a href="supplemental.html#cb890-24" aria-hidden="true" tabindex="-1"></a>     <span class="fl">14.9</span> <span class="fl">16.3</span> <span class="fl">16.6</span>]<span class="op">;</span></span>
<span id="cb890-25"><a href="supplemental.html#cb890-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb890-26"><a href="supplemental.html#cb890-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb890-27"><a href="supplemental.html#cb890-27" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">theta</span>) <span class="op">-</span><span class="va">one_factor_re_loglike</span>(<span class="va">theta</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">2</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">3</span>)<span class="op">,</span> <span class="va">y</span>)<span class="op">;</span></span>
<span id="cb890-28"><a href="supplemental.html#cb890-28" aria-hidden="true" tabindex="-1"></a><span class="va">ybar</span> <span class="op">=</span> <span class="va">mean</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb890-29"><a href="supplemental.html#cb890-29" aria-hidden="true" tabindex="-1"></a><span class="va">theta0</span> <span class="op">=</span> [<span class="va">mean</span>(<span class="va">ybar</span>) <span class="va">var</span>(<span class="va">ybar</span>) <span class="va">mean</span>(<span class="va">var</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">0</span><span class="op">,</span> <span class="fl">2</span>))]<span class="op">;</span></span>
<span id="cb890-30"><a href="supplemental.html#cb890-30" aria-hidden="true" tabindex="-1"></a><span class="va">thetahat</span> <span class="op">=</span> <span class="va">fminsearch</span>(<span class="va">f</span><span class="op">,</span> <span class="va">theta0</span>)<span class="op">;</span></span></code></pre></div>
</div>
<div id="two-factor-1" class="section level5">
<h5>Two-factor</h5>
<div class="sourceCode" id="cb891"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb891-1"><a href="supplemental.html#cb891-1" aria-hidden="true" tabindex="-1"></a><span class="co">% matlab from Statistical Modeling and Computation (2014 p 314). See the </span></span>
<span id="cb891-2"><a href="supplemental.html#cb891-2" aria-hidden="true" tabindex="-1"></a><span class="co">% associated twofactorRE.R file for details.</span></span>
<span id="cb891-3"><a href="supplemental.html#cb891-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb891-4"><a href="supplemental.html#cb891-4" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">sfran2_loglike</span>(<span class="va">mu</span><span class="op">,</span> <span class="va">eta_alpha</span><span class="op">,</span> <span class="va">eta_gamma</span><span class="op">,</span> <span class="va">eta</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">Xalpha</span><span class="op">,</span> <span class="va">Xgamma</span>)</span>
<span id="cb891-5"><a href="supplemental.html#cb891-5" aria-hidden="true" tabindex="-1"></a>  <span class="va">sigma2_alpha</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta_alpha</span>)<span class="op">;</span></span>
<span id="cb891-6"><a href="supplemental.html#cb891-6" aria-hidden="true" tabindex="-1"></a>  <span class="va">sigma2_gamma</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta_gamma</span>)<span class="op">;</span></span>
<span id="cb891-7"><a href="supplemental.html#cb891-7" aria-hidden="true" tabindex="-1"></a>  <span class="va">sigma2</span> <span class="op">=</span> <span class="va">exp</span>(<span class="va">eta</span>)<span class="op">;</span></span>
<span id="cb891-8"><a href="supplemental.html#cb891-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb891-9"><a href="supplemental.html#cb891-9" aria-hidden="true" tabindex="-1"></a>  <span class="va">n</span> <span class="op">=</span> <span class="va">length</span>(<span class="va">y</span>)<span class="op">;</span></span>
<span id="cb891-10"><a href="supplemental.html#cb891-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb891-11"><a href="supplemental.html#cb891-11" aria-hidden="true" tabindex="-1"></a>  <span class="va">Sigma</span> <span class="op">=</span> <span class="va">sigma2</span><span class="op">*</span><span class="va">speye</span>(<span class="va">n</span>) <span class="op">+</span> <span class="va">sigma2_alpha</span> <span class="op">*</span> (<span class="va">Xalpha</span> <span class="op">*</span> <span class="va">Xalpha</span><span class="op">&#39;</span>) <span class="op">+</span> <span class="va">sigma2_gamma</span> <span class="op">*</span> (<span class="va">Xgamma</span><span class="op">*</span><span class="va">Xgamma</span><span class="op">&#39;</span>)<span class="op">;</span></span>
<span id="cb891-12"><a href="supplemental.html#cb891-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb891-13"><a href="supplemental.html#cb891-13" aria-hidden="true" tabindex="-1"></a>  <span class="va">l</span> <span class="op">=</span> <span class="op">-</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span> <span class="op">*</span> <span class="va">log</span>(<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>) <span class="op">-</span> <span class="va">sum</span>(<span class="va">log</span>(<span class="va">diag</span>(<span class="va">chol</span>(<span class="va">Sigma</span>)))) <span class="op">-</span> <span class="fl">.5</span><span class="op">*</span>(<span class="va">y</span> <span class="op">-</span> <span class="va">mu</span>)<span class="op">&#39;</span> <span class="op">*</span> (<span class="va">Sigma</span><span class="op">\</span>(<span class="va">y</span> <span class="op">-</span> <span class="va">mu</span>))<span class="op">;</span></span>
<span id="cb891-14"><a href="supplemental.html#cb891-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb891-15"><a href="supplemental.html#cb891-15" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb891-16"><a href="supplemental.html#cb891-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb891-17"><a href="supplemental.html#cb891-17" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> <span class="op">=</span> [<span class="fl">1.39</span> <span class="fl">1.29</span> <span class="fl">1.12</span> <span class="fl">1.16</span> <span class="fl">1.52</span> <span class="fl">1.62</span> <span class="fl">1.88</span> <span class="fl">1.87</span> <span class="fl">1.24</span> <span class="fl">1.18</span> <span class="fl">.95</span> <span class="fl">.96</span> <span class="fl">.82</span> <span class="fl">.92</span> <span class="fl">1.18</span> <span class="fl">1.20</span> <span class="fl">1.47</span> <span class="fl">1.41</span> <span class="fl">1.57</span> <span class="fl">1.65</span>]<span class="op">;</span></span>
<span id="cb891-18"><a href="supplemental.html#cb891-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb891-19"><a href="supplemental.html#cb891-19" aria-hidden="true" tabindex="-1"></a><span class="va">Xalpha</span> <span class="op">=</span> <span class="va">kron</span>(<span class="va">speye</span>(<span class="fl">5</span>)<span class="op">,</span>  <span class="va">ones</span>(<span class="fl">4</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb891-20"><a href="supplemental.html#cb891-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb891-21"><a href="supplemental.html#cb891-21" aria-hidden="true" tabindex="-1"></a><span class="va">Xgamma</span> <span class="op">=</span> <span class="va">kron</span>(<span class="va">speye</span>(<span class="fl">10</span>)<span class="op">,</span> <span class="va">ones</span>(<span class="fl">2</span><span class="op">,</span><span class="fl">1</span>))<span class="op">;</span></span>
<span id="cb891-22"><a href="supplemental.html#cb891-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb891-23"><a href="supplemental.html#cb891-23" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">theta</span>) <span class="op">-</span><span class="va">sfran_loglike</span>(<span class="va">theta</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">2</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">3</span>)<span class="op">,</span> <span class="va">theta</span>(<span class="fl">4</span>)<span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">Xalpha</span><span class="op">,</span> <span class="va">Xgamma</span>)<span class="op">;</span></span>
<span id="cb891-24"><a href="supplemental.html#cb891-24" aria-hidden="true" tabindex="-1"></a><span class="va">yhat</span>     <span class="op">=</span> <span class="va">mean</span>(<span class="va">reshape</span>(<span class="va">y</span><span class="op">,</span> <span class="fl">4</span><span class="op">,</span> <span class="fl">5</span>))<span class="op">;</span></span>
<span id="cb891-25"><a href="supplemental.html#cb891-25" aria-hidden="true" tabindex="-1"></a><span class="va">theta0</span>   <span class="op">=</span> [<span class="va">mean</span>(<span class="va">y</span>) <span class="va">log</span>(<span class="va">var</span>(<span class="va">yhat</span>)) <span class="va">log</span>(<span class="va">var</span>(<span class="va">y</span>)<span class="op">/</span><span class="fl">3</span>) <span class="va">log</span>(<span class="va">var</span>(<span class="va">y</span>)<span class="op">/</span><span class="fl">3</span>)]<span class="op">;</span></span>
<span id="cb891-26"><a href="supplemental.html#cb891-26" aria-hidden="true" tabindex="-1"></a><span class="va">thetahat</span> <span class="op">=</span> <span class="va">fminsearch</span>(<span class="va">f</span><span class="op">,</span> <span class="va">theta0</span>)</span></code></pre></div>
</div>
</div>
<div id="matlab-gp" class="section level4">
<h4>Gaussian Processes</h4>
<p>Any updates on the following can be found at the <a href="https://github.com/probml/pmtk3">repo</a>.</p>
<div class="sourceCode" id="cb892"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb892-1"><a href="supplemental.html#cb892-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="va">S</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">arg1</span><span class="op">,</span> <span class="va">arg2</span><span class="op">,</span> <span class="va">arg3</span>)</span>
<span id="cb892-2"><a href="supplemental.html#cb892-2" aria-hidden="true" tabindex="-1"></a><span class="co">% Returns n samples (in the rows) from a multivariate Gaussian distribution</span></span>
<span id="cb892-3"><a href="supplemental.html#cb892-3" aria-hidden="true" tabindex="-1"></a><span class="co">%</span></span>
<span id="cb892-4"><a href="supplemental.html#cb892-4" aria-hidden="true" tabindex="-1"></a><span class="co">% Examples:</span></span>
<span id="cb892-5"><a href="supplemental.html#cb892-5" aria-hidden="true" tabindex="-1"></a><span class="co">% S = gaussSample(mu, Sigma, 10)</span></span>
<span id="cb892-6"><a href="supplemental.html#cb892-6" aria-hidden="true" tabindex="-1"></a><span class="co">% S = gaussSample(model, 100)</span></span>
<span id="cb892-7"><a href="supplemental.html#cb892-7" aria-hidden="true" tabindex="-1"></a><span class="co">% S = gaussSample(struct(&#39;mu&#39;,[0], &#39;Sigma&#39;, eye(1)), 3)</span></span>
<span id="cb892-8"><a href="supplemental.html#cb892-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb892-9"><a href="supplemental.html#cb892-9" aria-hidden="true" tabindex="-1"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb892-10"><a href="supplemental.html#cb892-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb892-11"><a href="supplemental.html#cb892-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb892-12"><a href="supplemental.html#cb892-12" aria-hidden="true" tabindex="-1"></a><span class="kw">switch</span> <span class="va">nargin</span></span>
<span id="cb892-13"><a href="supplemental.html#cb892-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">case</span> <span class="fl">3</span><span class="op">,</span>  <span class="va">mu</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">arg2</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="va">arg3</span><span class="op">;</span></span>
<span id="cb892-14"><a href="supplemental.html#cb892-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">case</span> <span class="fl">2</span><span class="op">,</span> <span class="va">model</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">mu</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">mu</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">Sigma</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="va">arg2</span><span class="op">;</span></span>
<span id="cb892-15"><a href="supplemental.html#cb892-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">case</span> <span class="fl">1</span><span class="op">,</span> <span class="va">model</span> <span class="op">=</span> <span class="va">arg1</span><span class="op">;</span> <span class="va">mu</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">mu</span><span class="op">;</span> <span class="va">Sigma</span> <span class="op">=</span> <span class="va">model</span>.<span class="va">Sigma</span><span class="op">;</span> <span class="va">n</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span> </span>
<span id="cb892-16"><a href="supplemental.html#cb892-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">otherwise</span></span>
<span id="cb892-17"><a href="supplemental.html#cb892-17" aria-hidden="true" tabindex="-1"></a>        <span class="va">error</span>(<span class="ss">&#39;bad num args&#39;</span>)</span>
<span id="cb892-18"><a href="supplemental.html#cb892-18" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb892-19"><a href="supplemental.html#cb892-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb892-20"><a href="supplemental.html#cb892-20" aria-hidden="true" tabindex="-1"></a><span class="va">A</span> <span class="op">=</span> <span class="va">chol</span>(<span class="va">Sigma</span><span class="op">,</span> <span class="ss">&#39;lower&#39;</span>)<span class="op">;</span></span>
<span id="cb892-21"><a href="supplemental.html#cb892-21" aria-hidden="true" tabindex="-1"></a><span class="va">Z</span> <span class="op">=</span> <span class="va">randn</span>(<span class="va">length</span>(<span class="va">mu</span>)<span class="op">,</span> <span class="va">n</span>)<span class="op">;</span></span>
<span id="cb892-22"><a href="supplemental.html#cb892-22" aria-hidden="true" tabindex="-1"></a><span class="va">S</span> <span class="op">=</span> <span class="va">bsxfun</span>(<span class="op">@</span><span class="va">plus</span><span class="op">,</span> <span class="va">mu</span>(<span class="op">:</span>)<span class="op">,</span> <span class="va">A</span><span class="op">*</span><span class="va">Z</span>)<span class="op">&#39;;</span></span>
<span id="cb892-23"><a href="supplemental.html#cb892-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb892-24"><a href="supplemental.html#cb892-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb892-25"><a href="supplemental.html#cb892-25" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb893"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb893-1"><a href="supplemental.html#cb893-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% Visualize the effect of change the hyper-params for a 1d GP regression</span></span>
<span id="cb893-2"><a href="supplemental.html#cb893-2" aria-hidden="true" tabindex="-1"></a><span class="co">% based on demo_gpr by Carl Rasmussen</span></span>
<span id="cb893-3"><a href="supplemental.html#cb893-3" aria-hidden="true" tabindex="-1"></a><span class="co">%</span></span>
<span id="cb893-4"><a href="supplemental.html#cb893-4" aria-hidden="true" tabindex="-1"></a><span class="co">%% Generate data</span></span>
<span id="cb893-5"><a href="supplemental.html#cb893-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb893-6"><a href="supplemental.html#cb893-6" aria-hidden="true" tabindex="-1"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb893-7"><a href="supplemental.html#cb893-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb893-8"><a href="supplemental.html#cb893-8" aria-hidden="true" tabindex="-1"></a><span class="va">n</span> <span class="op">=</span> <span class="fl">20</span><span class="op">;</span></span>
<span id="cb893-9"><a href="supplemental.html#cb893-9" aria-hidden="true" tabindex="-1"></a><span class="va">rand</span>(<span class="ss">&#39;state&#39;</span><span class="op">,</span><span class="fl">18</span>)<span class="op">;</span></span>
<span id="cb893-10"><a href="supplemental.html#cb893-10" aria-hidden="true" tabindex="-1"></a><span class="va">randn</span>(<span class="ss">&#39;state&#39;</span><span class="op">,</span><span class="fl">20</span>)<span class="op">;</span></span>
<span id="cb893-11"><a href="supplemental.html#cb893-11" aria-hidden="true" tabindex="-1"></a><span class="va">covfunc</span> <span class="op">=</span> {<span class="ss">&#39;covSum&#39;</span><span class="op">,</span> {<span class="ss">&#39;covSEiso&#39;</span><span class="op">,</span><span class="ss">&#39;covNoise&#39;</span>}}<span class="op">;</span></span>
<span id="cb893-12"><a href="supplemental.html#cb893-12" aria-hidden="true" tabindex="-1"></a><span class="va">loghyper</span> <span class="op">=</span> [<span class="va">log</span>(<span class="fl">1.0</span>)<span class="op">;</span> <span class="va">log</span>(<span class="fl">1.0</span>)<span class="op">;</span> <span class="va">log</span>(<span class="fl">0.1</span>)]<span class="op">;</span></span>
<span id="cb893-13"><a href="supplemental.html#cb893-13" aria-hidden="true" tabindex="-1"></a><span class="va">x</span> <span class="op">=</span> <span class="fl">15</span><span class="op">*</span>(<span class="va">rand</span>(<span class="va">n</span><span class="op">,</span><span class="fl">1</span>)<span class="op">-</span><span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb893-14"><a href="supplemental.html#cb893-14" aria-hidden="true" tabindex="-1"></a><span class="va">y</span> <span class="op">=</span> <span class="va">chol</span>(<span class="va">feval</span>(<span class="va">covfunc</span>{<span class="op">:</span>}<span class="op">,</span> <span class="va">loghyper</span><span class="op">,</span> <span class="va">x</span>))<span class="op">&#39;*</span><span class="va">randn</span>(<span class="va">n</span><span class="op">,</span><span class="fl">1</span>)<span class="op">;</span>        <span class="co">% Cholesky decomp.</span></span>
<span id="cb893-15"><a href="supplemental.html#cb893-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb893-16"><a href="supplemental.html#cb893-16" aria-hidden="true" tabindex="-1"></a><span class="va">xstar</span> <span class="op">=</span> <span class="va">linspace</span>(<span class="op">-</span><span class="fl">7.5</span><span class="op">,</span> <span class="fl">7.5</span><span class="op">,</span> <span class="fl">201</span>)<span class="op">&#39;;</span></span>
<span id="cb893-17"><a href="supplemental.html#cb893-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb893-18"><a href="supplemental.html#cb893-18" aria-hidden="true" tabindex="-1"></a><span class="va">hyps</span> <span class="op">=</span> [<span class="va">log</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">log</span>(<span class="fl">1</span>)<span class="op">,</span> <span class="va">log</span>(<span class="fl">0.1</span>)<span class="op">;...</span></span>
<span id="cb893-19"><a href="supplemental.html#cb893-19" aria-hidden="true" tabindex="-1"></a>  <span class="va">log</span>(<span class="fl">0.3</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">1.08</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">0.00005</span>)<span class="op">;...</span></span>
<span id="cb893-20"><a href="supplemental.html#cb893-20" aria-hidden="true" tabindex="-1"></a>  <span class="va">log</span>(<span class="fl">3</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">1.16</span>)<span class="op">,</span><span class="va">log</span>(<span class="fl">0.89</span>)]<span class="op">;</span></span>
<span id="cb893-21"><a href="supplemental.html#cb893-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb893-22"><a href="supplemental.html#cb893-22" aria-hidden="true" tabindex="-1"></a><span class="co">%% compute post pred and plot marginals</span></span>
<span id="cb893-23"><a href="supplemental.html#cb893-23" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="va">size</span>(<span class="va">hyps</span><span class="op">,</span><span class="fl">1</span>)</span>
<span id="cb893-24"><a href="supplemental.html#cb893-24" aria-hidden="true" tabindex="-1"></a>  <span class="va">loghyper</span> <span class="op">=</span> <span class="va">hyps</span>(<span class="va">i</span><span class="op">,:</span>)<span class="op">&#39;;</span></span>
<span id="cb893-25"><a href="supplemental.html#cb893-25" aria-hidden="true" tabindex="-1"></a>  [<span class="va">mu</span><span class="op">,</span> <span class="va">S2</span>] <span class="op">=</span> <span class="va">gpr</span>(<span class="va">loghyper</span><span class="op">,</span> <span class="va">covfunc</span><span class="op">,</span> <span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="va">xstar</span>)<span class="op">;</span></span>
<span id="cb893-26"><a href="supplemental.html#cb893-26" aria-hidden="true" tabindex="-1"></a>  <span class="va">S2</span> <span class="op">=</span> <span class="va">S2</span> <span class="op">-</span> <span class="va">exp</span>(<span class="fl">2</span><span class="op">*</span><span class="va">loghyper</span>(<span class="fl">3</span>))<span class="op">;</span> <span class="co">% remove observation noise</span></span>
<span id="cb893-27"><a href="supplemental.html#cb893-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb893-28"><a href="supplemental.html#cb893-28" aria-hidden="true" tabindex="-1"></a>  <span class="va">figure</span><span class="op">;</span></span>
<span id="cb893-29"><a href="supplemental.html#cb893-29" aria-hidden="true" tabindex="-1"></a>  <span class="va">f</span> <span class="op">=</span> [<span class="va">mu</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">;</span><span class="va">flipdim</span>(<span class="va">mu</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">,</span><span class="fl">1</span>)]<span class="op">;</span></span>
<span id="cb893-30"><a href="supplemental.html#cb893-30" aria-hidden="true" tabindex="-1"></a>  <span class="va">fill</span>([<span class="va">xstar</span><span class="op">;</span> <span class="va">flipdim</span>(<span class="va">xstar</span><span class="op">,</span><span class="fl">1</span>)]<span class="op">,</span> <span class="va">f</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span><span class="op">,</span> <span class="ss">&#39;EdgeColor&#39;</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb893-31"><a href="supplemental.html#cb893-31" aria-hidden="true" tabindex="-1"></a>  <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb893-32"><a href="supplemental.html#cb893-32" aria-hidden="true" tabindex="-1"></a>  <span class="va">plot</span>(<span class="va">xstar</span><span class="op">,</span><span class="va">mu</span><span class="op">,</span><span class="ss">&#39;k-&#39;</span><span class="op">,</span><span class="ss">&#39;LineWidth&#39;</span><span class="op">,</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb893-33"><a href="supplemental.html#cb893-33" aria-hidden="true" tabindex="-1"></a>  <span class="va">plot</span>(<span class="va">x</span><span class="op">,</span> <span class="va">y</span><span class="op">,</span> <span class="ss">&#39;k+&#39;</span><span class="op">,</span> <span class="ss">&#39;MarkerSize&#39;</span><span class="op">,</span> <span class="fl">17</span>)<span class="op">;</span></span>
<span id="cb893-34"><a href="supplemental.html#cb893-34" aria-hidden="true" tabindex="-1"></a>  <span class="va">axis</span>([<span class="op">-</span><span class="fl">8</span> <span class="fl">8</span> <span class="op">-</span><span class="fl">3</span> <span class="fl">3</span>])</span>
<span id="cb893-35"><a href="supplemental.html#cb893-35" aria-hidden="true" tabindex="-1"></a>  <span class="va">printPmtkFigure</span>(<span class="va">sprintf</span>(<span class="ss">&#39;gprDemoChangeHparams%d&#39;</span><span class="op">,</span> <span class="va">i</span>))<span class="op">;</span></span>
<span id="cb893-36"><a href="supplemental.html#cb893-36" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
<div class="sourceCode" id="cb894"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb894-1"><a href="supplemental.html#cb894-1" aria-hidden="true" tabindex="-1"></a><span class="co">%% Reproduce figure 2.2 from GP book</span></span>
<span id="cb894-2"><a href="supplemental.html#cb894-2" aria-hidden="true" tabindex="-1"></a><span class="co">%</span></span>
<span id="cb894-3"><a href="supplemental.html#cb894-3" aria-hidden="true" tabindex="-1"></a><span class="co">%%</span></span>
<span id="cb894-4"><a href="supplemental.html#cb894-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-5"><a href="supplemental.html#cb894-5" aria-hidden="true" tabindex="-1"></a><span class="co">% This file is from pmtk3.googlecode.com</span></span>
<span id="cb894-6"><a href="supplemental.html#cb894-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-7"><a href="supplemental.html#cb894-7" aria-hidden="true" tabindex="-1"></a><span class="va">setSeed</span>(<span class="fl">0</span>)<span class="op">;</span></span>
<span id="cb894-8"><a href="supplemental.html#cb894-8" aria-hidden="true" tabindex="-1"></a><span class="va">L</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb894-9"><a href="supplemental.html#cb894-9" aria-hidden="true" tabindex="-1"></a><span class="va">xs</span> <span class="op">=</span> (<span class="op">-</span><span class="fl">5</span><span class="op">:</span><span class="fl">0.2</span><span class="op">:</span><span class="fl">5</span>)<span class="op">&#39;;</span></span>
<span id="cb894-10"><a href="supplemental.html#cb894-10" aria-hidden="true" tabindex="-1"></a><span class="va">ns</span> <span class="op">=</span> <span class="va">length</span>(<span class="va">xs</span>)<span class="op">;</span></span>
<span id="cb894-11"><a href="supplemental.html#cb894-11" aria-hidden="true" tabindex="-1"></a><span class="va">keps</span> <span class="op">=</span> <span class="fl">1e-8</span><span class="op">;</span></span>
<span id="cb894-12"><a href="supplemental.html#cb894-12" aria-hidden="true" tabindex="-1"></a><span class="va">muFn</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">x</span>) <span class="fl">0</span><span class="op">*</span><span class="va">x</span>(<span class="op">:</span>)<span class="op">.^</span><span class="fl">2</span><span class="op">;</span></span>
<span id="cb894-13"><a href="supplemental.html#cb894-13" aria-hidden="true" tabindex="-1"></a><span class="va">Kfn</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">x</span><span class="op">,</span><span class="va">z</span>) <span class="fl">1</span><span class="op">*</span><span class="va">exp</span>(<span class="op">-</span><span class="va">sq_dist</span>(<span class="va">x</span><span class="op">&#39;/</span><span class="va">L</span><span class="op">,</span><span class="va">z</span><span class="op">&#39;/</span><span class="va">L</span>)<span class="op">/</span><span class="fl">2</span>)<span class="op">;</span></span>
<span id="cb894-14"><a href="supplemental.html#cb894-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-15"><a href="supplemental.html#cb894-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-16"><a href="supplemental.html#cb894-16" aria-hidden="true" tabindex="-1"></a><span class="co">% plot sampled functions from the prior</span></span>
<span id="cb894-17"><a href="supplemental.html#cb894-17" aria-hidden="true" tabindex="-1"></a><span class="va">figure</span><span class="op">;</span> <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb894-18"><a href="supplemental.html#cb894-18" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb894-19"><a href="supplemental.html#cb894-19" aria-hidden="true" tabindex="-1"></a>  <span class="va">model</span> <span class="op">=</span> <span class="va">struct</span>(<span class="ss">&#39;mu&#39;</span><span class="op">,</span> <span class="va">muFn</span>(<span class="va">xs</span>)<span class="op">,</span> <span class="ss">&#39;Sigma&#39;</span><span class="op">,</span>  <span class="va">Kfn</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">xs</span>) <span class="op">+</span> <span class="fl">1e-15</span><span class="op">*</span><span class="va">eye</span>(<span class="va">size</span>(<span class="va">xs</span><span class="op">,</span> <span class="fl">1</span>)))<span class="op">;</span></span>
<span id="cb894-20"><a href="supplemental.html#cb894-20" aria-hidden="true" tabindex="-1"></a>  <span class="va">fs</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">model</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb894-21"><a href="supplemental.html#cb894-21" aria-hidden="true" tabindex="-1"></a>  <span class="va">plot</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">fs</span><span class="op">,</span> <span class="ss">&#39;k-&#39;</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">2</span>)</span>
<span id="cb894-22"><a href="supplemental.html#cb894-22" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb894-23"><a href="supplemental.html#cb894-23" aria-hidden="true" tabindex="-1"></a><span class="va">printPmtkFigure</span>(<span class="ss">&#39;gprDemoNoiseFreePrior&#39;</span>)</span>
<span id="cb894-24"><a href="supplemental.html#cb894-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-25"><a href="supplemental.html#cb894-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-26"><a href="supplemental.html#cb894-26" aria-hidden="true" tabindex="-1"></a><span class="co">% generate noise-less training data</span></span>
<span id="cb894-27"><a href="supplemental.html#cb894-27" aria-hidden="true" tabindex="-1"></a><span class="va">Xtrain</span> <span class="op">=</span> [<span class="op">-</span><span class="fl">4</span><span class="op">,</span> <span class="op">-</span><span class="fl">3</span><span class="op">,</span> <span class="op">-</span><span class="fl">2</span><span class="op">,</span> <span class="op">-</span><span class="fl">1</span><span class="op">,</span> <span class="fl">1</span>]<span class="op">&#39;;</span></span>
<span id="cb894-28"><a href="supplemental.html#cb894-28" aria-hidden="true" tabindex="-1"></a><span class="va">ftrain</span> <span class="op">=</span> <span class="va">sin</span>(<span class="va">Xtrain</span>)<span class="op">;</span></span>
<span id="cb894-29"><a href="supplemental.html#cb894-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-30"><a href="supplemental.html#cb894-30" aria-hidden="true" tabindex="-1"></a><span class="co">% compute posterior predictive</span></span>
<span id="cb894-31"><a href="supplemental.html#cb894-31" aria-hidden="true" tabindex="-1"></a><span class="va">K</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">Xtrain</span>)<span class="op">;</span> <span class="co">% K</span></span>
<span id="cb894-32"><a href="supplemental.html#cb894-32" aria-hidden="true" tabindex="-1"></a><span class="va">Ks</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">xs</span>)<span class="op">;</span> <span class="co">%K_*</span></span>
<span id="cb894-33"><a href="supplemental.html#cb894-33" aria-hidden="true" tabindex="-1"></a><span class="va">Kss</span> <span class="op">=</span> <span class="va">Kfn</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">xs</span>) <span class="op">+</span> <span class="va">keps</span><span class="op">*</span><span class="va">eye</span>(<span class="va">length</span>(<span class="va">xs</span>))<span class="op">;</span> <span class="co">% K_** (keps is essential!)</span></span>
<span id="cb894-34"><a href="supplemental.html#cb894-34" aria-hidden="true" tabindex="-1"></a><span class="va">Ki</span> <span class="op">=</span> <span class="va">inv</span>(<span class="va">K</span>)<span class="op">;</span></span>
<span id="cb894-35"><a href="supplemental.html#cb894-35" aria-hidden="true" tabindex="-1"></a><span class="va">postMu</span> <span class="op">=</span> <span class="va">muFn</span>(<span class="va">xs</span>) <span class="op">+</span> <span class="va">Ks</span><span class="op">&#39;*</span><span class="va">Ki</span><span class="op">*</span>(<span class="va">ftrain</span> <span class="op">-</span> <span class="va">muFn</span>(<span class="va">Xtrain</span>))<span class="op">;</span></span>
<span id="cb894-36"><a href="supplemental.html#cb894-36" aria-hidden="true" tabindex="-1"></a><span class="va">postCov</span> <span class="op">=</span> <span class="va">Kss</span> <span class="op">-</span> <span class="va">Ks</span><span class="op">&#39;*</span><span class="va">Ki</span><span class="op">*</span><span class="va">Ks</span><span class="op">;</span></span>
<span id="cb894-37"><a href="supplemental.html#cb894-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-38"><a href="supplemental.html#cb894-38" aria-hidden="true" tabindex="-1"></a><span class="va">figure</span><span class="op">;</span> <span class="va">hold</span> <span class="va">on</span></span>
<span id="cb894-39"><a href="supplemental.html#cb894-39" aria-hidden="true" tabindex="-1"></a><span class="co">% plot marginal posterior variance as gray band</span></span>
<span id="cb894-40"><a href="supplemental.html#cb894-40" aria-hidden="true" tabindex="-1"></a><span class="va">mu</span> <span class="op">=</span> <span class="va">postMu</span>(<span class="op">:</span>)<span class="op">;</span></span>
<span id="cb894-41"><a href="supplemental.html#cb894-41" aria-hidden="true" tabindex="-1"></a><span class="va">S2</span> <span class="op">=</span> <span class="va">diag</span>(<span class="va">postCov</span>)<span class="op">;</span></span>
<span id="cb894-42"><a href="supplemental.html#cb894-42" aria-hidden="true" tabindex="-1"></a><span class="va">f</span> <span class="op">=</span> [<span class="va">mu</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">;</span><span class="va">flipdim</span>(<span class="va">mu</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">sqrt</span>(<span class="va">S2</span>)<span class="op">,</span><span class="fl">1</span>)]<span class="op">;</span></span>
<span id="cb894-43"><a href="supplemental.html#cb894-43" aria-hidden="true" tabindex="-1"></a><span class="va">fill</span>([<span class="va">xs</span><span class="op">;</span> <span class="va">flipdim</span>(<span class="va">xs</span><span class="op">,</span><span class="fl">1</span>)]<span class="op">,</span> <span class="va">f</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span><span class="op">,</span> <span class="ss">&#39;EdgeColor&#39;</span><span class="op">,</span> [<span class="fl">7</span> <span class="fl">7</span> <span class="fl">7</span>]<span class="op">/</span><span class="fl">8</span>)<span class="op">;</span></span>
<span id="cb894-44"><a href="supplemental.html#cb894-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb894-45"><a href="supplemental.html#cb894-45" aria-hidden="true" tabindex="-1"></a><span class="co">% plot samples from posterior predictive</span></span>
<span id="cb894-46"><a href="supplemental.html#cb894-46" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span></span>
<span id="cb894-47"><a href="supplemental.html#cb894-47" aria-hidden="true" tabindex="-1"></a>  <span class="va">model</span> <span class="op">=</span> <span class="va">struct</span>(<span class="ss">&#39;mu&#39;</span><span class="op">,</span> <span class="va">postMu</span>(<span class="op">:</span>)<span class="op">&#39;,</span> <span class="ss">&#39;Sigma&#39;</span><span class="op">,</span> <span class="va">postCov</span>)<span class="op">;</span></span>
<span id="cb894-48"><a href="supplemental.html#cb894-48" aria-hidden="true" tabindex="-1"></a>  <span class="va">fs</span> <span class="op">=</span> <span class="va">gaussSample</span>(<span class="va">model</span><span class="op">,</span> <span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb894-49"><a href="supplemental.html#cb894-49" aria-hidden="true" tabindex="-1"></a>  <span class="va">plot</span>(<span class="va">xs</span><span class="op">,</span> <span class="va">fs</span><span class="op">,</span> <span class="ss">&#39;k-&#39;</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">2</span>)</span>
<span id="cb894-50"><a href="supplemental.html#cb894-50" aria-hidden="true" tabindex="-1"></a>  <span class="va">h</span><span class="op">=</span><span class="va">plot</span>(<span class="va">Xtrain</span><span class="op">,</span> <span class="va">ftrain</span><span class="op">,</span> <span class="ss">&#39;kx&#39;</span><span class="op">,</span> <span class="ss">&#39;markersize&#39;</span><span class="op">,</span> <span class="fl">12</span><span class="op">,</span> <span class="ss">&#39;linewidth&#39;</span><span class="op">,</span> <span class="fl">3</span>)<span class="op">;</span></span>
<span id="cb894-51"><a href="supplemental.html#cb894-51" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb894-52"><a href="supplemental.html#cb894-52" aria-hidden="true" tabindex="-1"></a><span class="va">printPmtkFigure</span>(<span class="ss">&#39;gprDemoNoiseFreePost&#39;</span>)</span></code></pre></div>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="hamiltonian-monte-carlo.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/supplemental.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
