<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Multinomial Regression | Model Estimation by Example</title>
  <meta name="description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Multinomial Regression | Model Estimation by Example" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/models-by-example/" />
  <meta property="og:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />
  <meta property="og:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="github-repo" content="m-clark/models-by-example/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Multinomial Regression | Model Estimation by Example" />
  
  <meta name="twitter:description" content="This document provides ‘by-hand’ demonstrations of various models and algorithms. The goal is to take away some of the mystery by providing clean code examples that are easy to run and compare with other tools." />
  <meta name="twitter:image" content="https://m-clark.github.io/models-by-example/img/title_plot.svg" />




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon" />
<link rel="prev" href="naive-bayes.html"/>
<link rel="next" href="ordinal.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class='before'><a href="./">Model Estimation by Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="part"><span><b>Models</b></span></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i>Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#data-setup"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#estimation"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#comparison"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#python"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="linear-regression.html"><a href="linear-regression.html#source"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i>Logistic Regression</a>
<ul>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#data-setup-1"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#functions-1"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#estimation-1"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#comparison-1"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#python-1"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="logistic-regression.html"><a href="logistic-regression.html#source-1"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html"><i class="fa fa-check"></i>Mixed Models</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#one-factor-mixed-model"><i class="fa fa-check"></i>One-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-2"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-2"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-2"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-2"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#two-factor-mixed-model"><i class="fa fa-check"></i>Two-factor Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-3"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-1"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-3"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-3"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-3"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#mixed-model-via-ml"><i class="fa fa-check"></i>Mixed Model via ML</a>
<ul>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#data-setup-4"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#function-2"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#estimation-4"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#comparison-4"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#link-with-penalized-regression"><i class="fa fa-check"></i>Link with penalized regression</a></li>
<li class="chapter" data-level="" data-path="mixed-models.html"><a href="mixed-models.html#source-4"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html"><i class="fa fa-check"></i>Probit &amp; Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#standard-probit"><i class="fa fa-check"></i>Standard Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#function-3"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#examples"><i class="fa fa-check"></i>Examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#bivariate-probit"><i class="fa fa-check"></i>Bivariate Probit</a>
<ul>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#example"><i class="fa fa-check"></i>Example</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="probit.html"><a href="probit.html#source-5"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html"><i class="fa fa-check"></i>Heckman Selection</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#data-setup-5"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#two-step-approach"><i class="fa fa-check"></i>Two step approach</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-1-probit-model"><i class="fa fa-check"></i>Step 1: Probit Model</a></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#step-2-estimate-via-linear-regression"><i class="fa fa-check"></i>Step 2: Estimate via Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#maximum-likelihood"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#comparison-5"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="heckman-selection.html"><a href="heckman-selection.html#source-6"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html"><i class="fa fa-check"></i>Marginal Structural Model</a>
<ul>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#data-setup-6"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#function-4"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#estimation-5"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#comparison-6"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="marginal-structural.html"><a href="marginal-structural.html#source-7"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html"><i class="fa fa-check"></i>Tobit Regression</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-an-upper-limit"><i class="fa fa-check"></i>Censoring with an Upper Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#data-setup-7"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#function-5"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#estimation-6"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-7"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#censoring-with-a-lower-limit"><i class="fa fa-check"></i>Censoring with a Lower Limit</a>
<ul>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#comparison-8"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tobit.html"><a href="tobit.html#source-8"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html"><i class="fa fa-check"></i>Cox Survival</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#standard-proportional-hazards"><i class="fa fa-check"></i>Standard Proportional Hazards</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-8"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-6"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-7"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-9"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#time-varying-coefficients"><i class="fa fa-check"></i>Time-varying coefficients</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-9"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-7"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-8"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-10"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#stratified-cox-model"><i class="fa fa-check"></i>Stratified Cox Model</a>
<ul>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#data-setup-10"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#function-8"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#estimation-9"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#comparison-11"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cox.html"><a href="cox.html#source-9"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html"><i class="fa fa-check"></i>Hurdle Model</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#poisson"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#data-setup-11"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-9"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-10"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-12"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#negative-binomial"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#function-10"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#estimation-11"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#comparison-13"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hurdle.html"><a href="hurdle.html#source-10"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html"><i class="fa fa-check"></i>Zero-Inflated Model</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#poisson-1"><i class="fa fa-check"></i>Poisson</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#data-setup-12"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-11"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-12"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-14"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#negative-binomial-1"><i class="fa fa-check"></i>Negative Binomial</a>
<ul>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#function-12"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#estimation-13"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#comparison-15"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#supplemental-example"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="zi.html"><a href="zi.html#source-11"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html"><i class="fa fa-check"></i>Naive Bayes</a>
<ul>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#initialization"><i class="fa fa-check"></i>Initialization</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#comparison-16"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="naive-bayes.html"><a href="naive-bayes.html#source-12"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i>Multinomial Regression</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#standard-categorical-model"><i class="fa fa-check"></i>Standard (Categorical) Model</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#data-setup-13"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#function-13"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-17"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#alternative-specific-and-constant-variables"><i class="fa fa-check"></i>Alternative specific and constant variables</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#comparison-18"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#source-13"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html"><i class="fa fa-check"></i>Ordinal Regression</a>
<ul>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#data"><i class="fa fa-check"></i>Data</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#function-14"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#estimation-14"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#comparison-19"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="ordinal.html"><a href="ordinal.html#source-14"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html"><i class="fa fa-check"></i>Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-setup-14"><i class="fa fa-check"></i>Data Setup</a>
<ul>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#data-functions"><i class="fa fa-check"></i>Data Functions</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#two-states-demo"><i class="fa fa-check"></i>Two states Demo</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#three-states-demo"><i class="fa fa-check"></i>Three states demo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#function-15"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#estimation-15"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#comparison-20"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="markov.html"><a href="markov.html#source-15"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html"><i class="fa fa-check"></i>Hidden Markov Model</a>
<ul>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#data-setup-15"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#function-16"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#estimation-16"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#supplemental-demo"><i class="fa fa-check"></i>Supplemental demo</a></li>
<li class="chapter" data-level="" data-path="hmm.html"><a href="hmm.html#source-16"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html"><i class="fa fa-check"></i>Quantile Regression</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#data-setup-16"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#function-17"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#estimation-17"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#other-quantiles"><i class="fa fa-check"></i>Other quantiles</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#comparison-21"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#visualize"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#python-2"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="quantile-regression.html"><a href="quantile-regression.html#source-17"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html"><i class="fa fa-check"></i>Cubic Spline Model</a>
<ul>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#data-setup-17"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#functions-2"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="cubic-spline.html"><a href="cubic-spline.html#source-18"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html"><i class="fa fa-check"></i>Gaussian Processes</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noise-free-demonstration"><i class="fa fa-check"></i>Noise-Free Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-18"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-3"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#noisy-demonstration"><i class="fa fa-check"></i>Noisy Demonstration</a>
<ul>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#data-setup-19"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#functions-4"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-prior-distribution-1"><i class="fa fa-check"></i>Visualize the prior distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#generate-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Generate the posterior predictive distribution</a></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#visualize-the-posterior-predictive-distribution-1"><i class="fa fa-check"></i>Visualize the Posterior Predictive Distribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="gaussian-process.html"><a href="gaussian-process.html#source-19"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html"><i class="fa fa-check"></i>Neural Network</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-1-1"><i class="fa fa-check"></i>Example 1</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-3"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r"><i class="fa fa-check"></i>R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-2-1"><i class="fa fa-check"></i>Example 2</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-4"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-1"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-22"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#example-3"><i class="fa fa-check"></i>Example 3</a>
<ul>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#python-5"><i class="fa fa-check"></i>Python</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#r-2"><i class="fa fa-check"></i>R</a></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#comparison-23"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="neural-network.html"><a href="neural-network.html#source-20"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html"><i class="fa fa-check"></i>Extreme Learning Machine</a>
<ul>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#data-setup-20"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#function-18"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#estimation-18"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#comparison-24"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#supplemental-example-1"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="elm.html"><a href="elm.html#source-21"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space Regression</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-21"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-5"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#function-to-find-the-inverse-of-a-matrix"><i class="fa fa-check"></i>Function to find the inverse of a matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#reproducing-kernel"><i class="fa fa-check"></i>Reproducing Kernel</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#gram-matrix"><i class="fa fa-check"></i>Gram matrix</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#ridge-regression"><i class="fa fa-check"></i>Ridge regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-19"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-25"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#example-cubic-spline"><i class="fa fa-check"></i>Example: Cubic Spline</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#data-setup-22"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#functions-6"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#estimation-20"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#comparison-26"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#source-22"><i class="fa fa-check"></i>Source</a>
<ul>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#current-supplemental-code"><i class="fa fa-check"></i>Current Supplemental Code</a></li>
<li class="chapter" data-level="" data-path="rkhs.html"><a href="rkhs.html#original-supplemental-code"><i class="fa fa-check"></i>Original Supplemental Code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html"><i class="fa fa-check"></i>Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#data-setup-23"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#functions-7"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#estimation-21"><i class="fa fa-check"></i>Estimation</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#raw"><i class="fa fa-check"></i>Raw</a></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#standardized"><i class="fa fa-check"></i>Standardized</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#comparison-27"><i class="fa fa-check"></i>Comparison</a>
<ul>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#mplus"><i class="fa fa-check"></i>Mplus</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cfa.html"><a href="cfa.html#source-23"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Bayesian</b></span></li>
<li class="chapter" data-level="" data-path="bayesian.html"><a href="bayesian.html"><i class="fa fa-check"></i>Introduction to Bayesian Methods</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html"><i class="fa fa-check"></i>Basics</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior-likelihood-posterior-distributions"><i class="fa fa-check"></i>Prior, likelihood, &amp; posterior distributions</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#prior"><i class="fa fa-check"></i>Prior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#likelihood"><i class="fa fa-check"></i>Likelihood</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior"><i class="fa fa-check"></i>Posterior</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#posterior-predictive"><i class="fa fa-check"></i>Posterior predictive</a></li>
<li class="chapter" data-level="" data-path="bayesian-basics.html"><a href="bayesian-basics.html#source-24"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html"><i class="fa fa-check"></i>Bayesian t-test</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#data-setup-24"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#model-code"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#estimation-22"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#comparison-28"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#visualization"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-t-test.html"><a href="bayesian-t-test.html#source-25"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html"><i class="fa fa-check"></i>Bayesian Linear Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#data-setup-25"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#model-code-1"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#estimation-23"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#comparison-29"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#visualize-1"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-linear-regression.html"><a href="bayesian-linear-regression.html#source-26"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html"><i class="fa fa-check"></i>Bayesian Beta Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#data-setup-26"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#model-code-2"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#estimation-24"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#comparison-30"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#visualization-1"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-beta-regression.html"><a href="bayesian-beta-regression.html#source-27"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html"><i class="fa fa-check"></i>Bayesian Mixed Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#data-setup-27"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#model-code-3"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#estimation-25"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#comparison-31"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#visualize-2"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-model.html"><a href="bayesian-mixed-model.html#source-28"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html"><i class="fa fa-check"></i>Bayesian Multilevel Mediation</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#data-setup-28"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#model-code-4"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#estimation-26"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#comparison-32"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#visualization-2"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-mixed-mediation.html"><a href="bayesian-mixed-mediation.html#source-29"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html"><i class="fa fa-check"></i>Bayesian IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#one-parameter-irt"><i class="fa fa-check"></i>One Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#data-setup-29"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-5"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-27"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-33"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#two-parameter-irt"><i class="fa fa-check"></i>Two Parameter IRT</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#model-code-6"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#estimation-28"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#comparison-34"><i class="fa fa-check"></i>Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#three-parameter-irt"><i class="fa fa-check"></i>Three Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#four-parameter-irt"><i class="fa fa-check"></i>Four Parameter IRT</a></li>
<li class="chapter" data-level="" data-path="bayesian-irt.html"><a href="bayesian-irt.html#source-30"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html"><i class="fa fa-check"></i>Bayesian CFA</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#data-setup-30"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#model-code-7"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#estimation-29"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#comparison-35"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-cfa.html"><a href="bayesian-cfa.html#source-31"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html"><i class="fa fa-check"></i>Bayesian Nonparametric Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#chinese-restaurant-process"><i class="fa fa-check"></i>Chinese Restaurant Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#indian-buffet-process"><i class="fa fa-check"></i>Indian Buffet Process</a></li>
<li class="chapter" data-level="" data-path="bayesian-non-parametric.html"><a href="bayesian-non-parametric.html#source-32"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html"><i class="fa fa-check"></i>Bayesian Stochastic Volatility Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#data-setup-31"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#model-code-8"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#estimation-30"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#results"><i class="fa fa-check"></i>Results</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#visualization-3"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-stochastic-volatility.html"><a href="bayesian-stochastic-volatility.html#source-33"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html"><i class="fa fa-check"></i>Bayesian Multinomial Models</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#data-setup-32"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#model-code-9"><i class="fa fa-check"></i>Model Code</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#estimation-31"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#comparison-36"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#adding-complexity"><i class="fa fa-check"></i>Adding Complexity</a></li>
<li class="chapter" data-level="" data-path="bayesian-multinomial-model.html"><a href="bayesian-multinomial-model.html#source-34"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html"><i class="fa fa-check"></i>Variational Bayes Regression</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#data-setup-33"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#function-19"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#estimation-32"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#comparison-37"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#visualization-4"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#supplemental-example-2"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="bayesian-variational.html"><a href="bayesian-variational.html#source-35"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html"><i class="fa fa-check"></i>Topic Model</a>
<ul>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#data-setup-34"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#function-20"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#estimation-33"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#comparison-38"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="bayesian-topic-model.html"><a href="bayesian-topic-model.html#source-36"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Estimation</b></span></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html"><i class="fa fa-check"></i>Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#example-4"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#linear-model"><i class="fa fa-check"></i>Linear Model</a></li>
<li class="chapter" data-level="" data-path="maximum-likelihood.html"><a href="maximum-likelihood.html#source-37"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html"><i class="fa fa-check"></i>Penalized Maximum Likelihood</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#introduction-2"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-35"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#functions-8"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-34"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-39"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-38"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l1-lasso-regularization"><i class="fa fa-check"></i>L1 (lasso) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-36"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-21"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-35"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-40"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-39"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#l2-ridge-regularization"><i class="fa fa-check"></i>L2 (ridge) regularization</a>
<ul>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#data-setup-37"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#function-22"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#estimation-36"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#comparison-41"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="penalized-maximum-likelihood.html"><a href="penalized-maximum-likelihood.html#source-40"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html"><i class="fa fa-check"></i>Newton and IRLS</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#data-setup-38"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#functions-9"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#newtons-method"><i class="fa fa-check"></i>Newton’s Method</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#irls"><i class="fa fa-check"></i>IRLS</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#estimation-37"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#comparison-42"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="newton-irls.html"><a href="newton-irls.html#source-41"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html"><i class="fa fa-check"></i>Nelder-Mead</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#functions-10"><i class="fa fa-check"></i>Functions</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#first-version"><i class="fa fa-check"></i>First Version</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-5"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#second-version"><i class="fa fa-check"></i>Second Version</a>
<ul>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#example-6"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#a-regression-model-1"><i class="fa fa-check"></i>A Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="nelder-mead.html"><a href="nelder-mead.html#source-42"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html"><i class="fa fa-check"></i>Expectation-Maximization</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#mixture-model"><i class="fa fa-check"></i>Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-40"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-23"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-38"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-45"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-5"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#supplemental-example-3"><i class="fa fa-check"></i>Supplemental Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-43"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#multivariate-mixture-model"><i class="fa fa-check"></i>Multivariate Mixture Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-24"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-1-old-faithful"><i class="fa fa-check"></i>Example 1: Old Faithful</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#example-2-iris"><i class="fa fa-check"></i>Example 2: Iris</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-44"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-model"><i class="fa fa-check"></i>Probit Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-43"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probit-via-maximum-likelihood"><i class="fa fa-check"></i>Probit via Maximum Likelihood</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#em-for-latent-variable-approach-to-probit"><i class="fa fa-check"></i>EM for Latent Variable Approach to Probit</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-45"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#pca"><i class="fa fa-check"></i>PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-44"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-27"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-43"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-50"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-4"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-46"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#probabilistic-pca"><i class="fa fa-check"></i>Probabilistic PCA</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-45"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-28"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-44"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#comparison-51"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualize-5"><i class="fa fa-check"></i>Visualize</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#missing-data-example"><i class="fa fa-check"></i>Missing Data Example</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-47"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#state-space-model"><i class="fa fa-check"></i>State Space Model</a>
<ul>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#data-setup-47"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#function-30"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#estimation-46"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#visualization-6"><i class="fa fa-check"></i>Visualization</a></li>
<li class="chapter" data-level="" data-path="em.html"><a href="em.html#source-48"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html"><i class="fa fa-check"></i>Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#data-setup-48"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#function-31"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#estimation-47"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#comparison-53"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="gradient-descent.html"><a href="gradient-descent.html#source-49"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html"><i class="fa fa-check"></i>Stochastic Gradient Descent</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-49"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-32"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-48"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-54"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates"><i class="fa fa-check"></i>Visualize Estimates</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-set-shift"><i class="fa fa-check"></i>Data Set Shift</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-50"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-49"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-55"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-1"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#sgd-variants"><i class="fa fa-check"></i>SGD Variants</a>
<ul>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#data-setup-51"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#function-33"><i class="fa fa-check"></i>Function</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#estimation-50"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#comparison-56"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#visualize-estimates-2"><i class="fa fa-check"></i>Visualize Estimates</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="stochastic-gradient-descent.html"><a href="stochastic-gradient-descent.html#source-50"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html"><i class="fa fa-check"></i>Metropolis Hastings</a>
<ul>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#data-setup-52"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#functions-11"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#estimation-51"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#comparison-57"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="metropolis-hastings.html"><a href="metropolis-hastings.html#source-51"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html"><i class="fa fa-check"></i>Hamiltonian Monte Carlo</a>
<ul>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#data-setup-53"><i class="fa fa-check"></i>Data Setup</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#functions-12"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#estimation-52"><i class="fa fa-check"></i>Estimation</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#comparison-58"><i class="fa fa-check"></i>Comparison</a></li>
<li class="chapter" data-level="" data-path="hamiltonian-monte-carlo.html"><a href="hamiltonian-monte-carlo.html#source-52"><i class="fa fa-check"></i>Source</a></li>
</ul></li>
<li class="part"><span><b>Other</b></span></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html"><i class="fa fa-check"></i>Supplemental</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#other-languages"><i class="fa fa-check"></i>Other Languages</a>
<ul>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#python-demos"><i class="fa fa-check"></i>Python Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#julia-demos"><i class="fa fa-check"></i>Julia Demos</a></li>
<li class="chapter" data-level="" data-path="supplemental.html"><a href="supplemental.html#matlab-demos"><i class="fa fa-check"></i>Matlab Demos</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li class='after'">
   <a href="https://m-clark.github.io/">
      <img src="img/mc_logo.png" style="width:25%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo">
   </a>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a href="https://github.com/m-clark/">
         <i class="fab fa-github fa-2x" aria-hidden="true"></i>
      </a>
   </div>
</li>
<li class='after'">
   <div style='text-align:center'>
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
         <i class="fab fa-creative-commons fa-lg"></i>
         <i class="fab fa-creative-commons-by fa-lg"></i>
         <i class="fab fa-creative-commons-sa fa-lg"></i>
      </a>
   </div>
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Model Estimation by Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multinomial-regression" class="section level1">
<h1>Multinomial Regression</h1>
<p>For more detail on these types of models, see <a href="https://m-clark.github.io/docs/logregmodels.html">my document</a>. In general we can use
multinomial models for multi-category target variables, or more generally,
multi-count data.</p>
<div id="standard-categorical-model" class="section level2">
<h2>Standard (Categorical) Model</h2>
<div id="data-setup-13" class="section level3">
<h3>Data Setup</h3>
<p>First, lets get some data. 200 entering high school students make program
choices: general program, vocational program, and academic program. We will be
interested in their choice, using their writing score as a proxy for scholastic
ability and their socioeconomic status, a categorical variable of low, middle,
and high values.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="multinomial.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb159-2"><a href="multinomial.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb159-3"><a href="multinomial.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlogit)</span>
<span id="cb159-4"><a href="multinomial.html#cb159-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-5"><a href="multinomial.html#cb159-5" aria-hidden="true" tabindex="-1"></a>program <span class="ot">=</span> <span class="fu">read_dta</span>(<span class="st">&quot;https://stats.idre.ucla.edu/stat/data/hsbdemo.dta&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-6"><a href="multinomial.html#cb159-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_factor</span>() <span class="sc">%&gt;%</span></span>
<span id="cb159-7"><a href="multinomial.html#cb159-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prog =</span> <span class="fu">relevel</span>(prog, <span class="at">ref =</span> <span class="st">&quot;academic&quot;</span>))</span>
<span id="cb159-8"><a href="multinomial.html#cb159-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-9"><a href="multinomial.html#cb159-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(program[, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<pre><code># A tibble: 6 x 5
     id female ses    schtyp prog    
  &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt;   
1    45 female low    public vocation
2   108 male   middle public general 
3    15 male   high   public vocation
4    67 male   low    public vocation
5   153 male   middle public vocation
6    51 female high   public general </code></pre>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="multinomial.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to long form for mlogit</span></span>
<span id="cb161-2"><a href="multinomial.html#cb161-2" aria-hidden="true" tabindex="-1"></a>program_long <span class="ot">=</span> program <span class="sc">%&gt;%</span></span>
<span id="cb161-3"><a href="multinomial.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, prog, ses, write) <span class="sc">%&gt;%</span></span>
<span id="cb161-4"><a href="multinomial.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mlogit.data</span>(</span>
<span id="cb161-5"><a href="multinomial.html#cb161-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ,</span>
<span id="cb161-6"><a href="multinomial.html#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">&#39;wide&#39;</span>,</span>
<span id="cb161-7"><a href="multinomial.html#cb161-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">choice =</span> <span class="st">&#39;prog&#39;</span>,</span>
<span id="cb161-8"><a href="multinomial.html#cb161-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">id.var =</span> <span class="st">&#39;id&#39;</span></span>
<span id="cb161-9"><a href="multinomial.html#cb161-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb161-10"><a href="multinomial.html#cb161-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-11"><a href="multinomial.html#cb161-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(program_long)</span></code></pre></div>
<pre><code>~~~~~~~
 first 10 observations out of 600 
~~~~~~~
   id  prog    ses write chid      alt      idx
1   1 FALSE    low    44   11 academic  11:emic
2   1 FALSE    low    44   11  general  11:eral
3   1  TRUE    low    44   11 vocation  11:tion
4   2 FALSE middle    41    9 academic   9:emic
5   2 FALSE middle    41    9  general   9:eral
6   2  TRUE middle    41    9 vocation   9:tion
7   3  TRUE    low    65  159 academic 159:emic
8   3 FALSE    low    65  159  general 159:eral
9   3 FALSE    low    65  159 vocation 159:tion
10  4  TRUE    low    50   30 academic  30:emic

~~~ indexes ~~~~
   chid id      alt
1    11  1 academic
2    11  1  general
3    11  1 vocation
4     9  2 academic
5     9  2  general
6     9  2 vocation
7   159  3 academic
8   159  3  general
9   159  3 vocation
10   30  4 academic
indexes:  1, 1, 2 </code></pre>
<p>We go ahead and run a model via <span class="func" style="">mlogit</span> for later comparison.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="multinomial.html#cb163-1" aria-hidden="true" tabindex="-1"></a>fit_mlogit   <span class="ot">=</span> <span class="fu">mlogit</span>(prog <span class="sc">~</span> <span class="dv">1</span><span class="sc">|</span> write <span class="sc">+</span> ses, <span class="at">data =</span> program_long)</span>
<span id="cb163-2"><a href="multinomial.html#cb163-2" aria-hidden="true" tabindex="-1"></a>mlogit_coefs <span class="ot">=</span> <span class="fu">coef</span>(fit_mlogit)[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">4</span>)]  <span class="co"># reorder</span></span></code></pre></div>
</div>
<div id="function-13" class="section level3">
<h3>Function</h3>
<p>Multinomial model via maximum likelihood</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="multinomial.html#cb164-1" aria-hidden="true" tabindex="-1"></a>multinom_ml <span class="ot">&lt;-</span> <span class="cf">function</span>(par, X, y) {</span>
<span id="cb164-2"><a href="multinomial.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  levs <span class="ot">=</span> <span class="fu">levels</span>(y)</span>
<span id="cb164-3"><a href="multinomial.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  ref  <span class="ot">=</span> levs[<span class="dv">1</span>]                <span class="co"># reference level (category label 1)</span></span>
<span id="cb164-4"><a href="multinomial.html#cb164-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-5"><a href="multinomial.html#cb164-5" aria-hidden="true" tabindex="-1"></a>  y0 <span class="ot">=</span> y <span class="sc">==</span> ref</span>
<span id="cb164-6"><a href="multinomial.html#cb164-6" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">=</span> y <span class="sc">==</span> levs[<span class="dv">2</span>]             <span class="co"># category 2</span></span>
<span id="cb164-7"><a href="multinomial.html#cb164-7" aria-hidden="true" tabindex="-1"></a>  y2 <span class="ot">=</span> y <span class="sc">==</span> levs[<span class="dv">3</span>]             <span class="co"># category 3</span></span>
<span id="cb164-8"><a href="multinomial.html#cb164-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-9"><a href="multinomial.html#cb164-9" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">=</span> <span class="fu">matrix</span>(par, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb164-10"><a href="multinomial.html#cb164-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-11"><a href="multinomial.html#cb164-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># more like mnlogit package depiction in its function</span></span>
<span id="cb164-12"><a href="multinomial.html#cb164-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># V1 = X %*% beta[ ,1]</span></span>
<span id="cb164-13"><a href="multinomial.html#cb164-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># V2 = X %*% beta[ ,2]</span></span>
<span id="cb164-14"><a href="multinomial.html#cb164-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ll = sum(-log(1 + exp(V1) + exp(V2))) + sum(V1[y1], V2[y2])</span></span>
<span id="cb164-15"><a href="multinomial.html#cb164-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-16"><a href="multinomial.html#cb164-16" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">=</span> X <span class="sc">%*%</span> beta                           <span class="co"># a vectorized approach</span></span>
<span id="cb164-17"><a href="multinomial.html#cb164-17" aria-hidden="true" tabindex="-1"></a>  baseProbVec <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">rowSums</span>(<span class="fu">exp</span>(V)))  <span class="co"># reference group probabilities</span></span>
<span id="cb164-18"><a href="multinomial.html#cb164-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-19"><a href="multinomial.html#cb164-19" aria-hidden="true" tabindex="-1"></a>  loglik <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">log</span>(baseProbVec))  <span class="sc">+</span> <span class="fu">crossprod</span>(<span class="fu">c</span>(V), <span class="fu">c</span>(y1, y2))</span>
<span id="cb164-20"><a href="multinomial.html#cb164-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb164-21"><a href="multinomial.html#cb164-21" aria-hidden="true" tabindex="-1"></a>  loglik</span>
<span id="cb164-22"><a href="multinomial.html#cb164-22" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="multinomial.html#cb165-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim</span>(</span>
<span id="cb165-2"><a href="multinomial.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">runif</span>(<span class="dv">8</span>,<span class="sc">-</span>.<span class="dv">1</span>, .<span class="dv">1</span>),</span>
<span id="cb165-3"><a href="multinomial.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  multinom_ml,</span>
<span id="cb165-4"><a href="multinomial.html#cb165-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> <span class="fu">model.matrix</span>(prog <span class="sc">~</span> ses <span class="sc">+</span> write, <span class="at">data =</span> program),</span>
<span id="cb165-5"><a href="multinomial.html#cb165-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> program<span class="sc">$</span>prog,</span>
<span id="cb165-6"><a href="multinomial.html#cb165-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb165-7"><a href="multinomial.html#cb165-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit   =</span> <span class="dv">1000</span>,</span>
<span id="cb165-8"><a href="multinomial.html#cb165-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">reltol  =</span> <span class="fl">1e-12</span>,</span>
<span id="cb165-9"><a href="multinomial.html#cb165-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ndeps   =</span> <span class="fu">rep</span>(<span class="fl">1e-8</span>, <span class="dv">8</span>),</span>
<span id="cb165-10"><a href="multinomial.html#cb165-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb165-11"><a href="multinomial.html#cb165-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb165-12"><a href="multinomial.html#cb165-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">type    =</span> <span class="dv">3</span></span>
<span id="cb165-13"><a href="multinomial.html#cb165-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb165-14"><a href="multinomial.html#cb165-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&#39;BFGS&#39;</span></span>
<span id="cb165-15"><a href="multinomial.html#cb165-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>initial  value 638.963532 
iter  10 value 180.008322
final  value 179.981726 
converged</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="multinomial.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit$par</span></span></code></pre></div>
</div>
<div id="comparison-17" class="section level3">
<h3>Comparison</h3>
<p>An initial comparison.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
fit_coefs
</th>
<th style="text-align:right;">
mlogit_coefs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
(Intercept):general
</td>
<td style="text-align:right;">
2.8522
</td>
<td style="text-align:right;">
2.8522
</td>
</tr>
<tr>
<td style="text-align:left;">
sesmiddle:general
</td>
<td style="text-align:right;">
-0.5333
</td>
<td style="text-align:right;">
-0.5333
</td>
</tr>
<tr>
<td style="text-align:left;">
seshigh:general
</td>
<td style="text-align:right;">
-1.1628
</td>
<td style="text-align:right;">
-1.1628
</td>
</tr>
<tr>
<td style="text-align:left;">
write:general
</td>
<td style="text-align:right;">
-0.0579
</td>
<td style="text-align:right;">
-0.0579
</td>
</tr>
<tr>
<td style="text-align:left;">
(Intercept):vocation
</td>
<td style="text-align:right;">
5.2182
</td>
<td style="text-align:right;">
5.2182
</td>
</tr>
<tr>
<td style="text-align:left;">
sesmiddle:vocation
</td>
<td style="text-align:right;">
0.2914
</td>
<td style="text-align:right;">
0.2914
</td>
</tr>
<tr>
<td style="text-align:left;">
seshigh:vocation
</td>
<td style="text-align:right;">
-0.9827
</td>
<td style="text-align:right;">
-0.9827
</td>
</tr>
<tr>
<td style="text-align:left;">
write:vocation
</td>
<td style="text-align:right;">
-0.1136
</td>
<td style="text-align:right;">
-0.1136
</td>
</tr>
</tbody>
</table>
<p>The following uses <span class="func" style="">dmultinom</span> for the likelihood, similar to other modeling demonstrations in this document.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="multinomial.html#cb168-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">model.matrix</span>(prog <span class="sc">~</span> ses <span class="sc">+</span> write, <span class="at">data =</span> program)</span>
<span id="cb168-2"><a href="multinomial.html#cb168-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> program<span class="sc">$</span>prog</span>
<span id="cb168-3"><a href="multinomial.html#cb168-3" aria-hidden="true" tabindex="-1"></a>pars <span class="ot">=</span> <span class="fu">matrix</span>(fit<span class="sc">$</span>par, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb168-4"><a href="multinomial.html#cb168-4" aria-hidden="true" tabindex="-1"></a>V <span class="ot">=</span> X <span class="sc">%*%</span> pars</span>
<span id="cb168-5"><a href="multinomial.html#cb168-5" aria-hidden="true" tabindex="-1"></a>acadprob   <span class="ot">=</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span><span class="sc">+</span><span class="fu">rowSums</span>(<span class="fu">exp</span>(V)))</span>
<span id="cb168-6"><a href="multinomial.html#cb168-6" aria-hidden="true" tabindex="-1"></a>fitnonacad <span class="ot">=</span> <span class="fu">exp</span>(V) <span class="sc">*</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(acadprob, <span class="dv">2</span>), <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb168-7"><a href="multinomial.html#cb168-7" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">=</span> <span class="fu">cbind</span>(acadprob, fitnonacad)</span>
<span id="cb168-8"><a href="multinomial.html#cb168-8" aria-hidden="true" tabindex="-1"></a>yind <span class="ot">=</span> <span class="fu">model.matrix</span>( <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> prog, <span class="at">data =</span> program)</span></code></pre></div>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="multinomial.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># because dmultinom can&#39;t take matrix for prob</span></span>
<span id="cb169-2"><a href="multinomial.html#cb169-2" aria-hidden="true" tabindex="-1"></a>ll <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb169-3"><a href="multinomial.html#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="multinomial.html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>){</span>
<span id="cb169-5"><a href="multinomial.html#cb169-5" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">=</span> ll <span class="sc">+</span> <span class="fu">dmultinom</span>(yind[i, ], <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> fits[i, ], <span class="at">log  =</span> <span class="cn">TRUE</span>)</span>
<span id="cb169-6"><a href="multinomial.html#cb169-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-7"><a href="multinomial.html#cb169-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-8"><a href="multinomial.html#cb169-8" aria-hidden="true" tabindex="-1"></a>ll</span></code></pre></div>
<pre><code>[1] -179.9817</code></pre>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="multinomial.html#cb171-1" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span>value</span></code></pre></div>
<pre><code>[1] -179.9817</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="multinomial.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">logLik</span>(fit_mlogit)</span></code></pre></div>
<pre><code>&#39;log Lik.&#39; -179.9817 (df=8)</code></pre>
</div>
</div>
<div id="alternative-specific-and-constant-variables" class="section level2">
<h2>Alternative specific and constant variables</h2>
<p>Now we add <em>alternative specific</em> and <em>alternative constant</em> variables to the
previous <em>individual specific</em> covariates.. In this example, <code>price</code> is
alternative invariant (<code>Z</code>) <code>income</code> is individual/alternative specific (<code>X</code>),
and <code>catch</code> is alternative specific (<code>Y</code>).</p>
<p>We can use the <code>fish</code> data from the <span class="pack" style="">mnlogit</span>
package.</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="multinomial.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mnlogit)  <span class="co"># note we are now using mnlogit</span></span>
<span id="cb175-2"><a href="multinomial.html#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="multinomial.html#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Fish)</span>
<span id="cb175-4"><a href="multinomial.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Fish)</span></code></pre></div>
<pre><code>           mode   income     alt   price  catch chid
1.beach   FALSE 7083.332   beach 157.930 0.0678    1
1.boat    FALSE 7083.332    boat 157.930 0.2601    1
1.charter  TRUE 7083.332 charter 182.930 0.5391    1
1.pier    FALSE 7083.332    pier 157.930 0.0503    1
2.beach   FALSE 1250.000   beach  15.114 0.1049    2
2.boat    FALSE 1250.000    boat  10.534 0.1574    2</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="multinomial.html#cb177-1" aria-hidden="true" tabindex="-1"></a>fm  <span class="ot">=</span> <span class="fu">formula</span>(mode <span class="sc">~</span> price <span class="sc">|</span> income <span class="sc">|</span> catch)</span>
<span id="cb177-2"><a href="multinomial.html#cb177-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-3"><a href="multinomial.html#cb177-3" aria-hidden="true" tabindex="-1"></a>fit_mnlogit <span class="ot">=</span> <span class="fu">mnlogit</span>(fm, Fish)</span>
<span id="cb177-4"><a href="multinomial.html#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fit_mnlogit = mlogit(fm, Fish)</span></span>
<span id="cb177-5"><a href="multinomial.html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="co"># summary(fit_mnlogit)</span></span></code></pre></div>
<p>The likelihood function.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="multinomial.html#cb178-1" aria-hidden="true" tabindex="-1"></a>multinom_ml <span class="ot">&lt;-</span> <span class="cf">function</span>(par, X, Y, Z, respVec, choice) {</span>
<span id="cb178-2"><a href="multinomial.html#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="multinomial.html#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args-</span></span>
<span id="cb178-4"><a href="multinomial.html#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># X dim nrow(Fish)/K x p + 1 (intercept)</span></span>
<span id="cb178-5"><a href="multinomial.html#cb178-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Z, Y nrow(N); Y has alt specific coefs; then for Z ref group dropped so nrow = nrow*(K-1)/K</span></span>
<span id="cb178-6"><a href="multinomial.html#cb178-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for ll everything through previous X the same</span></span>
<span id="cb178-7"><a href="multinomial.html#cb178-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># then calc probmat for Y and Z, add to X probmat, and add to base</span></span>
<span id="cb178-8"><a href="multinomial.html#cb178-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-9"><a href="multinomial.html#cb178-9" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">sum</span>(choice)</span>
<span id="cb178-10"><a href="multinomial.html#cb178-10" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(respVec))</span>
<span id="cb178-11"><a href="multinomial.html#cb178-11" aria-hidden="true" tabindex="-1"></a>  levs <span class="ot">=</span> <span class="fu">levels</span>(respVec)</span>
<span id="cb178-12"><a href="multinomial.html#cb178-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-13"><a href="multinomial.html#cb178-13" aria-hidden="true" tabindex="-1"></a>  xpar <span class="ot">=</span> <span class="fu">matrix</span>(par[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],  <span class="at">ncol =</span> K<span class="dv">-1</span>)</span>
<span id="cb178-14"><a href="multinomial.html#cb178-14" aria-hidden="true" tabindex="-1"></a>  ypar <span class="ot">=</span> <span class="fu">matrix</span>(par[<span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">ncol =</span> K)</span>
<span id="cb178-15"><a href="multinomial.html#cb178-15" aria-hidden="true" tabindex="-1"></a>  zpar <span class="ot">=</span> <span class="fu">matrix</span>(par[<span class="fu">length</span>(par)], <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb178-16"><a href="multinomial.html#cb178-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-17"><a href="multinomial.html#cb178-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calc X</span></span>
<span id="cb178-18"><a href="multinomial.html#cb178-18" aria-hidden="true" tabindex="-1"></a>  Vx  <span class="ot">=</span> X <span class="sc">%*%</span> xpar</span>
<span id="cb178-19"><a href="multinomial.html#cb178-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-20"><a href="multinomial.html#cb178-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calc Y (mnlogit finds N x 1 results by going through 1:N, N+1:N*2 etc; then</span></span>
<span id="cb178-21"><a href="multinomial.html#cb178-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># makes 1 vector, then subtracts the first 1:N from whole vector, then makes</span></span>
<span id="cb178-22"><a href="multinomial.html#cb178-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nxk-1 matrix with N+1:end values (as 1:N are just zero)); creating the</span></span>
<span id="cb178-23"><a href="multinomial.html#cb178-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vector and rebuilding the matrix is unnecessary though</span></span>
<span id="cb178-24"><a href="multinomial.html#cb178-24" aria-hidden="true" tabindex="-1"></a>  Vy <span class="ot">=</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>K, <span class="cf">function</span>(alt) </span>
<span id="cb178-25"><a href="multinomial.html#cb178-25" aria-hidden="true" tabindex="-1"></a>    Y[respVec <span class="sc">==</span> levs[alt], , <span class="at">drop =</span> <span class="cn">FALSE</span>] <span class="sc">%*%</span> ypar[alt])</span>
<span id="cb178-26"><a href="multinomial.html#cb178-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-27"><a href="multinomial.html#cb178-27" aria-hidden="true" tabindex="-1"></a>  Vy <span class="ot">=</span> Vy[,<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> Vy[,<span class="dv">1</span>]</span>
<span id="cb178-28"><a href="multinomial.html#cb178-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-29"><a href="multinomial.html#cb178-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calc Z</span></span>
<span id="cb178-30"><a href="multinomial.html#cb178-30" aria-hidden="true" tabindex="-1"></a>  Vz <span class="ot">=</span> Z <span class="sc">%*%</span> zpar</span>
<span id="cb178-31"><a href="multinomial.html#cb178-31" aria-hidden="true" tabindex="-1"></a>  Vz <span class="ot">=</span> <span class="fu">matrix</span>(Vz, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb178-32"><a href="multinomial.html#cb178-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-33"><a href="multinomial.html#cb178-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># all Vs must fit into N x K -1 matrix where N is nobs (i.e. individuals)</span></span>
<span id="cb178-34"><a href="multinomial.html#cb178-34" aria-hidden="true" tabindex="-1"></a>  V <span class="ot">=</span> Vx <span class="sc">+</span> Vy <span class="sc">+</span> Vz</span>
<span id="cb178-35"><a href="multinomial.html#cb178-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-36"><a href="multinomial.html#cb178-36" aria-hidden="true" tabindex="-1"></a>  ll0 <span class="ot">=</span> <span class="fu">crossprod</span>(<span class="fu">c</span>(V), choice[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>N)])</span>
<span id="cb178-37"><a href="multinomial.html#cb178-37" aria-hidden="true" tabindex="-1"></a>  baseProbVec <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">rowSums</span>(<span class="fu">exp</span>(V)))</span>
<span id="cb178-38"><a href="multinomial.html#cb178-38" aria-hidden="true" tabindex="-1"></a>  loglik <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">log</span>(baseProbVec)) <span class="sc">+</span> ll0</span>
<span id="cb178-39"><a href="multinomial.html#cb178-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-40"><a href="multinomial.html#cb178-40" aria-hidden="true" tabindex="-1"></a>  loglik</span>
<span id="cb178-41"><a href="multinomial.html#cb178-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-42"><a href="multinomial.html#cb178-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># note fitted values via</span></span>
<span id="cb178-43"><a href="multinomial.html#cb178-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fitnonref = exp(V) * matrix(rep(baseProbVec, K-1), ncol = K-1)</span></span>
<span id="cb178-44"><a href="multinomial.html#cb178-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fitref = 1-rowSums(fitnonref)</span></span>
<span id="cb178-45"><a href="multinomial.html#cb178-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># fits = cbind(fitref, fitnonref)</span></span>
<span id="cb178-46"><a href="multinomial.html#cb178-46" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="multinomial.html#cb179-1" aria-hidden="true" tabindex="-1"></a>inits <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">11</span>, <span class="sc">-</span>.<span class="dv">1</span>, .<span class="dv">1</span>)</span>
<span id="cb179-2"><a href="multinomial.html#cb179-2" aria-hidden="true" tabindex="-1"></a>mdat  <span class="ot">=</span> <span class="fu">mnlogit</span>(fm, Fish)<span class="sc">$</span>model  <span class="co"># this data already ordered!</span></span></code></pre></div>
<p>As <code>X</code> has a constant value across alternatives, the coefficients regard the selection of the alternative relative to reference.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="multinomial.html#cb180-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, mdat[mdat<span class="sc">$</span><span class="st">`</span><span class="at">_Alt_Indx_</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&#39;beach&#39;</span>, <span class="st">&#39;income&#39;</span>])</span>
<span id="cb180-2"><a href="multinomial.html#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(X)</span></code></pre></div>
<pre><code>[1] 1182    2</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="multinomial.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code></pre></div>
<pre><code>     [,1]     [,2]
[1,]    1 7083.332
[2,]    1 1250.000
[3,]    1 3750.000
[4,]    1 2083.333
[5,]    1 4583.332
[6,]    1 4583.332</code></pre>
<p><code>Y</code> will use the complete data to start. Coefficients will be differences from the reference alternative coefficient.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="multinomial.html#cb184-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">as.matrix</span>(mdat[, <span class="st">&#39;catch&#39;</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb184-2"><a href="multinomial.html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Y)</span></code></pre></div>
<pre><code>[1] 4728    1</code></pre>
<p><code>Z</code> are difference scores from reference group.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="multinomial.html#cb186-1" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">=</span> <span class="fu">as.matrix</span>(mdat[mdat<span class="sc">$</span><span class="st">`</span><span class="at">_Alt_Indx_</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&#39;beach&#39;</span>, <span class="st">&#39;price&#39;</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb186-2"><a href="multinomial.html#cb186-2" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">=</span> Z <span class="sc">-</span> mdat[mdat<span class="sc">$</span><span class="st">`</span><span class="at">_Alt_Indx_</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&#39;beach&#39;</span>, <span class="st">&#39;price&#39;</span>]</span>
<span id="cb186-3"><a href="multinomial.html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(Z)</span></code></pre></div>
<pre><code>[1] 3546    1</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="multinomial.html#cb188-1" aria-hidden="true" tabindex="-1"></a>respVec <span class="ot">=</span> mdat<span class="sc">$</span><span class="st">`</span><span class="at">_Alt_Indx_</span><span class="st">`</span> <span class="co"># first 10 should be 0 0 1 0 1 0 0 0 1 1 after beach dropped</span></span></code></pre></div>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="multinomial.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multinom_ml</span>(inits, X, Y, Z, respVec, <span class="at">choice =</span> mdat<span class="sc">$</span>mode)</span></code></pre></div>
<pre><code>          [,1]
[1,] -162384.5</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="multinomial.html#cb191-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">=</span> <span class="fu">optim</span>(</span>
<span id="cb191-2"><a href="multinomial.html#cb191-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">par =</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">11</span>),</span>
<span id="cb191-3"><a href="multinomial.html#cb191-3" aria-hidden="true" tabindex="-1"></a>  multinom_ml,</span>
<span id="cb191-4"><a href="multinomial.html#cb191-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb191-5"><a href="multinomial.html#cb191-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Y =</span> Y,</span>
<span id="cb191-6"><a href="multinomial.html#cb191-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Z =</span> Z,</span>
<span id="cb191-7"><a href="multinomial.html#cb191-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">respVec =</span> respVec,</span>
<span id="cb191-8"><a href="multinomial.html#cb191-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">choice  =</span> mdat<span class="sc">$</span>mode,</span>
<span id="cb191-9"><a href="multinomial.html#cb191-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb191-10"><a href="multinomial.html#cb191-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit   =</span> <span class="dv">1000</span>,</span>
<span id="cb191-11"><a href="multinomial.html#cb191-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">reltol  =</span> <span class="fl">1e-12</span>,</span>
<span id="cb191-12"><a href="multinomial.html#cb191-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">ndeps   =</span> <span class="fu">rep</span>(<span class="fl">1e-8</span>, <span class="dv">11</span>),</span>
<span id="cb191-13"><a href="multinomial.html#cb191-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace   =</span> <span class="cn">TRUE</span>,</span>
<span id="cb191-14"><a href="multinomial.html#cb191-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">fnscale =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb191-15"><a href="multinomial.html#cb191-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">type    =</span> <span class="dv">3</span></span>
<span id="cb191-16"><a href="multinomial.html#cb191-16" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb191-17"><a href="multinomial.html#cb191-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&#39;BFGS&#39;</span></span>
<span id="cb191-18"><a href="multinomial.html#cb191-18" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>initial  value 1638.599935 
iter  10 value 1253.603448
iter  20 value 1199.143447
final  value 1199.143445 
converged</code></pre>
<div id="comparison-18" class="section level3">
<h3>Comparison</h3>
<p>Compare fits.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
fit_coefs
</th>
<th style="text-align:right;">
mnlogit_coefs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.842
</td>
<td style="text-align:right;">
0.842
</td>
</tr>
<tr>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
2.155
</td>
<td style="text-align:right;">
2.155
</td>
</tr>
<tr>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
1.043
</td>
<td style="text-align:right;">
1.043
</td>
</tr>
<tr>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:right;">
3.118
</td>
<td style="text-align:right;">
3.118
</td>
</tr>
<tr>
<td style="text-align:right;">
2.542
</td>
<td style="text-align:right;">
2.542
</td>
</tr>
<tr>
<td style="text-align:right;">
0.759
</td>
<td style="text-align:right;">
0.759
</td>
</tr>
<tr>
<td style="text-align:right;">
2.851
</td>
<td style="text-align:right;">
2.851
</td>
</tr>
<tr>
<td style="text-align:right;">
-0.025
</td>
<td style="text-align:right;">
-0.025
</td>
</tr>
</tbody>
</table>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
fit_ll
</th>
<th style="text-align:right;">
mnlogit_ll
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
-1199.143
</td>
<td style="text-align:right;">
-1199.143
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="source-13" class="section level2">
<h2>Source</h2>
<p>Original code available at <a href="https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/multinomial.R" class="uri">https://github.com/m-clark/Miscellaneous-R-Code/blob/master/ModelFitting/multinomial.R</a></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="naive-bayes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ordinal.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["twitter", "facebook", "linkedin", "google", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/m-clark/models-by-example/blob/master/multinomial.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"df_print": "kable",
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
